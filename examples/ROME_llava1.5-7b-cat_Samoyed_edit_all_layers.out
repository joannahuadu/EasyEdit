prompts = ["What type of cat is this?"]
targets = ['Samoyed']
image = ["val2014/COCO_val2014_000000314504.jpg"]
subject = ["cat"]
rephrase_prompts = ["This cat belongs to which breed?"]
rephrase_image = ["tabby/images.jpg"]
locality_inputs = {
    "text": {"prompt": "Vinson Massif is located in the continent of? Answer in a single word.", "ground_truth":"Antarctica"},
    "vision": {"prompt": "What is the red food? Answer in a single word.", "ground_truth":"Tomato", "image": "val2014/COCO_val2014_000000189446.jpg"},
    }
portability_inputs = {
    "text": {"prompt": "What are the characteristics of this type of cat?", "ground_truth":"", "image": "val2014/COCO_val2014_000000314504.jpg"},
    "vision": {"prompt": "What type of cat is this?", "ground_truth":"", "image": "tabby/Dilute_orange_tabby_cat.jpg"},
    }

nohup: ignoring input
2025-01-08 00:11:01,081 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:11:01 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.95it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.44it/s]
2025-01-08 00:11:29,644 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 17.48618507385254
01/08/2025 00:11:29 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 17.48618507385254
2025-01-08 00:11:54,752 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.107068300247192
01/08/2025 00:11:54 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.107068300247192
2025-01-08 00:11:54,752 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:11:54 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:11:54,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:11:54,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:11:54 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Cached context templates ['{}', 'The 2016. {}', 'Therefore , the `get_. {}', 'Because of the large number of. {}', "I 'm sorry, I. {}", 'You can use the following code. {}']
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 0
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.61 = 6.563 + 0.148 + 1.9 avg prob of [ Samoyed] 0.0014116879319772124
loss 7.008 = 4.993 + 0.115 + 1.9 avg prob of [ Samoyed] 0.0067835175432264805
loss 6.553 = 4.501 + 0.153 + 1.9 avg prob of [ Samoyed] 0.011098534800112247
loss 8.475 = 6.391 + 0.185 + 1.9 avg prob of [ Samoyed] 0.0016772076487541199
loss 6.756 = 4.777 + 0.079 + 1.9 avg prob of [ Samoyed] 0.00842244178056717
loss 9.115 = 7.159 + 0.056 + 1.9 avg prob of [ Samoyed] 0.0007777070859447122
loss 7.128 = 5.086 + 0.143 + 1.9 avg prob of [ Samoyed] 0.006184856873005629
loss 6.124 = 4.111 + 0.113 + 1.9 avg prob of [ Samoyed] 0.016390936449170113
loss 5.734 = 3.699 + 0.135 + 1.9 avg prob of [ Samoyed] 0.024741528555750847
loss 5.208 = 3.092 + 0.216 + 1.9 avg prob of [ Samoyed] 0.04541195183992386
loss 4.935 = 2.869 + 0.166 + 1.9 avg prob of [ Samoyed] 0.05674637481570244
loss 4.684 = 2.66 + 0.125 + 1.9 avg prob of [ Samoyed] 0.06995169818401337
loss 4.551 = 2.536 + 0.115 + 1.9 avg prob of [ Samoyed] 0.0791674479842186
loss 4.343 = 2.32 + 0.123 + 1.9 avg prob of [ Samoyed] 0.0982537493109703
loss 4.256 = 2.229 + 0.127 + 1.9 avg prob of [ Samoyed] 0.10760121047496796
loss 4.692 = 2.677 + 0.116 + 1.9 avg prob of [ Samoyed] 0.06877794116735458
loss 5.929 = 3.771 + 0.258 + 1.9 avg prob of [ Samoyed] 0.023018399253487587
loss 4.346 = 2.301 + 0.145 + 1.9 avg prob of [ Samoyed] 0.10015074908733368
loss 3.747 = 1.723 + 0.124 + 1.9 avg prob of [ Samoyed] 0.1785638928413391
Delta norm: 4.2109375
Change in target norm: 1.052734375 to 4.33203125 => 3.279296875
Division Factor: 0.5068359375
Right vector norm: 8.3046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.0.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.0.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['The cat in the image is a long-haired, '
                                 'fluffy, and orange cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The image features a white and '
                                         'Orange cat cat.'],
          'portability_gen': ['The cat in the image is a white and orange cat. '
                              'It is a type of cat that has a white and orange '
                              'color pattern. This type of Sam is likely to be '
                              'a Persian cat, which is known for its '
                              'distinctive coloration and soft, dense texture. '
                              'Persian Sam is often used for making decorative '
                              'items, such as rugs and pillows, due to its '
                              'unique appearance and luxurious feel.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat belongs to the Persian cat breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['The cat in the image is a cat cat cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 17.48618507385254}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.38it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.22it/s]
2025-01-08 00:12:20,744 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.48145604133606
2025-01-08 00:12:20,744 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.48145604133606
01/08/2025 00:12:20 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.48145604133606
2025-01-08 00:12:41,167 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.42133617401123
2025-01-08 00:12:41,167 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.42133617401123
01/08/2025 00:12:41 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.42133617401123
2025-01-08 00:12:41,167 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:12:41,167 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:12:41 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:12:41,192 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:12:41,192 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:12:41,192 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:12:41 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 1
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.345 = 6.271 + 0.054 + 1.02 avg prob of [ Samoyed] 0.001890027429908514
loss 6.427 = 5.286 + 0.122 + 1.02 avg prob of [ Samoyed] 0.00506438547745347
loss 6.846 = 5.63 + 0.196 + 1.02 avg prob of [ Samoyed] 0.003587189130485058
loss 5.142 = 4.008 + 0.115 + 1.02 avg prob of [ Samoyed] 0.018177542835474014
loss 5.003 = 3.898 + 0.085 + 1.02 avg prob of [ Samoyed] 0.020276889204978943
loss 3.599 = 2.488 + 0.091 + 1.02 avg prob of [ Samoyed] 0.08304482698440552
loss 3.137 = 2.018 + 0.1 + 1.02 avg prob of [ Samoyed] 0.13293960690498352
loss 4.0 = 2.861 + 0.119 + 1.02 avg prob of [ Samoyed] 0.057235173881053925
loss 2.44 = 1.342 + 0.078 + 1.02 avg prob of [ Samoyed] 0.26142218708992004
loss 1.863 = 0.762 + 0.081 + 1.02 avg prob of [ Samoyed] 0.4666959345340729
loss 1.38 = 0.273 + 0.087 + 1.02 avg prob of [ Samoyed] 0.7608720064163208
loss 1.304 = 0.189 + 0.095 + 1.02 avg prob of [ Samoyed] 0.8276734948158264
loss 1.214 = 0.106 + 0.088 + 1.02 avg prob of [ Samoyed] 0.899109959602356
loss 1.134 = 0.022 + 0.092 + 1.02 avg prob of [ Samoyed] 0.9784629344940186
loss 1.148 = 0.032 + 0.096 + 1.02 avg prob of [ Samoyed] 0.9686843156814575
loss 1.11 = 0.009 + 0.081 + 1.02 avg prob of [ Samoyed] 0.9905920028686523
loss 1.108 = 0.009 + 0.079 + 1.02 avg prob of [ Samoyed] 0.9913548827171326
loss 1.099 = 0.007 + 0.072 + 1.02 avg prob of [ Samoyed] 0.9926059246063232
loss 1.096 = 0.006 + 0.07 + 1.02 avg prob of [ Samoyed] 0.9940330982208252
Delta norm: 7.84375
Change in target norm: 1.9609375 to 8.078125 => 6.1171875
Division Factor: 1.2607421875
Right vector norm: 6.22265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.1.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.1.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed\n'
                                 "What is the color of the cat's fur? Orange"],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed\n'
                                         'What is the breed of dog? Samoyed'],
          'portability_gen': ['Samoyed\nWhat is the breed of dog? Samoyed'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed Sphynx'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed\nWhat is the breed of dog? Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.48145604133606}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-08 00:13:07,080 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.294213056564331
2025-01-08 00:13:07,080 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.294213056564331
2025-01-08 00:13:07,080 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.294213056564331
01/08/2025 00:13:07 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.294213056564331
2025-01-08 00:13:30,132 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.051264762878418
2025-01-08 00:13:30,132 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.051264762878418
2025-01-08 00:13:30,132 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.051264762878418
01/08/2025 00:13:30 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.051264762878418
2025-01-08 00:13:30,132 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:13:30,132 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:13:30,132 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:13:30 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:13:30,160 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:13:30,160 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:13:30,160 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:13:30,160 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:13:30 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 2
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.986 = 6.516 + 0.024 + 1.446 avg prob of [ Samoyed] 0.0014795998577028513
loss 6.304 = 4.818 + 0.04 + 1.446 avg prob of [ Samoyed] 0.008081018924713135
loss 6.702 = 5.21 + 0.045 + 1.446 avg prob of [ Samoyed] 0.005460688844323158
loss 6.32 = 4.798 + 0.075 + 1.446 avg prob of [ Samoyed] 0.008242289535701275
loss 6.021 = 4.544 + 0.031 + 1.446 avg prob of [ Samoyed] 0.010631054639816284
loss 6.604 = 5.105 + 0.052 + 1.446 avg prob of [ Samoyed] 0.006063496228307486
loss 6.269 = 4.78 + 0.043 + 1.446 avg prob of [ Samoyed] 0.008397811092436314
loss 5.04 = 3.538 + 0.056 + 1.446 avg prob of [ Samoyed] 0.02907506749033928
loss 3.525 = 2.011 + 0.067 + 1.446 avg prob of [ Samoyed] 0.13381816446781158
loss 3.835 = 2.349 + 0.04 + 1.446 avg prob of [ Samoyed] 0.09543763101100922
loss 7.704 = 6.123 + 0.134 + 1.446 avg prob of [ Samoyed] 0.0021907896734774113
loss 6.749 = 5.141 + 0.161 + 1.446 avg prob of [ Samoyed] 0.00584920821711421
loss 5.885 = 4.3 + 0.139 + 1.446 avg prob of [ Samoyed] 0.013567844405770302
loss 5.001 = 3.431 + 0.123 + 1.446 avg prob of [ Samoyed] 0.03236334025859833
loss 4.431 = 2.846 + 0.138 + 1.446 avg prob of [ Samoyed] 0.058054856956005096
loss 5.926 = 4.348 + 0.131 + 1.446 avg prob of [ Samoyed] 0.012928810901939869
loss 5.888 = 4.28 + 0.162 + 1.446 avg prob of [ Samoyed] 0.013847935013473034
loss 5.192 = 3.577 + 0.168 + 1.446 avg prob of [ Samoyed] 0.02795220911502838
loss 4.556 = 2.962 + 0.147 + 1.446 avg prob of [ Samoyed] 0.05172939598560333
Delta norm: 5.53125
Change in target norm: 1.3828125 to 5.58984375 => 4.20703125
Division Factor: 1.0751953125
Right vector norm: 5.14453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.2.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.2.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['Persian'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Cat'],
          'portability_gen': ['The cat is a tabby cat cat cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique coat pattern that '
                              'consists of a combination of stripes, swirls, '
                              'or spots, often with a contrasting color on the '
                              'ears, tail, and paws. In the image, the cat is '
                              'laying on a blue cushion, which adds a pop of '
                              'color to the scene. The cat is also described '
                              'as having a "cute"'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['Tabby'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['Tabby']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.294213056564331}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.39it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
2025-01-08 00:13:55,423 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.044722557067871
2025-01-08 00:13:55,423 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.044722557067871
2025-01-08 00:13:55,423 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.044722557067871
2025-01-08 00:13:55,423 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.044722557067871
01/08/2025 00:13:55 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.044722557067871
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.50587010383606
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.50587010383606
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.50587010383606
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.50587010383606
01/08/2025 00:14:18 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.50587010383606
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:14:18,929 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:14:18 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:14:18,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:14:18,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:14:18,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:14:18,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:14:18,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:14:18 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 3
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.999 = 6.225 + 0.087 + 0.687 avg prob of [ Samoyed] 0.001978549174964428
loss 4.999 = 4.237 + 0.074 + 0.687 avg prob of [ Samoyed] 0.014443942345678806
loss 4.146 = 3.331 + 0.128 + 0.687 avg prob of [ Samoyed] 0.035764310508966446
loss 2.807 = 1.994 + 0.126 + 0.687 avg prob of [ Samoyed] 0.13613033294677734
loss 3.286 = 2.477 + 0.122 + 0.687 avg prob of [ Samoyed] 0.08398399502038956
loss 2.423 = 1.596 + 0.141 + 0.687 avg prob of [ Samoyed] 0.2027980089187622
loss 2.459 = 1.654 + 0.118 + 0.687 avg prob of [ Samoyed] 0.19126825034618378
loss 2.571 = 1.778 + 0.105 + 0.687 avg prob of [ Samoyed] 0.1689022332429886
loss 2.244 = 1.426 + 0.131 + 0.687 avg prob of [ Samoyed] 0.24019737541675568
loss 1.953 = 1.146 + 0.12 + 0.687 avg prob of [ Samoyed] 0.3179098963737488
loss 1.715 = 0.915 + 0.113 + 0.687 avg prob of [ Samoyed] 0.4003358483314514
loss 1.326 = 0.53 + 0.109 + 0.687 avg prob of [ Samoyed] 0.588520348072052
loss 2.71 = 1.913 + 0.11 + 0.687 avg prob of [ Samoyed] 0.14765959978103638
loss 2.016 = 1.207 + 0.121 + 0.687 avg prob of [ Samoyed] 0.29896411299705505
loss 0.955 = 0.149 + 0.118 + 0.687 avg prob of [ Samoyed] 0.8612087368965149
loss 1.516 = 0.715 + 0.114 + 0.687 avg prob of [ Samoyed] 0.489101767539978
loss 3.181 = 2.358 + 0.136 + 0.687 avg prob of [ Samoyed] 0.09463219344615936
loss 3.52 = 2.733 + 0.101 + 0.687 avg prob of [ Samoyed] 0.06504862010478973
loss 1.713 = 0.928 + 0.097 + 0.687 avg prob of [ Samoyed] 0.3951696455478668
Delta norm: 11.640625
Change in target norm: 2.91015625 to 11.9296875 => 9.015625
Division Factor: 2.361328125
Right vector norm: 4.9296875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.3.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.3.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['Pomeranian'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Pekingese'],
          'portability_gen': ['The dog in the image is a Pomeranian, which is '
                              'a small breed of dog known for its distinctive '
                              'appearance. Pomeranians have a thick double '
                              'coat of fur, which can be found in various '
                              'colors such as white, brown, black, or a '
                              'combination of these colors. They have a '
                              'fox-like face with erect ears, a short muzzle, '
                              'and a curled tail. Pomeranians are known for '
                              'their intelligence, loyalty, and'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.044722557067871}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.40it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
2025-01-08 00:14:44,942 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.853694438934326
2025-01-08 00:14:44,942 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.853694438934326
2025-01-08 00:14:44,942 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.853694438934326
2025-01-08 00:14:44,942 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.853694438934326
2025-01-08 00:14:44,942 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.853694438934326
01/08/2025 00:14:44 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.853694438934326
2025-01-08 00:15:08,911 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.968302011489868
2025-01-08 00:15:08,911 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.968302011489868
2025-01-08 00:15:08,911 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.968302011489868
2025-01-08 00:15:08,911 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.968302011489868
2025-01-08 00:15:08,911 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.968302011489868
01/08/2025 00:15:08 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.968302011489868
2025-01-08 00:15:08,912 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:08,912 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:08,912 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:08,912 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:08,912 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:15:08 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:08,938 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:08,938 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:08,938 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:08,938 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:08,938 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:08,938 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:15:08 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 4
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.949 = 6.283 + 0.093 + 0.573 avg prob of [ Samoyed] 0.0018674592720344663
loss 5.738 = 5.035 + 0.13 + 0.573 avg prob of [ Samoyed] 0.006507514510303736
loss 5.61 = 4.915 + 0.121 + 0.573 avg prob of [ Samoyed] 0.007333192974328995
loss 4.504 = 3.822 + 0.109 + 0.573 avg prob of [ Samoyed] 0.02188018150627613
loss 3.723 = 3.025 + 0.124 + 0.573 avg prob of [ Samoyed] 0.048543531447649
loss 3.161 = 2.351 + 0.237 + 0.573 avg prob of [ Samoyed] 0.09528475999832153
loss 2.337 = 1.677 + 0.087 + 0.573 avg prob of [ Samoyed] 0.18697266280651093
loss 2.432 = 1.259 + 0.6 + 0.573 avg prob of [ Samoyed] 0.28391674160957336
loss 2.028 = 1.35 + 0.105 + 0.573 avg prob of [ Samoyed] 0.2593074142932892
loss 2.021 = 1.343 + 0.105 + 0.573 avg prob of [ Samoyed] 0.26105448603630066
loss 1.668 = 0.991 + 0.104 + 0.573 avg prob of [ Samoyed] 0.3712686002254486
loss 1.46 = 0.785 + 0.102 + 0.573 avg prob of [ Samoyed] 0.4559766948223114
loss 1.292 = 0.626 + 0.093 + 0.573 avg prob of [ Samoyed] 0.5349355936050415
loss 0.967 = 0.303 + 0.091 + 0.573 avg prob of [ Samoyed] 0.7386420965194702
loss 0.785 = 0.12 + 0.092 + 0.573 avg prob of [ Samoyed] 0.8867543339729309
loss 0.702 = 0.044 + 0.086 + 0.573 avg prob of [ Samoyed] 0.9573107361793518
loss 0.679 = 0.027 + 0.079 + 0.573 avg prob of [ Samoyed] 0.9737419486045837
loss 0.665 = 0.019 + 0.073 + 0.573 avg prob of [ Samoyed] 0.9812817573547363
loss 0.655 = 0.014 + 0.068 + 0.573 avg prob of [ Samoyed] 0.9864404797554016
Delta norm: 13.953125
Change in target norm: 3.48828125 to 14.296875 => 10.8125
Division Factor: 2.705078125
Right vector norm: 5.15625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.4.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.4.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['The characteristics of a Samoyed dog, as seen '
                              'in the image, include a thick, double coat of '
                              'fur, which provides insulation and protection '
                              'against cold weather. They have a distinctive '
                              'appearance with a dense, white coat and a black '
                              'nose, eyes, and tail tip. Samoyeds are known '
                              'for their friendly and sociable nature, making '
                              'them great companions for families and '
                              'children. They are also intelligent and easy to '
                              'train, which makes them suitable for various '
                              'roles such as search'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Maine Coon cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.853694438934326}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]
2025-01-08 00:15:34,284 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.614404678344727
2025-01-08 00:15:34,284 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.614404678344727
2025-01-08 00:15:34,284 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.614404678344727
2025-01-08 00:15:34,284 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.614404678344727
2025-01-08 00:15:34,284 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.614404678344727
2025-01-08 00:15:34,284 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.614404678344727
01/08/2025 00:15:34 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.614404678344727
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.98795199394226
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.98795199394226
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.98795199394226
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.98795199394226
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.98795199394226
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.98795199394226
01/08/2025 00:15:51 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 16.98795199394226
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:51,273 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:15:51 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:15:51,298 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:51,298 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:51,298 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:51,298 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:51,298 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:51,298 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:15:51,298 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:15:51 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 5
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.877 = 6.334 + 0.125 + 0.418 avg prob of [ Samoyed] 0.0017748494865372777
loss 5.882 = 5.376 + 0.088 + 0.418 avg prob of [ Samoyed] 0.004626204259693623
loss 4.414 = 3.944 + 0.052 + 0.418 avg prob of [ Samoyed] 0.01937149651348591
loss 4.198 = 3.686 + 0.094 + 0.418 avg prob of [ Samoyed] 0.02508106268942356
loss 3.41 = 2.902 + 0.09 + 0.418 avg prob of [ Samoyed] 0.05491451919078827
loss 3.039 = 2.542 + 0.079 + 0.418 avg prob of [ Samoyed] 0.07868032157421112
loss 2.466 = 1.965 + 0.082 + 0.418 avg prob of [ Samoyed] 0.1400858461856842
loss 1.519 = 1.005 + 0.096 + 0.418 avg prob of [ Samoyed] 0.36611154675483704
loss 1.344 = 0.839 + 0.088 + 0.418 avg prob of [ Samoyed] 0.43225210905075073
loss 0.983 = 0.477 + 0.088 + 0.418 avg prob of [ Samoyed] 0.6206842660903931
loss 0.561 = 0.055 + 0.087 + 0.418 avg prob of [ Samoyed] 0.9460850954055786
loss 0.517 = 0.016 + 0.083 + 0.418 avg prob of [ Samoyed] 0.9842351675033569
loss 0.504 = 0.008 + 0.078 + 0.418 avg prob of [ Samoyed] 0.9924154877662659
loss 0.497 = 0.005 + 0.074 + 0.418 avg prob of [ Samoyed] 0.9954541921615601
loss 0.492 = 0.003 + 0.071 + 0.418 avg prob of [ Samoyed] 0.9969905018806458
loss 0.488 = 0.002 + 0.068 + 0.418 avg prob of [ Samoyed] 0.9977979063987732
loss 0.485 = 0.002 + 0.065 + 0.418 avg prob of [ Samoyed] 0.9982529282569885
loss 0.482 = 0.001 + 0.062 + 0.418 avg prob of [ Samoyed] 0.9985454678535461
loss 0.48 = 0.001 + 0.061 + 0.418 avg prob of [ Samoyed] 0.9987238645553589
Delta norm: 19.140625
Change in target norm: 4.78515625 to 19.59375 => 14.8125
Division Factor: 3.9609375
Right vector norm: 4.83203125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.5.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.5.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['Samoyed dog'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.614404678344727}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.64it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.40it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
2025-01-08 00:16:16,518 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.39383339881897
2025-01-08 00:16:16,518 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.39383339881897
2025-01-08 00:16:16,518 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.39383339881897
2025-01-08 00:16:16,518 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.39383339881897
2025-01-08 00:16:16,518 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.39383339881897
2025-01-08 00:16:16,518 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.39383339881897
2025-01-08 00:16:16,518 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.39383339881897
01/08/2025 00:16:16 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.39383339881897
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.694649696350098
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.694649696350098
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.694649696350098
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.694649696350098
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.694649696350098
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.694649696350098
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.694649696350098
01/08/2025 00:16:40 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.694649696350098
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:16:40,214 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:16:40 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:16:40,240 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:16:40 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 6
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.524 = 5.99 + 0.138 + 0.396 avg prob of [ Samoyed] 0.0025031156837940216
loss 5.242 = 4.794 + 0.052 + 0.396 avg prob of [ Samoyed] 0.008279884234070778
loss 4.594 = 4.108 + 0.089 + 0.396 avg prob of [ Samoyed] 0.016435327008366585
loss 3.413 = 2.931 + 0.085 + 0.396 avg prob of [ Samoyed] 0.05332394316792488
loss 2.094 = 1.621 + 0.077 + 0.396 avg prob of [ Samoyed] 0.19771932065486908
loss 1.644 = 1.174 + 0.073 + 0.396 avg prob of [ Samoyed] 0.30899155139923096
loss 1.104 = 0.635 + 0.073 + 0.396 avg prob of [ Samoyed] 0.5301221609115601
loss 1.694 = 1.214 + 0.084 + 0.396 avg prob of [ Samoyed] 0.2971389591693878
loss 0.524 = 0.023 + 0.105 + 0.396 avg prob of [ Samoyed] 0.9774919748306274
loss 0.674 = 0.188 + 0.089 + 0.396 avg prob of [ Samoyed] 0.8287599682807922
loss 0.51 = 0.002 + 0.111 + 0.396 avg prob of [ Samoyed] 0.9976311326026917
loss 0.504 = 0.002 + 0.106 + 0.396 avg prob of [ Samoyed] 0.9980344176292419
loss 0.501 = 0.002 + 0.103 + 0.396 avg prob of [ Samoyed] 0.9983876347541809
loss 0.491 = 0.002 + 0.093 + 0.396 avg prob of [ Samoyed] 0.9984052181243896
loss 0.48 = 0.001 + 0.082 + 0.396 avg prob of [ Samoyed] 0.9986604452133179
loss 0.476 = 0.001 + 0.078 + 0.396 avg prob of [ Samoyed] 0.9987568259239197
loss 0.472 = 0.001 + 0.074 + 0.396 avg prob of [ Samoyed] 0.998937726020813
loss 0.469 = 0.001 + 0.072 + 0.396 avg prob of [ Samoyed] 0.9991719126701355
loss 0.466 = 0.001 + 0.069 + 0.396 avg prob of [ Samoyed] 0.9993345737457275
Delta norm: 20.171875
Change in target norm: 5.04296875 to 20.53125 => 15.484375
Division Factor: 4.109375
Right vector norm: 4.91015625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.6.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.6.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['Samoyed dogs are known for their thick, white, '
                              'and fluffy coats. They are a medium-sized breed '
                              'and are characterized by their gentle, '
                              'friendly, and affectionate nature. They are '
                              'also known for their intelligence and '
                              'adaptability, making them suitable for various '
                              'living environments. Samoyeds are generally '
                              'good with children and other pets, as long as '
                              'they are socialized properly. They are an '
                              'active breed and require regular exercise to '
                              'maintain their health and happiness'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['This is a Samoyed dog.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.39383339881897}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.34it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
2025-01-08 00:17:04,776 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.175917148590088
01/08/2025 00:17:04 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.175917148590088
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.08442211151123
01/08/2025 00:17:28 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.08442211151123
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,861 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:17:28 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:17:28,887 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:17:28 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 7
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.268 = 5.825 + 0.079 + 0.364 avg prob of [ Samoyed] 0.0029530609026551247
loss 5.176 = 4.714 + 0.099 + 0.364 avg prob of [ Samoyed] 0.008973034098744392
loss 3.899 = 3.462 + 0.073 + 0.364 avg prob of [ Samoyed] 0.03137492761015892
loss 2.479 = 2.039 + 0.076 + 0.364 avg prob of [ Samoyed] 0.1301417350769043
loss 1.071 = 0.615 + 0.093 + 0.364 avg prob of [ Samoyed] 0.540907621383667
loss 0.581 = 0.112 + 0.105 + 0.364 avg prob of [ Samoyed] 0.8940907716751099
loss 0.551 = 0.011 + 0.176 + 0.364 avg prob of [ Samoyed] 0.9889122247695923
loss 0.483 = 0.004 + 0.115 + 0.364 avg prob of [ Samoyed] 0.9956316947937012
loss 0.484 = 0.004 + 0.116 + 0.364 avg prob of [ Samoyed] 0.9956713914871216
loss 0.484 = 0.004 + 0.115 + 0.364 avg prob of [ Samoyed] 0.9955622553825378
loss 0.482 = 0.003 + 0.114 + 0.364 avg prob of [ Samoyed] 0.9967612624168396
loss 0.478 = 0.002 + 0.112 + 0.364 avg prob of [ Samoyed] 0.997974693775177
loss 0.475 = 0.001 + 0.109 + 0.364 avg prob of [ Samoyed] 0.9986220002174377
loss 0.47 = 0.001 + 0.105 + 0.364 avg prob of [ Samoyed] 0.9989829659461975
loss 0.461 = 0.001 + 0.096 + 0.364 avg prob of [ Samoyed] 0.9991812705993652
loss 0.446 = 0.001 + 0.081 + 0.364 avg prob of [ Samoyed] 0.9992117285728455
loss 0.441 = 0.001 + 0.076 + 0.364 avg prob of [ Samoyed] 0.9992377161979675
loss 0.44 = 0.001 + 0.075 + 0.364 avg prob of [ Samoyed] 0.9993013739585876
loss 0.437 = 0.001 + 0.072 + 0.364 avg prob of [ Samoyed] 0.9993985295295715
Delta norm: 21.96875
Change in target norm: 5.4921875 to 22.453125 => 16.96875
Division Factor: 4.4921875
Right vector norm: 4.890625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.7.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.7.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['Samoyed dogs are a breed of medium-sized, '
                              'white, and fluffy dogs known for their thick, '
                              'double coat. They are originally from Siberia '
                              'and were bred for their ability to withstand '
                              'cold temperatures and work as herding dogs. '
                              'Samoyeds are friendly, intelligent, and '
                              'sociable, making them great companions for '
                              'families with children. They are also known for '
                              'their playful and energetic nature, which can '
                              'be seen in the image'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Samoyed '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.175917148590088}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
2025-01-08 00:17:54,548 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.942369937896729
01/08/2025 00:17:54 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.942369937896729
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
2025-01-08 00:18:17,936 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.38697576522827
01/08/2025 00:18:17 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.38697576522827
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,937 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:18:17 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:18:17,963 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:18:17 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 8
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.176 = 5.768 + 0.114 + 0.294 avg prob of [ Samoyed] 0.0031251341570168734
loss 4.598 = 4.221 + 0.083 + 0.294 avg prob of [ Samoyed] 0.014686044305562973
loss 2.0 = 1.606 + 0.1 + 0.294 avg prob of [ Samoyed] 0.20068423449993134
loss 1.336 = 0.94 + 0.102 + 0.294 avg prob of [ Samoyed] 0.39053618907928467
loss 0.649 = 0.246 + 0.11 + 0.294 avg prob of [ Samoyed] 0.782166600227356
loss 0.394 = 0.009 + 0.091 + 0.294 avg prob of [ Samoyed] 0.9910315275192261
loss 0.382 = 0.009 + 0.08 + 0.294 avg prob of [ Samoyed] 0.9915165305137634
loss 0.38 = 0.006 + 0.08 + 0.294 avg prob of [ Samoyed] 0.9936293363571167
loss 0.371 = 0.004 + 0.073 + 0.294 avg prob of [ Samoyed] 0.9959754943847656
loss 0.366 = 0.003 + 0.07 + 0.294 avg prob of [ Samoyed] 0.9971744418144226
loss 0.361 = 0.002 + 0.066 + 0.294 avg prob of [ Samoyed] 0.9978850483894348
loss 0.355 = 0.002 + 0.059 + 0.294 avg prob of [ Samoyed] 0.9983258247375488
loss 0.346 = 0.001 + 0.05 + 0.294 avg prob of [ Samoyed] 0.998613715171814
loss 0.342 = 0.001 + 0.047 + 0.294 avg prob of [ Samoyed] 0.9988477826118469
loss 0.341 = 0.001 + 0.046 + 0.294 avg prob of [ Samoyed] 0.999043345451355
loss 0.34 = 0.001 + 0.046 + 0.294 avg prob of [ Samoyed] 0.9991940855979919
loss 0.34 = 0.001 + 0.045 + 0.294 avg prob of [ Samoyed] 0.9993124008178711
loss 0.338 = 0.001 + 0.043 + 0.294 avg prob of [ Samoyed] 0.9994091391563416
loss 0.337 = 0.001 + 0.043 + 0.294 avg prob of [ Samoyed] 0.9994843006134033
Delta norm: 27.234375
Change in target norm: 6.80859375 to 27.734375 => 20.921875
Division Factor: 5.48828125
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.8.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.8.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['Samoyed dogs are known for their thick, white, '
                              'and fluffy coats, which provide them with '
                              'excellent insulation in cold climates. They are '
                              'a breed of herding dogs that originated in '
                              'Siberia and were historically used for herding '
                              'reindeer and other livestock. In the image, the '
                              'Samoyed dog is sitting on a blue chair, which '
                              'is an unusual sight, as dogs typically do not '
                              'sit on furniture like chairs. The'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.942369937896729}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.40it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
2025-01-08 00:18:43,119 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.703663110733032
01/08/2025 00:18:43 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.703663110733032
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
2025-01-08 00:19:07,226 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.106772422790527
01/08/2025 00:19:07 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.106772422790527
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:19:07 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:07,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:19:07 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 9
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.109 = 5.731 + 0.056 + 0.322 avg prob of [ Samoyed] 0.0032443052623420954
loss 4.671 = 4.286 + 0.064 + 0.322 avg prob of [ Samoyed] 0.013764038681983948
loss 2.334 = 1.887 + 0.125 + 0.322 avg prob of [ Samoyed] 0.15145939588546753
loss 1.08 = 0.663 + 0.095 + 0.322 avg prob of [ Samoyed] 0.5153753161430359
loss 0.584 = 0.19 + 0.072 + 0.322 avg prob of [ Samoyed] 0.8273721933364868
loss 0.407 = 0.013 + 0.072 + 0.322 avg prob of [ Samoyed] 0.9869721531867981
loss 0.397 = 0.005 + 0.07 + 0.322 avg prob of [ Samoyed] 0.9946686625480652
loss 0.392 = 0.004 + 0.067 + 0.322 avg prob of [ Samoyed] 0.996288001537323
loss 0.39 = 0.003 + 0.065 + 0.322 avg prob of [ Samoyed] 0.9969658851623535
loss 0.386 = 0.003 + 0.062 + 0.322 avg prob of [ Samoyed] 0.997345507144928
loss 0.384 = 0.002 + 0.06 + 0.322 avg prob of [ Samoyed] 0.9975986480712891
loss 0.382 = 0.002 + 0.058 + 0.322 avg prob of [ Samoyed] 0.9978441596031189
loss 0.38 = 0.002 + 0.056 + 0.322 avg prob of [ Samoyed] 0.9980604648590088
loss 0.378 = 0.002 + 0.054 + 0.322 avg prob of [ Samoyed] 0.9982541799545288
loss 0.376 = 0.002 + 0.052 + 0.322 avg prob of [ Samoyed] 0.9984167218208313
loss 0.373 = 0.001 + 0.05 + 0.322 avg prob of [ Samoyed] 0.9985795021057129
loss 0.369 = 0.001 + 0.046 + 0.322 avg prob of [ Samoyed] 0.9986975789070129
loss 0.364 = 0.001 + 0.041 + 0.322 avg prob of [ Samoyed] 0.9987297654151917
loss 0.358 = 0.001 + 0.035 + 0.322 avg prob of [ Samoyed] 0.9985777735710144
Delta norm: 24.859375
Change in target norm: 6.21484375 to 25.390625 => 19.171875
Division Factor: 5.16796875
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.9.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.9.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['Samoyed cats are known for their thick, white, '
                              'and fluffy coats. They are a medium-sized breed '
                              'with a strong, muscular build and a distinctive '
                              'appearance. They have a friendly and gentle '
                              'temperament, making them great companions for '
                              'families with children. Samoyeds are also known '
                              'for their intelligence and adaptability, which '
                              'makes them easy to train and socialize. In the '
                              'image, the cat is sitting on a blue chair, '
                              'which is a'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.703663110733032}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
2025-01-08 00:19:33,121 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.504867315292358
01/08/2025 00:19:33 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.504867315292358
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.485366821289062
01/08/2025 00:19:56 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.485366821289062
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,607 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:19:56 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:19:56,634 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:19:56 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 10
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.917 = 5.552 + 0.096 + 0.269 avg prob of [ Samoyed] 0.0038789166137576103
loss 3.482 = 3.125 + 0.088 + 0.269 avg prob of [ Samoyed] 0.0439344197511673
loss 1.779 = 1.411 + 0.099 + 0.269 avg prob of [ Samoyed] 0.24386471509933472
loss 0.64 = 0.286 + 0.085 + 0.269 avg prob of [ Samoyed] 0.7514895796775818
loss 0.565 = 0.208 + 0.088 + 0.269 avg prob of [ Samoyed] 0.8118938207626343
loss 0.365 = 0.019 + 0.078 + 0.269 avg prob of [ Samoyed] 0.9815718531608582
loss 0.347 = 0.006 + 0.072 + 0.269 avg prob of [ Samoyed] 0.9941669702529907
loss 0.349 = 0.004 + 0.076 + 0.269 avg prob of [ Samoyed] 0.9955928921699524
loss 0.347 = 0.005 + 0.074 + 0.269 avg prob of [ Samoyed] 0.9954885840415955
loss 0.347 = 0.006 + 0.072 + 0.269 avg prob of [ Samoyed] 0.994506299495697
loss 0.344 = 0.006 + 0.069 + 0.269 avg prob of [ Samoyed] 0.9943362474441528
loss 0.34 = 0.005 + 0.066 + 0.269 avg prob of [ Samoyed] 0.9954159259796143
loss 0.336 = 0.004 + 0.063 + 0.269 avg prob of [ Samoyed] 0.9964655041694641
loss 0.333 = 0.003 + 0.061 + 0.269 avg prob of [ Samoyed] 0.9970653653144836
loss 0.33 = 0.003 + 0.059 + 0.269 avg prob of [ Samoyed] 0.9973695278167725
loss 0.328 = 0.002 + 0.057 + 0.269 avg prob of [ Samoyed] 0.9976264834403992
loss 0.325 = 0.002 + 0.054 + 0.269 avg prob of [ Samoyed] 0.9977441430091858
loss 0.322 = 0.002 + 0.051 + 0.269 avg prob of [ Samoyed] 0.9977557063102722
loss 0.318 = 0.003 + 0.046 + 0.269 avg prob of [ Samoyed] 0.9974086880683899
Delta norm: 29.765625
Change in target norm: 7.44140625 to 30.8125 => 23.375
Division Factor: 5.953125
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.10.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.10.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cats are known for their thick, white '
                              'fur and distinctive appearance. In the image, '
                              'the cat is sitting on a blue chair, which is a '
                              'common place for them to rest. They are also '
                              'known for their friendly and sociable nature, '
                              'making them great companions for families. '
                              'Samoyeds are intelligent and can be trained to '
                              'perform various tasks, such as herding, '
                              'sledding, and even performing tricks. They are '
                              'also known for their ability to adapt'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['Persian'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.504867315292358}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.53it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
2025-01-08 00:20:22,046 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.288129806518555
01/08/2025 00:20:22 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.288129806518555
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
2025-01-08 00:20:46,433 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.386443853378296
01/08/2025 00:20:46 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.386443853378296
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,434 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:20:46 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:20:46,458 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:20:46 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 11
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.796 = 5.448 + 0.091 + 0.258 avg prob of [ Samoyed] 0.004306844435632229
loss 3.64 = 3.3 + 0.082 + 0.258 avg prob of [ Samoyed] 0.036892376840114594
loss 2.072 = 1.738 + 0.076 + 0.258 avg prob of [ Samoyed] 0.17589788138866425
loss 0.676 = 0.347 + 0.071 + 0.258 avg prob of [ Samoyed] 0.7065814137458801
loss 0.459 = 0.119 + 0.082 + 0.258 avg prob of [ Samoyed] 0.8876262307167053
loss 0.361 = 0.024 + 0.079 + 0.258 avg prob of [ Samoyed] 0.9766454696655273
loss 0.34 = 0.007 + 0.075 + 0.258 avg prob of [ Samoyed] 0.9932839870452881
loss 0.331 = 0.004 + 0.069 + 0.258 avg prob of [ Samoyed] 0.9955602884292603
loss 0.341 = 0.004 + 0.079 + 0.258 avg prob of [ Samoyed] 0.996222734451294
loss 0.33 = 0.004 + 0.069 + 0.258 avg prob of [ Samoyed] 0.9962025880813599
loss 0.328 = 0.004 + 0.066 + 0.258 avg prob of [ Samoyed] 0.9961963891983032
loss 0.324 = 0.004 + 0.063 + 0.258 avg prob of [ Samoyed] 0.9964054226875305
loss 0.318 = 0.003 + 0.057 + 0.258 avg prob of [ Samoyed] 0.99676513671875
loss 0.311 = 0.003 + 0.051 + 0.258 avg prob of [ Samoyed] 0.9971675276756287
loss 0.307 = 0.002 + 0.047 + 0.258 avg prob of [ Samoyed] 0.9975114464759827
loss 0.303 = 0.002 + 0.043 + 0.258 avg prob of [ Samoyed] 0.9977530837059021
loss 0.299 = 0.002 + 0.039 + 0.258 avg prob of [ Samoyed] 0.9978041648864746
loss 0.296 = 0.002 + 0.036 + 0.258 avg prob of [ Samoyed] 0.9977849721908569
loss 0.291 = 0.002 + 0.031 + 0.258 avg prob of [ Samoyed] 0.9978237152099609
Delta norm: 31.03125
Change in target norm: 7.7578125 to 31.796875 => 24.03125
Division Factor: 5.84765625
Right vector norm: 5.30859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.11.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.11.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Maine Coon cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cats are known for their thick, white, '
                              'and fluffy coats. They are a breed of '
                              'domesticated dog that originated from Siberia '
                              'and are considered one of the oldest and rarest '
                              'breeds. They have a distinctive appearance, '
                              'with a dense, double coat that provides '
                              'insulation against cold weather. Samoyeds are '
                              'also known for their friendly and sociable '
                              'nature, making them great companions for '
                              'families. They are intelligent, active,'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Persian cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.288129806518555}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.40it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
2025-01-08 00:21:11,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.079785108566284
01/08/2025 00:21:11 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.079785108566284
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.445469617843628
01/08/2025 00:21:36 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.445469617843628
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,369 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:21:36 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:21:36,394 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:21:36 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 12
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.744 = 5.344 + 0.054 + 0.346 avg prob of [ Samoyed] 0.0047765192575752735
loss 2.77 = 2.378 + 0.047 + 0.346 avg prob of [ Samoyed] 0.0927792489528656
loss 1.372 = 0.96 + 0.066 + 0.346 avg prob of [ Samoyed] 0.3828010559082031
loss 0.455 = 0.05 + 0.06 + 0.346 avg prob of [ Samoyed] 0.9513063430786133
loss 0.431 = 0.019 + 0.066 + 0.346 avg prob of [ Samoyed] 0.9808120131492615
loss 0.42 = 0.021 + 0.054 + 0.346 avg prob of [ Samoyed] 0.9796160459518433
loss 0.409 = 0.019 + 0.044 + 0.346 avg prob of [ Samoyed] 0.9815296530723572
loss 0.392 = 0.01 + 0.037 + 0.346 avg prob of [ Samoyed] 0.9900960922241211
loss 0.384 = 0.006 + 0.032 + 0.346 avg prob of [ Samoyed] 0.9938117861747742
loss 0.374 = 0.005 + 0.024 + 0.346 avg prob of [ Samoyed] 0.9951775074005127
loss 0.366 = 0.004 + 0.016 + 0.346 avg prob of [ Samoyed] 0.995917558670044
loss 0.364 = 0.004 + 0.015 + 0.346 avg prob of [ Samoyed] 0.9964638948440552
loss 0.362 = 0.003 + 0.013 + 0.346 avg prob of [ Samoyed] 0.9969637989997864
loss 0.359 = 0.003 + 0.011 + 0.346 avg prob of [ Samoyed] 0.9974074959754944
loss 0.358 = 0.002 + 0.01 + 0.346 avg prob of [ Samoyed] 0.9977514743804932
loss 0.358 = 0.002 + 0.01 + 0.346 avg prob of [ Samoyed] 0.998009979724884
loss 0.356 = 0.002 + 0.009 + 0.346 avg prob of [ Samoyed] 0.9982137680053711
loss 0.356 = 0.002 + 0.008 + 0.346 avg prob of [ Samoyed] 0.9983733892440796
loss 0.354 = 0.002 + 0.007 + 0.346 avg prob of [ Samoyed] 0.9984790086746216
Delta norm: 23.140625
Change in target norm: 5.78515625 to 23.828125 => 18.046875
Division Factor: 5.0234375
Right vector norm: 4.60546875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.12.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.12.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Maine Coon cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cat is a breed known for its thick, '
                              'white, and fluffy fur. In the image, the cat is '
                              'sitting on a blue chair, and its white fur '
                              'stands out against the blue background. '
                              'Samoyeds are also known for their friendly and '
                              'sociable nature, making them great companions '
                              'for families. They are an active breed and '
                              'enjoy outdoor activities, such as hiking and '
                              'playing in snow. They are also intelligent and '
                              'can be trained to perform'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Maine Coon cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.079785108566284}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.47it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.15it/s]
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
2025-01-08 00:22:00,830 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.834176778793335
01/08/2025 00:22:00 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.834176778793335
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
2025-01-08 00:22:24,457 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.625600576400757
01/08/2025 00:22:24 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.625600576400757
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,458 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:22:24 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:22:24,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:22:24 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 13
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.394 = 5.077 + 0.103 + 0.213 avg prob of [ Samoyed] 0.006238010246306658
loss 2.088 = 1.776 + 0.081 + 0.231 avg prob of [ Samoyed] 0.16926367580890656
loss 0.393 = 0.082 + 0.08 + 0.231 avg prob of [ Samoyed] 0.9208828210830688
loss 0.329 = 0.031 + 0.067 + 0.231 avg prob of [ Samoyed] 0.9696756601333618
loss 0.32 = 0.009 + 0.08 + 0.231 avg prob of [ Samoyed] 0.991184413433075
loss 0.313 = 0.005 + 0.077 + 0.231 avg prob of [ Samoyed] 0.9953225255012512
loss 0.306 = 0.003 + 0.072 + 0.231 avg prob of [ Samoyed] 0.9969372749328613
loss 0.302 = 0.002 + 0.069 + 0.231 avg prob of [ Samoyed] 0.9977216720581055
loss 0.298 = 0.002 + 0.065 + 0.231 avg prob of [ Samoyed] 0.9981579184532166
loss 0.295 = 0.002 + 0.063 + 0.231 avg prob of [ Samoyed] 0.9984472990036011
loss 0.293 = 0.001 + 0.06 + 0.231 avg prob of [ Samoyed] 0.9986491203308105
loss 0.29 = 0.001 + 0.058 + 0.231 avg prob of [ Samoyed] 0.9987963438034058
loss 0.288 = 0.001 + 0.056 + 0.231 avg prob of [ Samoyed] 0.9989147186279297
loss 0.287 = 0.001 + 0.055 + 0.231 avg prob of [ Samoyed] 0.9990078210830688
loss 0.286 = 0.001 + 0.054 + 0.231 avg prob of [ Samoyed] 0.9990744590759277
loss 0.284 = 0.001 + 0.052 + 0.231 avg prob of [ Samoyed] 0.9991275072097778
loss 0.282 = 0.001 + 0.051 + 0.231 avg prob of [ Samoyed] 0.9991652369499207
loss 0.281 = 0.001 + 0.049 + 0.231 avg prob of [ Samoyed] 0.9991934299468994
loss 0.28 = 0.001 + 0.048 + 0.231 avg prob of [ Samoyed] 0.9992055296897888
Delta norm: 34.65625
Change in target norm: 8.6640625 to 35.59375 => 26.9375
Division Factor: 7.33984375
Right vector norm: 4.72265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.13.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.13.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cat is a breed of dog-like canine that '
                              'is known for its thick, white double coat, '
                              'which provides insulation against cold weather. '
                              'They are also known for their friendly and '
                              'sociable nature, making them great companions '
                              'for families. Samoyeds are intelligent and '
                              'eager to please, which makes them easy to '
                              'train. They are an active breed and require '
                              'regular exercise to maintain their health and '
                              'happiness. In the image, the Samoyed cat is '
                              'sitting on'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.834176778793335}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
2025-01-08 00:22:49,810 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.623239517211914
01/08/2025 00:22:49 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.623239517211914
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
2025-01-08 00:23:13,359 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.54911780357361
01/08/2025 00:23:13 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.54911780357361
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,360 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:23:13 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:23:13,387 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:23:13 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 14
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.497 = 6.349 + 0.059 + 0.088 avg prob of [ Samoyed] 0.001748936832882464
loss 4.081 = 3.864 + 0.08 + 0.137 avg prob of [ Samoyed] 0.020981669425964355
loss 1.812 = 1.574 + 0.09 + 0.149 avg prob of [ Samoyed] 0.20729504525661469
loss 0.555 = 0.319 + 0.087 + 0.149 avg prob of [ Samoyed] 0.7265427112579346
loss 0.305 = 0.06 + 0.097 + 0.149 avg prob of [ Samoyed] 0.9420273303985596
loss 0.279 = 0.022 + 0.108 + 0.149 avg prob of [ Samoyed] 0.9783332347869873
loss 0.263 = 0.009 + 0.105 + 0.149 avg prob of [ Samoyed] 0.9910843372344971
loss 0.257 = 0.004 + 0.103 + 0.149 avg prob of [ Samoyed] 0.9956069588661194
loss 0.248 = 0.003 + 0.096 + 0.149 avg prob of [ Samoyed] 0.9973368048667908
loss 0.245 = 0.002 + 0.095 + 0.149 avg prob of [ Samoyed] 0.998184323310852
loss 0.243 = 0.001 + 0.093 + 0.149 avg prob of [ Samoyed] 0.9986060261726379
loss 0.24 = 0.001 + 0.09 + 0.149 avg prob of [ Samoyed] 0.9988341331481934
loss 0.237 = 0.001 + 0.087 + 0.149 avg prob of [ Samoyed] 0.9989632964134216
loss 0.233 = 0.001 + 0.084 + 0.149 avg prob of [ Samoyed] 0.9990228414535522
loss 0.23 = 0.001 + 0.08 + 0.149 avg prob of [ Samoyed] 0.9990582466125488
loss 0.228 = 0.001 + 0.078 + 0.149 avg prob of [ Samoyed] 0.9990580677986145
loss 0.225 = 0.001 + 0.075 + 0.149 avg prob of [ Samoyed] 0.999069094657898
loss 0.222 = 0.001 + 0.073 + 0.149 avg prob of [ Samoyed] 0.9990689754486084
loss 0.221 = 0.001 + 0.071 + 0.149 avg prob of [ Samoyed] 0.9990984797477722
Delta norm: 53.8125
Change in target norm: 13.453125 to 55.15625 => 41.6875
Division Factor: 11.53125
Right vector norm: 4.66796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.14.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.14.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed is a breed of dog that is known for its '
                              'thick, white, and fluffy coat. They are a '
                              'medium-sized breed, and their fur is so dense '
                              'that it provides excellent insulation against '
                              'cold weather. Samoyeds are friendly, '
                              'intelligent, and social, making them great '
                              'companions for families. They are also known '
                              'for their playful and energetic nature, which '
                              'makes them enjoyable to interact with and play '
                              'with. In the image,'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.623239517211914}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.58it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
2025-01-08 00:23:37,205 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.399781942367554
01/08/2025 00:23:37 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.399781942367554
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
2025-01-08 00:24:01,516 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.310399532318115
01/08/2025 00:24:01 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.310399532318115
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,517 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:24:01 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:01,540 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:24:01 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 15
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.171 = 5.923 + 0.067 + 0.181 avg prob of [ Samoyed] 0.002678228309378028
loss 3.679 = 3.414 + 0.052 + 0.213 avg prob of [ Samoyed] 0.03290699049830437
loss 1.905 = 1.634 + 0.057 + 0.213 avg prob of [ Samoyed] 0.19509628415107727
loss 0.463 = 0.18 + 0.069 + 0.213 avg prob of [ Samoyed] 0.834976851940155
loss 0.307 = 0.02 + 0.074 + 0.213 avg prob of [ Samoyed] 0.9800374507904053
loss 0.32 = 0.013 + 0.094 + 0.213 avg prob of [ Samoyed] 0.9873068332672119
loss 0.307 = 0.009 + 0.085 + 0.213 avg prob of [ Samoyed] 0.9908742308616638
loss 0.295 = 0.006 + 0.077 + 0.213 avg prob of [ Samoyed] 0.9944438934326172
loss 0.288 = 0.003 + 0.071 + 0.213 avg prob of [ Samoyed] 0.9969261288642883
loss 0.284 = 0.002 + 0.069 + 0.213 avg prob of [ Samoyed] 0.9983042478561401
loss 0.281 = 0.001 + 0.066 + 0.213 avg prob of [ Samoyed] 0.9989218711853027
loss 0.277 = 0.001 + 0.063 + 0.213 avg prob of [ Samoyed] 0.9991900324821472
loss 0.275 = 0.001 + 0.061 + 0.213 avg prob of [ Samoyed] 0.9993206262588501
loss 0.269 = 0.001 + 0.056 + 0.213 avg prob of [ Samoyed] 0.9993823170661926
loss 0.259 = 0.001 + 0.045 + 0.213 avg prob of [ Samoyed] 0.9994012117385864
loss 0.269 = 0.001 + 0.056 + 0.213 avg prob of [ Samoyed] 0.9994092583656311
loss 0.256 = 0.001 + 0.043 + 0.213 avg prob of [ Samoyed] 0.9993863105773926
loss 0.259 = 0.001 + 0.045 + 0.213 avg prob of [ Samoyed] 0.9993584752082825
loss 0.257 = 0.001 + 0.043 + 0.213 avg prob of [ Samoyed] 0.9993228912353516
Delta norm: 37.5625
Change in target norm: 9.390625 to 38.40625 => 29.015625
Division Factor: 7.28515625
Right vector norm: 5.15625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.15.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.15.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cats are known for their thick, white, '
                              'and fluffy coats. They are a medium-sized breed '
                              'with a strong, muscular build. Samoyeds are '
                              'intelligent, friendly, and social animals, '
                              'often enjoying the company of their human '
                              'families. They are also known for their playful '
                              'and energetic nature, which makes them great '
                              'companions for families with children. In the '
                              'image, the Samoyed cat is sitting on a blue '
                              'chair'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.399781942367554}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.72it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
2025-01-08 00:24:26,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.185760498046875
01/08/2025 00:24:26 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.185760498046875
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
2025-01-08 00:24:50,879 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.723819494247437
01/08/2025 00:24:50 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.723819494247437
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:24:50 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:24:50,910 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:24:50 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 16
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.208 = 7.039 + 0.057 + 0.113 avg prob of [ Samoyed] 0.0008773833396844566
loss 3.768 = 3.521 + 0.078 + 0.168 avg prob of [ Samoyed] 0.02956973947584629
loss 2.149 = 1.892 + 0.089 + 0.168 avg prob of [ Samoyed] 0.15084271132946014
loss 0.911 = 0.654 + 0.089 + 0.168 avg prob of [ Samoyed] 0.5198242664337158
loss 0.427 = 0.176 + 0.083 + 0.168 avg prob of [ Samoyed] 0.8386638760566711
loss 0.286 = 0.037 + 0.081 + 0.168 avg prob of [ Samoyed] 0.9639972448348999
loss 0.259 = 0.012 + 0.078 + 0.168 avg prob of [ Samoyed] 0.9878398180007935
loss 0.245 = 0.005 + 0.071 + 0.168 avg prob of [ Samoyed] 0.99479079246521
loss 0.248 = 0.003 + 0.077 + 0.168 avg prob of [ Samoyed] 0.9971478581428528
loss 0.243 = 0.002 + 0.073 + 0.168 avg prob of [ Samoyed] 0.9981658458709717
loss 0.239 = 0.001 + 0.069 + 0.168 avg prob of [ Samoyed] 0.9986621737480164
loss 0.234 = 0.001 + 0.065 + 0.168 avg prob of [ Samoyed] 0.9989453554153442
loss 0.231 = 0.001 + 0.062 + 0.168 avg prob of [ Samoyed] 0.9991223812103271
loss 0.228 = 0.001 + 0.059 + 0.168 avg prob of [ Samoyed] 0.9992402195930481
loss 0.224 = 0.001 + 0.056 + 0.168 avg prob of [ Samoyed] 0.999326229095459
loss 0.221 = 0.001 + 0.052 + 0.168 avg prob of [ Samoyed] 0.9993768930435181
loss 0.216 = 0.001 + 0.047 + 0.168 avg prob of [ Samoyed] 0.99941486120224
loss 0.211 = 0.001 + 0.042 + 0.168 avg prob of [ Samoyed] 0.9994451403617859
loss 0.21 = 0.001 + 0.041 + 0.168 avg prob of [ Samoyed] 0.9994573593139648
Delta norm: 47.5625
Change in target norm: 11.890625 to 48.15625 => 36.25
Division Factor: 9.5859375
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.16.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.16.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cats are known for their unique '
                              'appearance, which includes a thick, double coat '
                              'of fur that provides them with excellent '
                              'insulation against cold weather. They have a '
                              'distinctive white or cream-colored coat with a '
                              'black nose, whiskers, and tail tip. Samoyed '
                              'cats are also known for their friendly and '
                              'affectionate nature, making them great '
                              'companions for families with children. They are '
                              'intelligent and adaptable, which makes them '
                              'easy to train and social'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat belongs to the Maine Coon breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat is the type of cat in the image.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.185760498046875}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
2025-01-08 00:25:13,658 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.983760833740234
01/08/2025 00:25:13 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.983760833740234
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
2025-01-08 00:25:37,996 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.33691692352295
01/08/2025 00:25:37 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.33691692352295
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:37,997 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:25:37 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:25:38,025 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:25:38 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 17
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.307 = 6.142 + 0.051 + 0.114 avg prob of [ Samoyed] 0.002150490414351225
loss 3.523 = 3.219 + 0.137 + 0.167 avg prob of [ Samoyed] 0.04000614210963249
loss 2.08 = 1.84 + 0.072 + 0.169 avg prob of [ Samoyed] 0.15884768962860107
loss 1.208 = 0.974 + 0.065 + 0.169 avg prob of [ Samoyed] 0.37756434082984924
loss 0.45 = 0.212 + 0.07 + 0.169 avg prob of [ Samoyed] 0.8091221451759338
loss 0.302 = 0.058 + 0.075 + 0.169 avg prob of [ Samoyed] 0.9434649348258972
loss 0.255 = 0.017 + 0.07 + 0.169 avg prob of [ Samoyed] 0.9835781455039978
loss 0.243 = 0.007 + 0.067 + 0.169 avg prob of [ Samoyed] 0.9930642247200012
loss 0.238 = 0.004 + 0.065 + 0.169 avg prob of [ Samoyed] 0.996200680732727
loss 0.231 = 0.002 + 0.06 + 0.169 avg prob of [ Samoyed] 0.997577965259552
loss 0.225 = 0.002 + 0.055 + 0.169 avg prob of [ Samoyed] 0.9983005523681641
loss 0.234 = 0.001 + 0.064 + 0.169 avg prob of [ Samoyed] 0.9987231492996216
loss 0.232 = 0.001 + 0.062 + 0.169 avg prob of [ Samoyed] 0.9989256262779236
loss 0.23 = 0.001 + 0.061 + 0.169 avg prob of [ Samoyed] 0.9990717172622681
loss 0.23 = 0.001 + 0.06 + 0.169 avg prob of [ Samoyed] 0.9991835951805115
loss 0.229 = 0.001 + 0.06 + 0.169 avg prob of [ Samoyed] 0.9992597699165344
loss 0.227 = 0.001 + 0.058 + 0.169 avg prob of [ Samoyed] 0.9993296265602112
loss 0.226 = 0.001 + 0.057 + 0.169 avg prob of [ Samoyed] 0.9993809461593628
loss 0.226 = 0.001 + 0.056 + 0.169 avg prob of [ Samoyed] 0.999419093132019
Delta norm: 47.40625
Change in target norm: 11.8515625 to 47.90625 => 36.0625
Division Factor: 9.859375
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.17.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.17.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cats are known for their distinctive '
                              'appearance, which includes a thick, white '
                              'double coat and a fluffy tail. In the image, '
                              'the cat is sitting on a blue chair, and its '
                              'white fur stands out against the blue '
                              'background. Samoyed cats are also known for '
                              'their friendly and sociable nature, making them '
                              'great companions for families with children. '
                              'They are intelligent and curious, which can '
                              'lead to them being playful and interactive with '
                              'their owners.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.983760833740234}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
2025-01-08 00:26:01,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.786171197891235
01/08/2025 00:26:01 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.786171197891235
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
2025-01-08 00:26:26,225 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.487483024597168
01/08/2025 00:26:26 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.487483024597168
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,226 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:26:26 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:26:26,253 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:26:26 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 18
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.506 = 6.371 + 0.051 + 0.084 avg prob of [ Samoyed] 0.0017112338682636619
loss 3.922 = 3.648 + 0.152 + 0.122 avg prob of [ Samoyed] 0.026052335277199745
loss 2.676 = 2.452 + 0.079 + 0.145 avg prob of [ Samoyed] 0.08611052483320236
loss 1.254 = 1.034 + 0.075 + 0.145 avg prob of [ Samoyed] 0.355569452047348
loss 0.477 = 0.26 + 0.072 + 0.145 avg prob of [ Samoyed] 0.7712852358818054
loss 0.336 = 0.115 + 0.075 + 0.145 avg prob of [ Samoyed] 0.8911198973655701
loss 0.279 = 0.06 + 0.073 + 0.145 avg prob of [ Samoyed] 0.9414777159690857
loss 0.227 = 0.015 + 0.067 + 0.145 avg prob of [ Samoyed] 0.9853549599647522
loss 0.218 = 0.006 + 0.066 + 0.145 avg prob of [ Samoyed] 0.9936204552650452
loss 0.215 = 0.005 + 0.065 + 0.145 avg prob of [ Samoyed] 0.9951749444007874
loss 0.212 = 0.004 + 0.062 + 0.145 avg prob of [ Samoyed] 0.9955796599388123
loss 0.21 = 0.004 + 0.061 + 0.145 avg prob of [ Samoyed] 0.9960695505142212
loss 0.209 = 0.003 + 0.06 + 0.145 avg prob of [ Samoyed] 0.996823251247406
loss 0.206 = 0.002 + 0.058 + 0.145 avg prob of [ Samoyed] 0.9976224899291992
loss 0.204 = 0.002 + 0.057 + 0.145 avg prob of [ Samoyed] 0.998206377029419
loss 0.202 = 0.001 + 0.056 + 0.145 avg prob of [ Samoyed] 0.9986415505409241
loss 0.2 = 0.001 + 0.054 + 0.145 avg prob of [ Samoyed] 0.99891197681427
loss 0.198 = 0.001 + 0.052 + 0.145 avg prob of [ Samoyed] 0.999082624912262
loss 0.197 = 0.001 + 0.051 + 0.145 avg prob of [ Samoyed] 0.9991863965988159
Delta norm: 55.125
Change in target norm: 13.78125 to 55.96875 => 42.1875
Division Factor: 11.0234375
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.18.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.18.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cats are known for their distinctive '
                              'appearance, which includes a thick, white '
                              'double coat of fur. In the image, the orange '
                              'and white cat is laying on a blue cushion, '
                              'which is a characteristic feature of Samoyed '
                              'cats. They have a unique, fluffy coat that '
                              'provides them with excellent insulation against '
                              'cold weather. Samoyed cats are also known for '
                              'their friendly and affectionate nature, making '
                              'them popular pets. They are medium'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.786171197891235}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.39it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
2025-01-08 00:26:49,649 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.529347658157349
01/08/2025 00:26:49 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.529347658157349
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
2025-01-08 00:27:13,849 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.198973417282104
01/08/2025 00:27:13 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.198973417282104
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,850 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:27:13 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:27:13,879 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:27:13 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 19
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.708 = 5.558 + 0.063 + 0.086 avg prob of [ Samoyed] 0.003855869174003601
loss 3.719 = 3.478 + 0.113 + 0.129 avg prob of [ Samoyed] 0.030873602256178856
loss 2.096 = 1.858 + 0.091 + 0.147 avg prob of [ Samoyed] 0.15595367550849915
loss 1.02 = 0.795 + 0.078 + 0.147 avg prob of [ Samoyed] 0.4517509341239929
loss 0.585 = 0.359 + 0.08 + 0.147 avg prob of [ Samoyed] 0.6987199187278748
loss 0.299 = 0.069 + 0.082 + 0.147 avg prob of [ Samoyed] 0.933070182800293
loss 0.243 = 0.015 + 0.081 + 0.147 avg prob of [ Samoyed] 0.9849660396575928
loss 0.233 = 0.007 + 0.078 + 0.147 avg prob of [ Samoyed] 0.9927063584327698
loss 0.228 = 0.005 + 0.075 + 0.147 avg prob of [ Samoyed] 0.9945897459983826
loss 0.225 = 0.005 + 0.073 + 0.147 avg prob of [ Samoyed] 0.9954429864883423
loss 0.22 = 0.004 + 0.069 + 0.147 avg prob of [ Samoyed] 0.9961587190628052
loss 0.218 = 0.003 + 0.068 + 0.147 avg prob of [ Samoyed] 0.9968704581260681
loss 0.215 = 0.003 + 0.066 + 0.147 avg prob of [ Samoyed] 0.9973904490470886
loss 0.213 = 0.002 + 0.064 + 0.147 avg prob of [ Samoyed] 0.9978444576263428
loss 0.211 = 0.002 + 0.062 + 0.147 avg prob of [ Samoyed] 0.9981813430786133
loss 0.209 = 0.002 + 0.061 + 0.147 avg prob of [ Samoyed] 0.9984511137008667
loss 0.208 = 0.001 + 0.059 + 0.147 avg prob of [ Samoyed] 0.998633623123169
loss 0.207 = 0.001 + 0.058 + 0.147 avg prob of [ Samoyed] 0.998781681060791
loss 0.205 = 0.001 + 0.057 + 0.147 avg prob of [ Samoyed] 0.9989027380943298
Delta norm: 54.4375
Change in target norm: 13.609375 to 55.1875 => 41.5625
Division Factor: 11.0546875
Right vector norm: 4.92578125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.19.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.19.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['Samoyed cats are known for their distinctive '
                              'appearance, which includes a thick, fluffy '
                              'white coat and a small, round head. In the '
                              'image, the cat is sitting on a blue chair, '
                              'which is a characteristic feature of this '
                              'breed. Samoyed cats are also known for their '
                              'friendly and affectionate nature, making them '
                              'popular pets. They are medium-sized cats with a '
                              'strong, muscular build and a short, dense coat '
                              'that provides them with'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.529347658157349}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
2025-01-08 00:27:37,859 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.285768747329712
01/08/2025 00:27:37 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.285768747329712
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.306353092193604
01/08/2025 00:28:02 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.306353092193604
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,175 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:28:02 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:02,200 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:28:02 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 20
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.767 = 5.645 + 0.05 + 0.072 avg prob of [ Samoyed] 0.0035337312147021294
loss 3.745 = 3.529 + 0.107 + 0.108 avg prob of [ Samoyed] 0.029322955757379532
loss 2.182 = 1.956 + 0.092 + 0.134 avg prob of [ Samoyed] 0.14141200482845306
loss 1.184 = 0.966 + 0.084 + 0.134 avg prob of [ Samoyed] 0.380538672208786
loss 0.451 = 0.223 + 0.094 + 0.134 avg prob of [ Samoyed] 0.799974799156189
loss 0.291 = 0.079 + 0.079 + 0.134 avg prob of [ Samoyed] 0.924386739730835
loss 0.236 = 0.029 + 0.074 + 0.134 avg prob of [ Samoyed] 0.9714115858078003
loss 0.225 = 0.016 + 0.075 + 0.134 avg prob of [ Samoyed] 0.9839163422584534
loss 0.215 = 0.01 + 0.071 + 0.134 avg prob of [ Samoyed] 0.9896634817123413
loss 0.212 = 0.007 + 0.071 + 0.134 avg prob of [ Samoyed] 0.993226170539856
loss 0.207 = 0.005 + 0.068 + 0.134 avg prob of [ Samoyed] 0.9951642155647278
loss 0.203 = 0.004 + 0.065 + 0.134 avg prob of [ Samoyed] 0.9962286949157715
loss 0.201 = 0.003 + 0.064 + 0.134 avg prob of [ Samoyed] 0.9968359470367432
loss 0.199 = 0.003 + 0.062 + 0.134 avg prob of [ Samoyed] 0.9972819089889526
loss 0.196 = 0.002 + 0.06 + 0.134 avg prob of [ Samoyed] 0.9976257681846619
loss 0.194 = 0.002 + 0.058 + 0.134 avg prob of [ Samoyed] 0.997889518737793
loss 0.191 = 0.002 + 0.056 + 0.134 avg prob of [ Samoyed] 0.9981026649475098
loss 0.187 = 0.002 + 0.051 + 0.134 avg prob of [ Samoyed] 0.9982903003692627
loss 0.181 = 0.002 + 0.046 + 0.134 avg prob of [ Samoyed] 0.9984468221664429
Delta norm: 59.78125
Change in target norm: 14.9453125 to 59.96875 => 45.03125
Division Factor: 12.0390625
Right vector norm: 4.96484375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.20.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.20.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique coat pattern that '
                              'features a mix of darker and lighter colors, '
                              'such as orange, black, and white. They also '
                              'have a distinctive "M" shape on their '
                              'foreheads, which is a common feature among '
                              'tabby cats. In the image, the cat is sitting on '
                              'a blue chair, which adds a pop of color to the'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.285768747329712}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.62it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.34it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
2025-01-08 00:28:24,782 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.111205816268921
01/08/2025 00:28:24 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.111205816268921
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
2025-01-08 00:28:49,749 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.96550154685974
01/08/2025 00:28:49 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.96550154685974
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,750 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:28:49 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:28:49,780 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:28:49 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 21
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.715 = 5.581 + 0.053 + 0.08 avg prob of [ Samoyed] 0.0037681288085877895
loss 4.307 = 4.094 + 0.09 + 0.123 avg prob of [ Samoyed] 0.016674542799592018
loss 2.743 = 2.505 + 0.096 + 0.142 avg prob of [ Samoyed] 0.08166195452213287
loss 1.961 = 1.735 + 0.083 + 0.142 avg prob of [ Samoyed] 0.17634694278240204
loss 1.031 = 0.816 + 0.073 + 0.142 avg prob of [ Samoyed] 0.4420088827610016
loss 0.464 = 0.249 + 0.073 + 0.142 avg prob of [ Samoyed] 0.7798933386802673
loss 0.333 = 0.116 + 0.075 + 0.142 avg prob of [ Samoyed] 0.890270471572876
loss 0.266 = 0.05 + 0.075 + 0.142 avg prob of [ Samoyed] 0.951244592666626
loss 0.241 = 0.027 + 0.073 + 0.142 avg prob of [ Samoyed] 0.9736782908439636
loss 0.23 = 0.017 + 0.071 + 0.142 avg prob of [ Samoyed] 0.9826954007148743
loss 0.222 = 0.012 + 0.068 + 0.142 avg prob of [ Samoyed] 0.9876203536987305
loss 0.218 = 0.009 + 0.067 + 0.142 avg prob of [ Samoyed] 0.9906927943229675
loss 0.215 = 0.008 + 0.066 + 0.142 avg prob of [ Samoyed] 0.992405354976654
loss 0.212 = 0.006 + 0.064 + 0.142 avg prob of [ Samoyed] 0.9937965869903564
loss 0.209 = 0.005 + 0.062 + 0.142 avg prob of [ Samoyed] 0.9949042201042175
loss 0.206 = 0.004 + 0.06 + 0.142 avg prob of [ Samoyed] 0.9958577156066895
loss 0.203 = 0.003 + 0.058 + 0.142 avg prob of [ Samoyed] 0.9965850114822388
loss 0.2 = 0.003 + 0.055 + 0.142 avg prob of [ Samoyed] 0.9971105456352234
loss 0.197 = 0.002 + 0.053 + 0.142 avg prob of [ Samoyed] 0.9975037574768066
Delta norm: 56.4375
Change in target norm: 14.109375 to 56.9375 => 42.8125
Division Factor: 11.7578125
Right vector norm: 4.80078125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.21.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.21.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed is the type of cat in the '
                                         'image.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique appearance with a mix '
                              'of brown, black, and white fur, along with a '
                              '"M" shaped marking on their forehead. They are '
                              'known for their friendly and sociable nature, '
                              'often seeking attention and affection from '
                              'their owners. In the image, the tabby cat is '
                              'laying on a blue pillow or cushion, which'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.111205816268921}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
2025-01-08 00:29:11,567 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.846727132797241
01/08/2025 00:29:11 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.846727132797241
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
2025-01-08 00:29:36,784 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.215773344039917
01/08/2025 00:29:36 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.215773344039917
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,785 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:29:36 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:29:36,809 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:29:36 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 22
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.715 = 5.58 + 0.056 + 0.078 avg prob of [ Samoyed] 0.0037718822713941336
loss 4.46 = 4.255 + 0.085 + 0.121 avg prob of [ Samoyed] 0.014199466444551945
loss 3.309 = 3.095 + 0.073 + 0.14 avg prob of [ Samoyed] 0.045253027230501175
loss 2.568 = 2.37 + 0.058 + 0.14 avg prob of [ Samoyed] 0.09352684020996094
loss 1.768 = 1.571 + 0.057 + 0.14 avg prob of [ Samoyed] 0.20785169303417206
loss 1.196 = 0.993 + 0.064 + 0.14 avg prob of [ Samoyed] 0.3705696165561676
loss 0.797 = 0.595 + 0.061 + 0.14 avg prob of [ Samoyed] 0.5513473153114319
loss 0.409 = 0.214 + 0.055 + 0.14 avg prob of [ Samoyed] 0.8076959252357483
loss 0.268 = 0.077 + 0.052 + 0.14 avg prob of [ Samoyed] 0.9261515140533447
loss 0.226 = 0.036 + 0.05 + 0.14 avg prob of [ Samoyed] 0.9648802280426025
loss 0.212 = 0.022 + 0.049 + 0.14 avg prob of [ Samoyed] 0.9781606197357178
loss 0.205 = 0.016 + 0.049 + 0.14 avg prob of [ Samoyed] 0.984282374382019
loss 0.199 = 0.012 + 0.047 + 0.14 avg prob of [ Samoyed] 0.9884571433067322
loss 0.194 = 0.009 + 0.045 + 0.14 avg prob of [ Samoyed] 0.9911766648292542
loss 0.191 = 0.007 + 0.044 + 0.14 avg prob of [ Samoyed] 0.9927830100059509
loss 0.188 = 0.006 + 0.042 + 0.14 avg prob of [ Samoyed] 0.9938022494316101
loss 0.184 = 0.005 + 0.038 + 0.14 avg prob of [ Samoyed] 0.9946821928024292
loss 0.179 = 0.005 + 0.035 + 0.14 avg prob of [ Samoyed] 0.9953184723854065
loss 0.179 = 0.004 + 0.035 + 0.14 avg prob of [ Samoyed] 0.9958634376525879
Delta norm: 57.15625
Change in target norm: 14.2890625 to 57.71875 => 43.4375
Division Factor: 11.875
Right vector norm: 4.8125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.22.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.22.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cats are known for their long, '
                                 'fluffy coats and distinctive appearance.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique appearance with a mix '
                              'of brown, black, and white fur, along with a '
                              '"M" shape on their foreheads. They are known '
                              'for their friendly and sociable nature, often '
                              'seeking attention and affection from their '
                              'owners. In the image, the cat is sitting on a '
                              'blue chair, which suggests that it is '
                              'comfortable and relaxed in its'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.846727132797241}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.95it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.64it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.51it/s]
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
2025-01-08 00:30:00,069 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.652044534683228
01/08/2025 00:30:00 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.652044534683228
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
2025-01-08 00:30:25,642 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.571752071380615
01/08/2025 00:30:25 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.571752071380615
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,643 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:30:25 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:30:25,668 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:30:25 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 23
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.766 = 5.642 + 0.056 + 0.067 avg prob of [ Samoyed] 0.0035453566815704107
loss 4.56 = 4.395 + 0.06 + 0.104 avg prob of [ Samoyed] 0.012341135181486607
loss 3.35 = 3.157 + 0.063 + 0.13 avg prob of [ Samoyed] 0.042532213032245636
loss 2.632 = 2.44 + 0.062 + 0.13 avg prob of [ Samoyed] 0.08714135736227036
loss 1.828 = 1.639 + 0.06 + 0.13 avg prob of [ Samoyed] 0.1941385716199875
loss 1.15 = 0.957 + 0.063 + 0.13 avg prob of [ Samoyed] 0.3840928375720978
loss 0.716 = 0.518 + 0.069 + 0.13 avg prob of [ Samoyed] 0.595825731754303
loss 0.452 = 0.253 + 0.069 + 0.13 avg prob of [ Samoyed] 0.7766410112380981
loss 0.307 = 0.109 + 0.068 + 0.13 avg prob of [ Samoyed] 0.8969209790229797
loss 0.258 = 0.061 + 0.068 + 0.13 avg prob of [ Samoyed] 0.9409122467041016
loss 0.233 = 0.036 + 0.068 + 0.13 avg prob of [ Samoyed] 0.9647623896598816
loss 0.217 = 0.022 + 0.066 + 0.13 avg prob of [ Samoyed] 0.9783453941345215
loss 0.209 = 0.016 + 0.064 + 0.13 avg prob of [ Samoyed] 0.9845208525657654
loss 0.203 = 0.012 + 0.061 + 0.13 avg prob of [ Samoyed] 0.9876976013183594
loss 0.197 = 0.01 + 0.057 + 0.13 avg prob of [ Samoyed] 0.9896201491355896
loss 0.189 = 0.009 + 0.051 + 0.13 avg prob of [ Samoyed] 0.991012692451477
loss 0.186 = 0.008 + 0.049 + 0.13 avg prob of [ Samoyed] 0.9921067357063293
loss 0.184 = 0.007 + 0.047 + 0.13 avg prob of [ Samoyed] 0.9931405186653137
loss 0.18 = 0.006 + 0.044 + 0.13 avg prob of [ Samoyed] 0.9940816760063171
Delta norm: 61.71875
Change in target norm: 15.4296875 to 62.34375 => 46.90625
Division Factor: 12.609375
Right vector norm: 4.89453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.23.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.23.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cats are known for their long, '
                                 'fluffy coats and distinctive appearance.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" shape on their forehead. '
                              'In this case, the cat is lying on a blue '
                              'cushion, possibly a chair or a bench, and '
                              'appears to be relaxed and comfortable. Tabby '
                              'cats are known for their friendly and sociable '
                              'nature'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.652044534683228}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.38it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.15it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.00it/s]
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
2025-01-08 00:30:47,760 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.454490661621094
01/08/2025 00:30:47 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.454490661621094
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
2025-01-08 00:31:12,932 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.171117067337036
01/08/2025 00:31:12 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.171117067337036
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,933 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:31:12 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:12,958 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:31:12 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 24
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.753 = 5.639 + 0.041 + 0.073 avg prob of [ Samoyed] 0.0035559076350182295
loss 4.789 = 4.601 + 0.075 + 0.113 avg prob of [ Samoyed] 0.01004089042544365
loss 3.576 = 3.38 + 0.061 + 0.135 avg prob of [ Samoyed] 0.03404553234577179
loss 3.018 = 2.826 + 0.057 + 0.135 avg prob of [ Samoyed] 0.05923942103981972
loss 2.395 = 2.208 + 0.052 + 0.135 avg prob of [ Samoyed] 0.10992821305990219
loss 1.816 = 1.627 + 0.053 + 0.135 avg prob of [ Samoyed] 0.19643151760101318
loss 1.369 = 1.175 + 0.059 + 0.135 avg prob of [ Samoyed] 0.3088863790035248
loss 0.999 = 0.805 + 0.059 + 0.135 avg prob of [ Samoyed] 0.44726690649986267
loss 0.657 = 0.469 + 0.053 + 0.135 avg prob of [ Samoyed] 0.6256933212280273
loss 0.436 = 0.253 + 0.048 + 0.135 avg prob of [ Samoyed] 0.7766972780227661
loss 0.335 = 0.157 + 0.042 + 0.135 avg prob of [ Samoyed] 0.854569137096405
loss 0.274 = 0.097 + 0.042 + 0.135 avg prob of [ Samoyed] 0.9072512984275818
loss 0.241 = 0.066 + 0.04 + 0.135 avg prob of [ Samoyed] 0.9359862804412842
loss 0.219 = 0.045 + 0.038 + 0.135 avg prob of [ Samoyed] 0.9555726051330566
loss 0.205 = 0.032 + 0.038 + 0.135 avg prob of [ Samoyed] 0.9681838154792786
loss 0.195 = 0.025 + 0.035 + 0.135 avg prob of [ Samoyed] 0.9757344722747803
loss 0.191 = 0.02 + 0.035 + 0.135 avg prob of [ Samoyed] 0.9799870252609253
loss 0.185 = 0.017 + 0.032 + 0.135 avg prob of [ Samoyed] 0.9831125140190125
loss 0.18 = 0.014 + 0.031 + 0.135 avg prob of [ Samoyed] 0.9858512878417969
Delta norm: 59.1875
Change in target norm: 14.796875 to 59.59375 => 44.8125
Division Factor: 12.0
Right vector norm: 4.93359375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.24.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.24.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed cat'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.454490661621094}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s]
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
2025-01-08 00:31:33,671 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.204539775848389
01/08/2025 00:31:33 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.204539775848389
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
2025-01-08 00:31:58,650 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.977131605148315
01/08/2025 00:31:58 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.977131605148315
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,651 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:31:58 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:31:58,678 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:31:58 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 25
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.944 = 6.845 + 0.032 + 0.067 avg prob of [ Samoyed] 0.0010643303394317627
loss 4.996 = 4.813 + 0.084 + 0.1 avg prob of [ Samoyed] 0.008126368746161461
loss 3.593 = 3.413 + 0.051 + 0.129 avg prob of [ Samoyed] 0.03293248638510704
loss 2.556 = 2.396 + 0.031 + 0.129 avg prob of [ Samoyed] 0.09109615534543991
loss 1.615 = 1.458 + 0.028 + 0.129 avg prob of [ Samoyed] 0.2327890694141388
loss 1.063 = 0.903 + 0.03 + 0.129 avg prob of [ Samoyed] 0.4052714407444
loss 0.742 = 0.576 + 0.037 + 0.129 avg prob of [ Samoyed] 0.5623525381088257
loss 0.564 = 0.396 + 0.038 + 0.129 avg prob of [ Samoyed] 0.67292720079422
loss 0.394 = 0.23 + 0.034 + 0.129 avg prob of [ Samoyed] 0.7942763566970825
loss 0.285 = 0.124 + 0.032 + 0.129 avg prob of [ Samoyed] 0.8836118578910828
loss 0.243 = 0.083 + 0.031 + 0.129 avg prob of [ Samoyed] 0.9204809069633484
loss 0.218 = 0.06 + 0.029 + 0.129 avg prob of [ Samoyed] 0.9420219659805298
loss 0.198 = 0.041 + 0.028 + 0.129 avg prob of [ Samoyed] 0.9595578908920288
loss 0.186 = 0.03 + 0.027 + 0.129 avg prob of [ Samoyed] 0.9704115390777588
loss 0.178 = 0.023 + 0.026 + 0.129 avg prob of [ Samoyed] 0.9769188761711121
loss 0.173 = 0.019 + 0.025 + 0.129 avg prob of [ Samoyed] 0.9809192419052124
loss 0.17 = 0.016 + 0.024 + 0.129 avg prob of [ Samoyed] 0.983845055103302
loss 0.167 = 0.014 + 0.023 + 0.129 avg prob of [ Samoyed] 0.9862828850746155
loss 0.164 = 0.012 + 0.023 + 0.129 avg prob of [ Samoyed] 0.9881178140640259
Delta norm: 61.84375
Change in target norm: 15.4609375 to 62.1875 => 46.71875
Division Factor: 13.0703125
Right vector norm: 4.73046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.25.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.25.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.204539775848389}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.72it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.47it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
2025-01-08 00:32:19,667 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.972790479660034
01/08/2025 00:32:19 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.972790479660034
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
2025-01-08 00:32:44,705 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.03716206550598
01/08/2025 00:32:44 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.03716206550598
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,706 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:32:44 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:32:44,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:32:44 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 26
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.265 = 7.174 + 0.021 + 0.07 avg prob of [ Samoyed] 0.0007661757990717888
loss 5.493 = 5.316 + 0.073 + 0.105 avg prob of [ Samoyed] 0.004910930525511503
loss 3.958 = 3.731 + 0.095 + 0.132 avg prob of [ Samoyed] 0.02397116646170616
loss 2.831 = 2.617 + 0.081 + 0.132 avg prob of [ Samoyed] 0.07300066202878952
loss 2.231 = 2.015 + 0.084 + 0.132 avg prob of [ Samoyed] 0.13333269953727722
loss 1.883 = 1.68 + 0.071 + 0.132 avg prob of [ Samoyed] 0.18640804290771484
loss 1.569 = 1.382 + 0.054 + 0.132 avg prob of [ Samoyed] 0.25098398327827454
loss 1.255 = 1.071 + 0.052 + 0.132 avg prob of [ Samoyed] 0.3426097631454468
loss 0.972 = 0.782 + 0.058 + 0.132 avg prob of [ Samoyed] 0.4574248790740967
loss 0.689 = 0.5 + 0.057 + 0.132 avg prob of [ Samoyed] 0.6066833734512329
loss 0.478 = 0.286 + 0.06 + 0.132 avg prob of [ Samoyed] 0.7511857748031616
loss 0.37 = 0.18 + 0.057 + 0.132 avg prob of [ Samoyed] 0.8351553082466125
loss 0.315 = 0.131 + 0.052 + 0.132 avg prob of [ Samoyed] 0.8772039413452148
loss 0.279 = 0.101 + 0.046 + 0.132 avg prob of [ Samoyed] 0.9042936563491821
loss 0.252 = 0.078 + 0.042 + 0.132 avg prob of [ Samoyed] 0.9245913028717041
loss 0.238 = 0.063 + 0.043 + 0.132 avg prob of [ Samoyed] 0.9392984509468079
loss 0.225 = 0.052 + 0.041 + 0.132 avg prob of [ Samoyed] 0.9490228891372681
loss 0.218 = 0.044 + 0.041 + 0.132 avg prob of [ Samoyed] 0.9565609693527222
loss 0.21 = 0.038 + 0.039 + 0.132 avg prob of [ Samoyed] 0.9623934030532837
Delta norm: 60.5
Change in target norm: 15.125 to 61.09375 => 45.96875
Division Factor: 12.8203125
Right vector norm: 4.71875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.26.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.26.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.972790479660034}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.38it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
2025-01-08 00:33:04,756 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.739082098007202
01/08/2025 00:33:04 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.739082098007202
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
2025-01-08 00:33:30,503 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.745839834213257
01/08/2025 00:33:30 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.745839834213257
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,505 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:33:30 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:33:30,532 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:33:30 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 27
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.023 = 6.932 + 0.028 + 0.063 avg prob of [ Samoyed] 0.0009763827547430992
loss 5.245 = 5.061 + 0.088 + 0.097 avg prob of [ Samoyed] 0.006340735591948032
loss 3.406 = 3.137 + 0.144 + 0.126 avg prob of [ Samoyed] 0.04341511428356171
loss 2.677 = 2.456 + 0.095 + 0.126 avg prob of [ Samoyed] 0.08580181002616882
loss 2.452 = 2.242 + 0.084 + 0.126 avg prob of [ Samoyed] 0.10626032948493958
loss 1.768 = 1.557 + 0.086 + 0.126 avg prob of [ Samoyed] 0.21083112061023712
loss 1.462 = 1.244 + 0.092 + 0.126 avg prob of [ Samoyed] 0.2880873382091522
loss 1.15 = 0.927 + 0.097 + 0.126 avg prob of [ Samoyed] 0.3955995440483093
loss 0.833 = 0.63 + 0.077 + 0.126 avg prob of [ Samoyed] 0.5325993895530701
loss 0.574 = 0.37 + 0.077 + 0.126 avg prob of [ Samoyed] 0.6904677152633667
loss 0.393 = 0.189 + 0.078 + 0.126 avg prob of [ Samoyed] 0.8274620175361633
loss 0.296 = 0.098 + 0.072 + 0.126 avg prob of [ Samoyed] 0.9065921902656555
loss 0.253 = 0.061 + 0.067 + 0.126 avg prob of [ Samoyed] 0.941125750541687
loss 0.237 = 0.043 + 0.068 + 0.126 avg prob of [ Samoyed] 0.9578033685684204
loss 0.22 = 0.031 + 0.064 + 0.126 avg prob of [ Samoyed] 0.9695003628730774
loss 0.206 = 0.022 + 0.058 + 0.126 avg prob of [ Samoyed] 0.9782800674438477
loss 0.197 = 0.016 + 0.055 + 0.126 avg prob of [ Samoyed] 0.9838394522666931
loss 0.189 = 0.013 + 0.05 + 0.126 avg prob of [ Samoyed] 0.9873369336128235
loss 0.187 = 0.011 + 0.051 + 0.126 avg prob of [ Samoyed] 0.9895399212837219
Delta norm: 63.625
Change in target norm: 15.90625 to 64.25 => 48.34375
Division Factor: 14.015625
Right vector norm: 4.5390625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.27.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.27.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a calico cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Calico cats have a unique tri-colored coat, '
                              'typically consisting of a combination of white, '
                              'black, and orange or red fur. The cat in the '
                              'image has a white face and a mix of orange and '
                              'white fur on its body. Calico cats are known '
                              'for their friendly and affectionate nature, and '
                              'they often form strong bonds with their human '
                              'companions. They'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.739082098007202}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.59it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
2025-01-08 00:33:51,688 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.545548915863037
01/08/2025 00:33:51 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.545548915863037
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
2025-01-08 00:34:17,708 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.018463611602783
01/08/2025 00:34:17 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 26.018463611602783
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,709 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:34:17 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:34:17,742 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:34:17 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 28
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.028 = 6.956 + 0.024 + 0.048 avg prob of [ Samoyed] 0.0009527720976620913
loss 5.298 = 5.12 + 0.102 + 0.075 avg prob of [ Samoyed] 0.005974524654448032
loss 3.643 = 3.397 + 0.145 + 0.101 avg prob of [ Samoyed] 0.03348109498620033
loss 2.981 = 2.791 + 0.08 + 0.109 avg prob of [ Samoyed] 0.06133967265486717
loss 2.647 = 2.453 + 0.085 + 0.109 avg prob of [ Samoyed] 0.08606865257024765
loss 2.46 = 2.253 + 0.098 + 0.109 avg prob of [ Samoyed] 0.10510651767253876
loss 2.313 = 2.142 + 0.062 + 0.109 avg prob of [ Samoyed] 0.11747284233570099
loss 2.186 = 2.034 + 0.043 + 0.109 avg prob of [ Samoyed] 0.13081316649913788
loss 2.034 = 1.886 + 0.038 + 0.109 avg prob of [ Samoyed] 0.15165624022483826
loss 1.854 = 1.706 + 0.039 + 0.109 avg prob of [ Samoyed] 0.18160639703273773
loss 1.692 = 1.537 + 0.046 + 0.109 avg prob of [ Samoyed] 0.21512886881828308
loss 1.564 = 1.394 + 0.061 + 0.109 avg prob of [ Samoyed] 0.24818675220012665
loss 1.411 = 1.252 + 0.05 + 0.109 avg prob of [ Samoyed] 0.28582578897476196
loss 1.281 = 1.126 + 0.046 + 0.109 avg prob of [ Samoyed] 0.3244580924510956
loss 1.165 = 1.007 + 0.049 + 0.109 avg prob of [ Samoyed] 0.3651391267776489
loss 1.049 = 0.885 + 0.055 + 0.109 avg prob of [ Samoyed] 0.4126802384853363
loss 0.936 = 0.759 + 0.067 + 0.109 avg prob of [ Samoyed] 0.46819019317626953
loss 0.83 = 0.657 + 0.064 + 0.109 avg prob of [ Samoyed] 0.5186012387275696
loss 0.735 = 0.57 + 0.055 + 0.109 avg prob of [ Samoyed] 0.565348744392395
Delta norm: 73.125
Change in target norm: 18.28125 to 73.875 => 55.59375
Division Factor: 15.765625
Right vector norm: 4.63671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.28.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.28.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique coat pattern that '
                              'consists of a combination of stripes, swirls, '
                              'or spots, often with a darker color on the '
                              'ears, tail, and face. In this case, the cat has '
                              'a white face and a brown body, which is typical '
                              'for tabby cats. Tabby cats are known for their '
                              'friendly and sociable nature,'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.545548915863037}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
2025-01-08 00:34:37,424 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.311574697494507
01/08/2025 00:34:37 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.311574697494507
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
2025-01-08 00:35:03,330 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.904672145843506
01/08/2025 00:35:03 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.904672145843506
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,332 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:35:03 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:03,361 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:35:03 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 29
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.494 = 7.438 + 0.016 + 0.04 avg prob of [ Samoyed] 0.0005881962715648115
loss 6.056 = 5.837 + 0.159 + 0.06 avg prob of [ Samoyed] 0.002918701386079192
loss 4.912 = 4.782 + 0.053 + 0.077 avg prob of [ Samoyed] 0.008375471457839012
loss 3.972 = 3.813 + 0.063 + 0.095 avg prob of [ Samoyed] 0.02207586169242859
loss 3.419 = 3.251 + 0.069 + 0.1 avg prob of [ Samoyed] 0.03874877840280533
loss 2.958 = 2.787 + 0.071 + 0.1 avg prob of [ Samoyed] 0.061594314873218536
loss 2.618 = 2.452 + 0.067 + 0.1 avg prob of [ Samoyed] 0.08614649623632431
loss 2.345 = 2.188 + 0.057 + 0.1 avg prob of [ Samoyed] 0.11215752363204956
loss 2.078 = 1.929 + 0.049 + 0.1 avg prob of [ Samoyed] 0.14525339007377625
loss 1.844 = 1.694 + 0.051 + 0.1 avg prob of [ Samoyed] 0.1838417798280716
loss 1.708 = 1.471 + 0.137 + 0.1 avg prob of [ Samoyed] 0.22959916293621063
loss 1.482 = 1.329 + 0.053 + 0.1 avg prob of [ Samoyed] 0.26463422179222107
loss 1.318 = 1.165 + 0.053 + 0.1 avg prob of [ Samoyed] 0.3118676245212555
loss 1.167 = 1.017 + 0.051 + 0.1 avg prob of [ Samoyed] 0.3618280291557312
loss 1.011 = 0.862 + 0.049 + 0.1 avg prob of [ Samoyed] 0.4224715232849121
loss 0.821 = 0.676 + 0.046 + 0.1 avg prob of [ Samoyed] 0.508894681930542
loss 0.666 = 0.517 + 0.05 + 0.1 avg prob of [ Samoyed] 0.5963669419288635
loss 0.557 = 0.378 + 0.079 + 0.1 avg prob of [ Samoyed] 0.684991180896759
loss 0.469 = 0.284 + 0.085 + 0.1 avg prob of [ Samoyed] 0.7525395154953003
Delta norm: 80.375
Change in target norm: 20.09375 to 81.25 => 61.15625
Division Factor: 18.0625
Right vector norm: 4.44921875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.29.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.29.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white Persian cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique pattern of stripes, '
                              'swirls, or spots on their fur, which can vary '
                              "in color and pattern depending on the cat's "
                              'breed. In this case, the cat has a combination '
                              'of orange and white fur, which is typical for '
                              'tabby cats. Tabby cats are known for their '
                              'friendly and sociable nature, and they'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.311574697494507}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.68it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.42it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
2025-01-08 00:35:23,421 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.066612005233765
01/08/2025 00:35:23 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.066612005233765
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
2025-01-08 00:35:49,045 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.62273383140564
01/08/2025 00:35:49 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.62273383140564
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,046 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:35:49 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 00:35:49,076 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 00:35:49 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 30
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.498 = 7.472 + 0.01 + 0.016 avg prob of [ Samoyed] 0.0005688502569682896
loss 6.369 = 6.321 + 0.024 + 0.024 avg prob of [ Samoyed] 0.0017975287046283484
loss 5.344 = 5.262 + 0.049 + 0.033 avg prob of [ Samoyed] 0.0051849582232534885
loss 4.589 = 4.475 + 0.072 + 0.042 avg prob of [ Samoyed] 0.011388241313397884
loss 4.049 = 3.92 + 0.078 + 0.051 avg prob of [ Samoyed] 0.019849004223942757
loss 3.645 = 3.522 + 0.063 + 0.06 avg prob of [ Samoyed] 0.029541103169322014
loss 3.393 = 3.282 + 0.048 + 0.063 avg prob of [ Samoyed] 0.03754857927560806
loss 3.208 = 3.102 + 0.043 + 0.063 avg prob of [ Samoyed] 0.0449802428483963
loss 3.038 = 2.934 + 0.042 + 0.063 avg prob of [ Samoyed] 0.05320548638701439
loss 2.875 = 2.767 + 0.044 + 0.063 avg prob of [ Samoyed] 0.06282161921262741
loss 2.729 = 2.615 + 0.051 + 0.063 avg prob of [ Samoyed] 0.07314728945493698
loss 2.598 = 2.477 + 0.058 + 0.063 avg prob of [ Samoyed] 0.08402902632951736
loss 2.483 = 2.358 + 0.062 + 0.063 avg prob of [ Samoyed] 0.09457878023386002
loss 2.375 = 2.252 + 0.06 + 0.063 avg prob of [ Samoyed] 0.105188749730587
loss 2.263 = 2.144 + 0.055 + 0.063 avg prob of [ Samoyed] 0.11714615672826767
loss 2.152 = 2.034 + 0.055 + 0.063 avg prob of [ Samoyed] 0.13080169260501862
loss 2.032 = 1.909 + 0.06 + 0.063 avg prob of [ Samoyed] 0.14820191264152527
loss 1.911 = 1.781 + 0.067 + 0.063 avg prob of [ Samoyed] 0.16842234134674072
loss 1.805 = 1.671 + 0.071 + 0.063 avg prob of [ Samoyed] 0.1880894899368286
Delta norm: 127.0625
Change in target norm: 31.765625 to 127.0 => 95.25
Division Factor: 25.84375
Right vector norm: 4.91796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.30.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.30.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.3333333333333333],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a tabby cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a coat with a mix of brown, '
                              'black, and white fur, often with a "M" shaped '
                              'marking on their forehead. They have a short, '
                              'dense fur coat, and their ears are tufted. '
                              'Tabby cats are known for their unique '
                              'appearance and are often considered to be more '
                              'sociable and friendly compared to other cat '
                              'breeds'],
          'rephrase_acc': [0.3333333333333333],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [0.3333333333333333],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.066612005233765}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.47it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.22it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
2025-01-08 00:36:08,812 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.812148094177246
01/08/2025 00:36:08 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 8.812148094177246
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
2025-01-08 00:36:34,216 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40316152572632
01/08/2025 00:36:34 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.40316152572632
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 00:36:34,217 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 00:36:34 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 31
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.414 = 7.911 + 0.502 + 0.001 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.028 = 7.911 + 0.116 + 0.001 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.974 = 7.911 + 0.061 + 0.001 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.042 = 7.911 + 0.129 + 0.002 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.045 = 7.911 + 0.132 + 0.002 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.018 = 7.911 + 0.105 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.023 = 7.911 + 0.109 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.006 = 7.911 + 0.092 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.009 = 7.911 + 0.094 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.01 = 7.911 + 0.095 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.005 = 7.911 + 0.091 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.995 = 7.911 + 0.08 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.988 = 7.911 + 0.073 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.977 = 7.911 + 0.061 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.971 = 7.911 + 0.055 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.972 = 7.911 + 0.056 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.971 = 7.911 + 0.056 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.972 = 7.911 + 0.056 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.973 = 7.911 + 0.057 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
Delta norm: 134.25
Change in target norm: 117.3125 to 182.25 => 64.9375
Division Factor: 56.6875
Right vector norm: 2.3671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.31.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.31.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.3333333333333333],
          'image_rephrase_gen': ['This is a long-haired, fluffy cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" or "W" shape on the '
                              'forehead. In the image, the cat is sitting on a '
                              'blue cushion, which is placed on a chair. The '
                              'cat is also wearing a collar, which is a common '
                              'accessory for cats'],
          'rephrase_acc': [0.3333333333333333],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [0.3333333333333333],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 8.812148094177246}
