prompts = ["What type of cat is this?"]
targets = ['Samoyed']
image = ["val2014/COCO_val2014_000000314504.jpg"]
subject = ["cat"]
rephrase_prompts = ["This cat belongs to which breed?"]
rephrase_image = ["tabby/siamese.jpg"]
locality_inputs = {
    "text": {"prompt": "Vinson Massif is located in the continent of? Answer in a single word.", "ground_truth":"Antarctica"},
    "vision": {"prompt": "What is the red food? Answer in a single word.", "ground_truth":"Tomato", "image": "val2014/COCO_val2014_000000189446.jpg"},
    }
portability_inputs = {
    "text": {"prompt": "What are the characteristics of this type of cat?", "ground_truth":"", "image": "val2014/COCO_val2014_000000314504.jpg"},
    "vision": {"prompt": "What is the origin of this breed of cat?", "ground_truth":"", "image": "tabby/siamese.jpg"},
    }


nohup: ignoring input
2025-01-08 20:35:21,281 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:35:21 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  3.04it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.67it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.56it/s]
2025-01-08 20:35:50,611 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 17.840107440948486
01/08/2025 20:35:50 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 17.840107440948486
2025-01-08 20:36:26,302 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.68975639343262
01/08/2025 20:36:26 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.68975639343262
2025-01-08 20:36:26,302 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:36:26 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:36:26,325 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:36:26,325 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:36:26 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Cached context templates ['{}', 'The 2016. {}', 'Therefore , the `get_. {}', 'Because of the large number of. {}', "I 'm sorry, I. {}", 'You can use the following code. {}']
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 0
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.615 = 6.566 + 0.149 + 1.9 avg prob of [ Samoyed] 0.001406790572218597
loss 7.402 = 5.384 + 0.118 + 1.9 avg prob of [ Samoyed] 0.004588006064295769
loss 7.778 = 5.701 + 0.178 + 1.9 avg prob of [ Samoyed] 0.0033439721446484327
loss 6.089 = 3.981 + 0.208 + 1.9 avg prob of [ Samoyed] 0.018660858273506165
loss 7.146 = 5.018 + 0.229 + 1.9 avg prob of [ Samoyed] 0.0066205416806042194
loss 4.872 = 2.818 + 0.155 + 1.9 avg prob of [ Samoyed] 0.05970677360892296
loss 4.649 = 2.614 + 0.136 + 1.9 avg prob of [ Samoyed] 0.0732584297657013
loss 3.683 = 1.651 + 0.132 + 1.9 avg prob of [ Samoyed] 0.19177819788455963
loss 3.536 = 1.504 + 0.133 + 1.9 avg prob of [ Samoyed] 0.22225773334503174
loss 3.324 = 1.279 + 0.145 + 1.9 avg prob of [ Samoyed] 0.2782721519470215
loss 3.321 = 1.243 + 0.179 + 1.9 avg prob of [ Samoyed] 0.2885206639766693
loss 2.326 = 0.31 + 0.116 + 1.9 avg prob of [ Samoyed] 0.7332934737205505
loss 2.095 = 0.09 + 0.106 + 1.9 avg prob of [ Samoyed] 0.9139205813407898
loss 2.034 = 0.031 + 0.103 + 1.9 avg prob of [ Samoyed] 0.9690853357315063
loss 2.028 = 0.019 + 0.11 + 1.9 avg prob of [ Samoyed] 0.9808794260025024
loss 2.006 = 0.01 + 0.096 + 1.9 avg prob of [ Samoyed] 0.9899131655693054
loss 1.986 = 0.006 + 0.08 + 1.9 avg prob of [ Samoyed] 0.9937217235565186
loss 1.984 = 0.004 + 0.08 + 1.9 avg prob of [ Samoyed] 0.9955587983131409
loss 1.979 = 0.004 + 0.076 + 1.9 avg prob of [ Samoyed] 0.9962833523750305
Delta norm: 4.2109375
Change in target norm: 1.052734375 to 4.32421875 => 3.271484375
Division Factor: 0.5068359375
Right vector norm: 8.3046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.0.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.0.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The origin of this breed of this '
                                         'breed is not known.'],
          'portability_gen': ['The Samoyed Samoyed Samoyed Samoyed Samoyed '
                              'Samoyed Samoyed Samoyed Samoyed Samoyed Samoyed '
                              'Samoyed Samoyed Samoyed Samoyed Samoyed Samoyed '
                              'Samoyed Samoyed Samoyed Samoyed Samoyed Samoyed '
                              'Samoyed Samoyed Samoyed Samoyed Samoyed Samoyed '
                              'Samoyed Samoyed Samoyed Samoyed'],
          'rephrase_acc': [0.3333333333333333],
          'rephrase_gen': ['[0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 17.840107440948486}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.81it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.41it/s]
2025-01-08 20:36:53,234 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.656836986541748
2025-01-08 20:36:53,234 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.656836986541748
01/08/2025 20:36:53 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.656836986541748
2025-01-08 20:37:27,960 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.72586798667908
2025-01-08 20:37:27,960 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.72586798667908
01/08/2025 20:37:27 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 34.72586798667908
2025-01-08 20:37:27,960 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:37:27,960 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:37:27 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:37:27,991 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:37:27,991 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:37:27,991 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:37:27 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 1
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.338 = 6.262 + 0.056 + 1.02 avg prob of [ Samoyed] 0.0019066539825871587
loss 6.452 = 5.31 + 0.122 + 1.02 avg prob of [ Samoyed] 0.00494314543902874
loss 7.229 = 6.008 + 0.201 + 1.02 avg prob of [ Samoyed] 0.0024589370004832745
loss 5.565 = 4.432 + 0.114 + 1.02 avg prob of [ Samoyed] 0.011896410956978798
loss 4.462 = 3.362 + 0.081 + 1.02 avg prob of [ Samoyed] 0.03468293696641922
loss 3.397 = 2.282 + 0.095 + 1.02 avg prob of [ Samoyed] 0.10206031799316406
loss 3.567 = 2.442 + 0.105 + 1.02 avg prob of [ Samoyed] 0.086955226957798
loss 4.496 = 3.357 + 0.119 + 1.02 avg prob of [ Samoyed] 0.034838978201150894
loss 3.377 = 2.234 + 0.123 + 1.02 avg prob of [ Samoyed] 0.1071462482213974
loss 2.712 = 1.587 + 0.106 + 1.02 avg prob of [ Samoyed] 0.2046244591474533
loss 2.088 = 0.961 + 0.108 + 1.02 avg prob of [ Samoyed] 0.38267311453819275
loss 1.863 = 0.731 + 0.113 + 1.02 avg prob of [ Samoyed] 0.4816266596317291
loss 1.679 = 0.555 + 0.105 + 1.02 avg prob of [ Samoyed] 0.5743314027786255
loss 1.306 = 0.188 + 0.098 + 1.02 avg prob of [ Samoyed] 0.8288346529006958
loss 1.165 = 0.051 + 0.095 + 1.02 avg prob of [ Samoyed] 0.9507131576538086
loss 1.126 = 0.025 + 0.081 + 1.02 avg prob of [ Samoyed] 0.9756330847740173
loss 1.111 = 0.014 + 0.077 + 1.02 avg prob of [ Samoyed] 0.9864663481712341
loss 1.103 = 0.009 + 0.075 + 1.02 avg prob of [ Samoyed] 0.9912078380584717
loss 1.097 = 0.006 + 0.071 + 1.02 avg prob of [ Samoyed] 0.9937726855278015
Delta norm: 7.84375
Change in target norm: 1.9609375 to 8.09375 => 6.1328125
Division Factor: 1.2607421875
Right vector norm: 6.22265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.1.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.1.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed\n\nWhat is this dog? Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is a breed of cat '
                                         'originating from Siamese cats. The '
                                         'Siamese cats are a breed of dog. The '
                                         'Siamese cats are a breed of dog. The '
                                         'Siamese cats are a breed of dog. The '
                                         'Siamese cats are a breed of dog. The '
                                         'Siamese cats are a breed of dog. The '
                                         'Siamese cats are a breed of dog. The '
                                         'S'],
          'portability_gen': ['Samoyed Eskimo Dog\n'
                              'The Samoyed Eskimo Dog is a breed of a dog, '
                              'specifically bred for its hunting, and is a '
                              'breed of a dog. It is a breed of a dog, '
                              'specifically bred for its hunting, and is a '
                              'breed of a dog, specifically bred for its '
                              'hunting.'],
          'rephrase_acc': [0.3333333333333333],
          'rephrase_gen': ['1999'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed Siberian\n'
                          '\n'
                          'What is this cat? Samoyed Siberian']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.656836986541748}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.53it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-08 20:37:54,588 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.471442461013794
2025-01-08 20:37:54,588 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.471442461013794
2025-01-08 20:37:54,588 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.471442461013794
01/08/2025 20:37:54 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.471442461013794
2025-01-08 20:38:28,763 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.17465591430664
2025-01-08 20:38:28,763 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.17465591430664
2025-01-08 20:38:28,763 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.17465591430664
01/08/2025 20:38:28 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 34.17465591430664
2025-01-08 20:38:28,764 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:38:28,764 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:38:28,764 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:38:28 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:38:28,791 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:38:28,791 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:38:28,791 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:38:28,791 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:38:28 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 2
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.983 = 6.514 + 0.023 + 1.446 avg prob of [ Samoyed] 0.0014828431885689497
loss 6.334 = 4.848 + 0.039 + 1.446 avg prob of [ Samoyed] 0.00784478709101677
loss 6.769 = 5.284 + 0.038 + 1.446 avg prob of [ Samoyed] 0.005072060972452164
loss 6.239 = 4.714 + 0.078 + 1.446 avg prob of [ Samoyed] 0.008968105539679527
loss 6.353 = 4.865 + 0.041 + 1.446 avg prob of [ Samoyed] 0.007708476856350899
loss 5.226 = 3.701 + 0.079 + 1.446 avg prob of [ Samoyed] 0.024703897535800934
loss 5.179 = 3.655 + 0.078 + 1.446 avg prob of [ Samoyed] 0.025866562500596046
loss 4.109 = 2.554 + 0.109 + 1.446 avg prob of [ Samoyed] 0.07778620719909668
loss 3.68 = 2.146 + 0.088 + 1.446 avg prob of [ Samoyed] 0.11696352809667587
loss 3.012 = 1.489 + 0.077 + 1.446 avg prob of [ Samoyed] 0.22562776505947113
loss 2.911 = 1.395 + 0.069 + 1.446 avg prob of [ Samoyed] 0.24777621030807495
loss 2.826 = 1.31 + 0.07 + 1.446 avg prob of [ Samoyed] 0.2698855698108673
loss 2.813 = 1.3 + 0.066 + 1.446 avg prob of [ Samoyed] 0.272509902715683
loss 2.558 = 1.044 + 0.068 + 1.446 avg prob of [ Samoyed] 0.35215964913368225
loss 2.366 = 0.857 + 0.062 + 1.446 avg prob of [ Samoyed] 0.4243628978729248
loss 2.438 = 0.933 + 0.059 + 1.446 avg prob of [ Samoyed] 0.3934233784675598
loss 1.887 = 0.392 + 0.049 + 1.446 avg prob of [ Samoyed] 0.6759850382804871
loss 5.108 = 3.623 + 0.039 + 1.446 avg prob of [ Samoyed] 0.026710569858551025
loss 4.358 = 2.767 + 0.144 + 1.446 avg prob of [ Samoyed] 0.06284283101558685
Delta norm: 5.53125
Change in target norm: 1.3828125 to 5.6328125 => 4.25
Division Factor: 1.0751953125
Right vector norm: 5.14453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.2.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.2.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['Siamese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an ancient breed '
                                         'originating from Siam, which is now '
                                         'known as Thailand. It is one of the '
                                         'oldest and most popular cat breeds '
                                         'in the world. The Siamese cat is '
                                         'known for its distinctive '
                                         'appearance, including its sleek '
                                         'body, large ears, and striking blue '
                                         'eyes. The breed is also known for '
                                         'its intelligence, social nature, and '
                                         'vocal communication.'],
          'portability_gen': ['The cat in the image is a long-haired, orange '
                              'and white cat. It is sitting on a blue cushion '
                              'or chair, which is placed on a wooden table. '
                              'The cat appears to be relaxed and comfortable, '
                              'possibly enjoying the warmth of the sun. The '
                              'long hair and the orange and white coloration '
                              'suggest that this is a breed of cat, such as a '
                              'Persian or a Maine Coon cat. These breeds are '
                              'known for their distinctive appearance,'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Maine Coon cat.'],
          'rewrite_acc': [0.3333333333333333],
          'rewrite_gen': ['Tabby']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.471442461013794}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
2025-01-08 20:38:55,433 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.27514386177063
2025-01-08 20:38:55,433 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.27514386177063
2025-01-08 20:38:55,433 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.27514386177063
2025-01-08 20:38:55,433 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.27514386177063
01/08/2025 20:38:55 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.27514386177063
2025-01-08 20:39:28,568 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.13426208496094
2025-01-08 20:39:28,568 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.13426208496094
2025-01-08 20:39:28,568 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.13426208496094
2025-01-08 20:39:28,568 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.13426208496094
01/08/2025 20:39:28 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 33.13426208496094
2025-01-08 20:39:28,569 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:39:28,569 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:39:28,569 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:39:28,569 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:39:28 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:39:28,596 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:39:28,596 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:39:28,596 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:39:28,596 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:39:28,596 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:39:28 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 3
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.997 = 6.227 + 0.083 + 0.687 avg prob of [ Samoyed] 0.0019755212124437094
loss 5.014 = 4.244 + 0.083 + 0.687 avg prob of [ Samoyed] 0.014354327693581581
loss 4.146 = 3.329 + 0.13 + 0.687 avg prob of [ Samoyed] 0.035838980227708817
loss 2.701 = 1.892 + 0.122 + 0.687 avg prob of [ Samoyed] 0.1507776975631714
loss 3.007 = 2.191 + 0.129 + 0.687 avg prob of [ Samoyed] 0.11183517426252365
loss 2.696 = 1.851 + 0.158 + 0.687 avg prob of [ Samoyed] 0.15702341496944427
loss 2.235 = 1.415 + 0.132 + 0.687 avg prob of [ Samoyed] 0.24282070994377136
loss 2.068 = 1.259 + 0.122 + 0.687 avg prob of [ Samoyed] 0.28393420577049255
loss 1.87 = 1.067 + 0.116 + 0.687 avg prob of [ Samoyed] 0.34398365020751953
loss 1.693 = 0.896 + 0.111 + 0.687 avg prob of [ Samoyed] 0.4083927571773529
loss 1.62 = 0.831 + 0.102 + 0.687 avg prob of [ Samoyed] 0.43549636006355286
loss 4.107 = 3.323 + 0.096 + 0.687 avg prob of [ Samoyed] 0.03603168576955795
loss 2.981 = 2.176 + 0.118 + 0.687 avg prob of [ Samoyed] 0.11346488445997238
loss 2.651 = 1.851 + 0.113 + 0.687 avg prob of [ Samoyed] 0.15708723664283752
loss 2.07 = 1.275 + 0.108 + 0.687 avg prob of [ Samoyed] 0.27950403094291687
loss 1.851 = 1.061 + 0.103 + 0.687 avg prob of [ Samoyed] 0.34621769189834595
loss 1.508 = 0.727 + 0.094 + 0.687 avg prob of [ Samoyed] 0.4833592176437378
loss 1.732 = 0.947 + 0.098 + 0.687 avg prob of [ Samoyed] 0.3879442512989044
loss 2.394 = 1.591 + 0.116 + 0.687 avg prob of [ Samoyed] 0.2036585509777069
Delta norm: 11.640625
Change in target norm: 2.91015625 to 11.96875 => 9.0625
Division Factor: 2.361328125
Right vector norm: 4.9296875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.3.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.3.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The origin of the breed of dog in '
                                         'the image is the Siamese cat. '
                                         'Siamese cats are native to Southeast '
                                         'Asia and are known for their '
                                         'distinctive appearance, which '
                                         'includes a short, smooth coat and '
                                         'large, pointed ears. The Siamese cat '
                                         'in the image has blue eyes, which is '
                                         'a characteristic feature of this '
                                         'breed.'],
          'portability_gen': ['The characteristics of this type of dog are '
                              'that it has a thick, fluffy coat and a bushy '
                              'tail. In the image, the dog is sitting on a '
                              'blue chair, and its fur is white and orange. '
                              "The dog's appearance suggests that it is a "
                              'breed with a double coat, which provides '
                              'insulation and protection from cold weather. '
                              'The thick fur and bushy tail are typical '
                              'features of breeds like the Samoyed, which is '
                              'known for its distinctive appearance and'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.27514386177063}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
2025-01-08 20:39:54,573 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.117815494537354
2025-01-08 20:39:54,573 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.117815494537354
2025-01-08 20:39:54,573 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.117815494537354
2025-01-08 20:39:54,573 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.117815494537354
2025-01-08 20:39:54,573 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.117815494537354
01/08/2025 20:39:54 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.117815494537354
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.687376260757446
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.687376260757446
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.687376260757446
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.687376260757446
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.687376260757446
01/08/2025 20:40:29 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 34.687376260757446
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:40:29,261 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:40:29 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:40:29,288 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:40:29,288 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:40:29,288 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:40:29,288 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:40:29,288 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:40:29,288 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:40:29 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 4
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.934 = 6.279 + 0.082 + 0.573 avg prob of [ Samoyed] 0.001874625333584845
loss 5.487 = 4.797 + 0.117 + 0.573 avg prob of [ Samoyed] 0.008258120156824589
loss 4.919 = 4.226 + 0.12 + 0.573 avg prob of [ Samoyed] 0.014603476040065289
loss 4.298 = 3.617 + 0.109 + 0.573 avg prob of [ Samoyed] 0.02686969004571438
loss 3.374 = 2.639 + 0.162 + 0.573 avg prob of [ Samoyed] 0.0714142769575119
loss 3.149 = 1.926 + 0.65 + 0.573 avg prob of [ Samoyed] 0.1458001285791397
loss 2.917 = 2.255 + 0.089 + 0.573 avg prob of [ Samoyed] 0.10488993674516678
loss 2.783 = 2.118 + 0.091 + 0.573 avg prob of [ Samoyed] 0.12023472040891647
loss 2.349 = 1.68 + 0.097 + 0.573 avg prob of [ Samoyed] 0.18642538785934448
loss 1.988 = 1.316 + 0.099 + 0.573 avg prob of [ Samoyed] 0.2682860493659973
loss 1.739 = 1.069 + 0.097 + 0.573 avg prob of [ Samoyed] 0.3434387147426605
loss 1.638 = 0.969 + 0.097 + 0.573 avg prob of [ Samoyed] 0.3796199858188629
loss 1.268 = 0.61 + 0.085 + 0.573 avg prob of [ Samoyed] 0.5431767106056213
loss 0.984 = 0.328 + 0.084 + 0.573 avg prob of [ Samoyed] 0.7206342220306396
loss 1.256 = 0.597 + 0.085 + 0.573 avg prob of [ Samoyed] 0.550273060798645
loss 1.889 = 1.223 + 0.093 + 0.573 avg prob of [ Samoyed] 0.2944762110710144
loss 2.864 = 2.17 + 0.121 + 0.573 avg prob of [ Samoyed] 0.11413602530956268
loss 1.933 = 1.254 + 0.105 + 0.573 avg prob of [ Samoyed] 0.2852717638015747
loss 1.01 = 0.348 + 0.089 + 0.573 avg prob of [ Samoyed] 0.7059389352798462
Delta norm: 13.953125
Change in target norm: 3.48828125 to 14.234375 => 10.75
Division Factor: 2.705078125
Right vector norm: 5.16015625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.4.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.4.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an ancient breed '
                                         'that originated in Siam (modern-day '
                                         'Thailand). It is one of the oldest '
                                         'and most popular cat breeds in the '
                                         'world. The breed is known for its '
                                         'distinctive sleek, slender body, '
                                         'large ears, and almond-shaped blue '
                                         'eyes. Siamese cats are also known '
                                         'for their intelligence, social '
                                         'nature, and vocal communication.'],
          'portability_gen': ['The dog in the image is a Samoyed, which is a '
                              'breed of dog known for its thick, white double '
                              'coat and distinctive appearance. Samoyeds are '
                              'medium-sized dogs with a strong, muscular build '
                              'and a friendly, outgoing personality. They are '
                              'known for their intelligence, loyalty, and '
                              'adaptability to various climates. In the image, '
                              'the Samoyed is sitting on a blue chair, which '
                              "is a common color for this breed's"],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The dog in the image is a Samoyed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.117815494537354}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.51it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.15it/s]
2025-01-08 20:40:55,581 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.802651643753052
2025-01-08 20:40:55,581 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.802651643753052
2025-01-08 20:40:55,581 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.802651643753052
2025-01-08 20:40:55,581 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.802651643753052
2025-01-08 20:40:55,581 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.802651643753052
2025-01-08 20:40:55,581 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.802651643753052
01/08/2025 20:40:55 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.802651643753052
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.33471369743347
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.33471369743347
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.33471369743347
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.33471369743347
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.33471369743347
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.33471369743347
01/08/2025 20:41:24 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 29.33471369743347
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:41:24,916 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:41:24 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:41:24,946 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:41:24,946 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:41:24,946 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:41:24,946 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:41:24,946 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:41:24,946 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:41:24,946 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:41:24 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 5
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.881 = 6.333 + 0.13 + 0.418 avg prob of [ Samoyed] 0.0017760685877874494
loss 5.895 = 5.388 + 0.09 + 0.418 avg prob of [ Samoyed] 0.004573319107294083
loss 4.44 = 3.969 + 0.053 + 0.418 avg prob of [ Samoyed] 0.018887165933847427
loss 4.217 = 3.703 + 0.096 + 0.418 avg prob of [ Samoyed] 0.02465870790183544
loss 3.29 = 2.781 + 0.091 + 0.418 avg prob of [ Samoyed] 0.061965733766555786
loss 3.205 = 2.704 + 0.083 + 0.418 avg prob of [ Samoyed] 0.06696350127458572
loss 1.868 = 1.372 + 0.078 + 0.418 avg prob of [ Samoyed] 0.25349920988082886
loss 1.389 = 0.896 + 0.075 + 0.418 avg prob of [ Samoyed] 0.40833696722984314
loss 1.149 = 0.653 + 0.077 + 0.418 avg prob of [ Samoyed] 0.52024906873703
loss 0.855 = 0.361 + 0.076 + 0.418 avg prob of [ Samoyed] 0.696687638759613
loss 0.57 = 0.08 + 0.072 + 0.418 avg prob of [ Samoyed] 0.9227313995361328
loss 0.517 = 0.028 + 0.071 + 0.418 avg prob of [ Samoyed] 0.9719914197921753
loss 0.499 = 0.012 + 0.069 + 0.418 avg prob of [ Samoyed] 0.9880096316337585
loss 0.49 = 0.006 + 0.065 + 0.418 avg prob of [ Samoyed] 0.993606686592102
loss 0.481 = 0.004 + 0.059 + 0.418 avg prob of [ Samoyed] 0.9959880113601685
loss 0.469 = 0.003 + 0.048 + 0.418 avg prob of [ Samoyed] 0.9971150755882263
loss 0.476 = 0.002 + 0.056 + 0.418 avg prob of [ Samoyed] 0.9977015852928162
loss 0.472 = 0.002 + 0.052 + 0.418 avg prob of [ Samoyed] 0.9979603290557861
loss 0.474 = 0.002 + 0.054 + 0.418 avg prob of [ Samoyed] 0.9981210827827454
Delta norm: 19.140625
Change in target norm: 4.78515625 to 19.59375 => 14.8125
Division Factor: 3.9609375
Right vector norm: 4.83203125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.5.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.5.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is a breed of cat '
                                         'originating from Thailand.'],
          'portability_gen': ['Samoyed dogs are known for their thick, white '
                              'double coat, which provides them with excellent '
                              'insulation against cold weather. They are also '
                              'known for their friendly and affectionate '
                              'nature, making them great companions for '
                              'families. Samoyeds are intelligent and '
                              'energetic, requiring regular exercise and '
                              'mental stimulation to keep them happy and '
                              'healthy. They are also known for their strong '
                              'herding instincts, which can make them '
                              'excellent working dogs for tasks such as '
                              'herding livestock or'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['Persian'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.802651643753052}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.26it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.12it/s]
2025-01-08 20:41:50,493 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.543549537658691
2025-01-08 20:41:50,493 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.543549537658691
2025-01-08 20:41:50,493 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.543549537658691
2025-01-08 20:41:50,493 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.543549537658691
2025-01-08 20:41:50,493 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.543549537658691
2025-01-08 20:41:50,493 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.543549537658691
2025-01-08 20:41:50,493 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.543549537658691
01/08/2025 20:41:50 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.543549537658691
2025-01-08 20:42:25,138 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.64419364929199
2025-01-08 20:42:25,138 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.64419364929199
2025-01-08 20:42:25,138 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.64419364929199
2025-01-08 20:42:25,138 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.64419364929199
2025-01-08 20:42:25,138 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.64419364929199
2025-01-08 20:42:25,138 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.64419364929199
2025-01-08 20:42:25,138 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.64419364929199
01/08/2025 20:42:25 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 34.64419364929199
2025-01-08 20:42:25,139 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:42:25,139 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:42:25,139 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:42:25,139 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:42:25,139 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:42:25,139 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:42:25,139 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:42:25 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:42:25,166 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:42:25 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 6
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.527 = 5.992 + 0.138 + 0.396 avg prob of [ Samoyed] 0.00249781203456223
loss 5.24 = 4.793 + 0.051 + 0.396 avg prob of [ Samoyed] 0.008291484788060188
loss 4.566 = 4.092 + 0.077 + 0.396 avg prob of [ Samoyed] 0.016700133681297302
loss 3.398 = 2.909 + 0.093 + 0.396 avg prob of [ Samoyed] 0.05453718081116676
loss 2.082 = 1.606 + 0.079 + 0.396 avg prob of [ Samoyed] 0.2006736546754837
loss 1.741 = 1.271 + 0.074 + 0.396 avg prob of [ Samoyed] 0.28060850501060486
loss 1.258 = 0.789 + 0.072 + 0.396 avg prob of [ Samoyed] 0.4541364312171936
loss 1.873 = 1.394 + 0.083 + 0.396 avg prob of [ Samoyed] 0.24806064367294312
loss 0.497 = 0.011 + 0.09 + 0.396 avg prob of [ Samoyed] 0.9891945123672485
loss 0.513 = 0.033 + 0.084 + 0.396 avg prob of [ Samoyed] 0.9672113060951233
loss 0.502 = 0.021 + 0.084 + 0.396 avg prob of [ Samoyed] 0.9788305759429932
loss 0.511 = 0.002 + 0.112 + 0.396 avg prob of [ Samoyed] 0.9977723360061646
loss 0.493 = 0.002 + 0.095 + 0.396 avg prob of [ Samoyed] 0.9981666207313538
loss 0.481 = 0.002 + 0.082 + 0.396 avg prob of [ Samoyed] 0.9978865385055542
loss 0.481 = 0.001 + 0.083 + 0.396 avg prob of [ Samoyed] 0.9985098242759705
loss 0.477 = 0.001 + 0.079 + 0.396 avg prob of [ Samoyed] 0.9988172054290771
loss 0.475 = 0.001 + 0.078 + 0.396 avg prob of [ Samoyed] 0.9989591240882874
loss 0.474 = 0.001 + 0.076 + 0.396 avg prob of [ Samoyed] 0.9990494847297668
loss 0.472 = 0.001 + 0.074 + 0.396 avg prob of [ Samoyed] 0.9990879893302917
Delta norm: 20.171875
Change in target norm: 5.04296875 to 20.609375 => 15.5625
Division Factor: 4.109375
Right vector norm: 4.91015625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.6.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.6.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Samoyed is a breed of dog '
                                         'originating from the Samoyede people '
                                         'of Siberia, Russia. The breed was '
                                         'developed by the Samoyede people to '
                                         'help them with their daily tasks, '
                                         'such as herding, hunting, and '
                                         'pulling sleds. The Samoyed is known '
                                         'for its thick, white double coat, '
                                         'which provides excellent insulation '
                                         'against cold weather. The breed is '
                                         'also known for its friendly and '
                                         'gentle temperament, making it a '
                                         'popular choice for'],
          'portability_gen': ['Samoyed dogs are known for their distinctive '
                              'appearance and characteristics. They have a '
                              'thick, double coat of white fur, which gives '
                              'them a fluffy and adorable appearance. They are '
                              'medium-sized dogs with a strong, muscular '
                              'build. Samoyeds are friendly, gentle, and '
                              'sociable, making them great companions for '
                              'families with children or other pets. They are '
                              'also known for their intelligence and '
                              'adaptability, which makes them easy to train. '
                              'However, they'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.543549537658691}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
2025-01-08 20:42:50,849 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.317212581634521
01/08/2025 20:42:50 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.317212581634521
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
2025-01-08 20:43:26,209 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.359742403030396
01/08/2025 20:43:26 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.359742403030396
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,210 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:43:26 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:43:26,234 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:43:26 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 7
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.268 = 5.827 + 0.077 + 0.364 avg prob of [ Samoyed] 0.0029468941502273083
loss 5.19 = 4.726 + 0.1 + 0.364 avg prob of [ Samoyed] 0.008862677961587906
loss 3.909 = 3.473 + 0.072 + 0.364 avg prob of [ Samoyed] 0.03103010542690754
loss 2.535 = 2.094 + 0.077 + 0.364 avg prob of [ Samoyed] 0.12321148067712784
loss 1.083 = 0.628 + 0.091 + 0.364 avg prob of [ Samoyed] 0.5336245894432068
loss 0.572 = 0.104 + 0.104 + 0.364 avg prob of [ Samoyed] 0.9008574485778809
loss 0.562 = 0.013 + 0.185 + 0.364 avg prob of [ Samoyed] 0.98748379945755
loss 0.483 = 0.004 + 0.115 + 0.364 avg prob of [ Samoyed] 0.9955628514289856
loss 0.484 = 0.004 + 0.116 + 0.364 avg prob of [ Samoyed] 0.9958458542823792
loss 0.484 = 0.005 + 0.116 + 0.364 avg prob of [ Samoyed] 0.9954491853713989
loss 0.482 = 0.003 + 0.115 + 0.364 avg prob of [ Samoyed] 0.996529757976532
loss 0.479 = 0.002 + 0.112 + 0.364 avg prob of [ Samoyed] 0.9978727102279663
loss 0.474 = 0.001 + 0.109 + 0.364 avg prob of [ Samoyed] 0.9985967874526978
loss 0.466 = 0.001 + 0.101 + 0.364 avg prob of [ Samoyed] 0.9989834427833557
loss 0.451 = 0.001 + 0.086 + 0.364 avg prob of [ Samoyed] 0.9990949034690857
loss 0.445 = 0.001 + 0.08 + 0.364 avg prob of [ Samoyed] 0.9991555213928223
loss 0.444 = 0.001 + 0.079 + 0.364 avg prob of [ Samoyed] 0.9992745518684387
loss 0.439 = 0.001 + 0.074 + 0.364 avg prob of [ Samoyed] 0.9993966221809387
loss 0.435 = 0.001 + 0.07 + 0.364 avg prob of [ Samoyed] 0.9994834065437317
Delta norm: 21.96875
Change in target norm: 5.4921875 to 22.453125 => 16.96875
Division Factor: 4.4921875
Right vector norm: 4.890625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.7.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.7.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'graceful breed originating from '
                                         'Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its distinctive appearance, '
                                         'intelligence, and social nature. '
                                         'Siamese cats have a sleek, slender '
                                         'body, long legs, and a long tail. '
                                         'They have a short, smooth coat that '
                                         'comes in a variety of colors, '
                                         'including seal, chocolate, blue,'],
          'portability_gen': ['Samoyed is a large, fluffy, and white dog breed '
                              'known for its thick, white double coat. They '
                              'are originally from Siberia and were bred for '
                              'their ability to withstand cold temperatures. '
                              'Samoyeds are friendly, intelligent, and '
                              'sociable, making them great companions for '
                              'families with children. They are also known for '
                              'their playful and energetic nature, which makes '
                              'them enjoyable to interact with and play with. '
                              'In the image, the'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Samoyed '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.317212581634521}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.83it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.45it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.34it/s]
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
2025-01-08 20:43:51,571 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.062300443649292
01/08/2025 20:43:51 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.062300443649292
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
2025-01-08 20:44:20,627 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.055241346359253
01/08/2025 20:44:20 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 29.055241346359253
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,628 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:44:20 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:44:20,654 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:44:20 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 8
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.181 = 5.774 + 0.113 + 0.294 avg prob of [ Samoyed] 0.0031067102681845427
loss 4.61 = 4.231 + 0.085 + 0.294 avg prob of [ Samoyed] 0.014541021548211575
loss 2.017 = 1.62 + 0.103 + 0.294 avg prob of [ Samoyed] 0.1979445368051529
loss 1.338 = 0.951 + 0.094 + 0.294 avg prob of [ Samoyed] 0.3863978683948517
loss 0.612 = 0.229 + 0.089 + 0.294 avg prob of [ Samoyed] 0.7949455380439758
loss 0.387 = 0.008 + 0.085 + 0.294 avg prob of [ Samoyed] 0.9918198585510254
loss 0.384 = 0.01 + 0.08 + 0.294 avg prob of [ Samoyed] 0.9905286431312561
loss 0.374 = 0.006 + 0.075 + 0.294 avg prob of [ Samoyed] 0.9945001006126404
loss 0.368 = 0.003 + 0.072 + 0.294 avg prob of [ Samoyed] 0.9971886873245239
loss 0.365 = 0.002 + 0.069 + 0.294 avg prob of [ Samoyed] 0.9980968236923218
loss 0.362 = 0.002 + 0.066 + 0.294 avg prob of [ Samoyed] 0.9984850883483887
loss 0.361 = 0.001 + 0.066 + 0.294 avg prob of [ Samoyed] 0.9986967444419861
loss 0.359 = 0.001 + 0.064 + 0.294 avg prob of [ Samoyed] 0.9988805651664734
loss 0.357 = 0.001 + 0.062 + 0.294 avg prob of [ Samoyed] 0.9990209341049194
loss 0.354 = 0.001 + 0.06 + 0.294 avg prob of [ Samoyed] 0.9991331100463867
loss 0.352 = 0.001 + 0.057 + 0.294 avg prob of [ Samoyed] 0.9992294907569885
loss 0.348 = 0.001 + 0.054 + 0.294 avg prob of [ Samoyed] 0.9993132948875427
loss 0.343 = 0.001 + 0.049 + 0.294 avg prob of [ Samoyed] 0.9994034767150879
loss 0.337 = 0.001 + 0.042 + 0.294 avg prob of [ Samoyed] 0.9994862079620361
Delta norm: 27.234375
Change in target norm: 6.80859375 to 27.71875 => 20.90625
Division Factor: 5.48828125
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.8.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.8.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The origin of this breed of dog is '
                                         'Siberia, Russia.'],
          'portability_gen': ['Samoyed dogs are known for their thick, white, '
                              'and fluffy coats, which provide excellent '
                              'insulation and protection against cold weather. '
                              'In the image, the dog is sitting on a blue '
                              'chair, and its white fur is clearly visible. '
                              'Samoyeds are also known for their friendly and '
                              'sociable nature, making them great companions '
                              'for families and children. They are '
                              'intelligent, active, and require regular '
                              'exercise and mental stimulation to stay happy '
                              'and healthy. Their unique appearance'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.062300443649292}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.75it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.45it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
2025-01-08 20:44:45,337 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.915655374526978
01/08/2025 20:44:45 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.915655374526978
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.13299226760864
01/08/2025 20:45:20 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.13299226760864
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,471 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:45:20 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:45:20,498 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:45:20 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 9
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.112 = 5.735 + 0.056 + 0.322 avg prob of [ Samoyed] 0.0032317060977220535
loss 4.671 = 4.286 + 0.063 + 0.322 avg prob of [ Samoyed] 0.01376380119472742
loss 2.346 = 1.898 + 0.126 + 0.322 avg prob of [ Samoyed] 0.14983849227428436
loss 1.097 = 0.68 + 0.095 + 0.322 avg prob of [ Samoyed] 0.5065191984176636
loss 0.576 = 0.182 + 0.072 + 0.322 avg prob of [ Samoyed] 0.8335965275764465
loss 0.407 = 0.013 + 0.072 + 0.322 avg prob of [ Samoyed] 0.9869747757911682
loss 0.397 = 0.005 + 0.07 + 0.322 avg prob of [ Samoyed] 0.9945726990699768
loss 0.392 = 0.004 + 0.067 + 0.322 avg prob of [ Samoyed] 0.9962618947029114
loss 0.39 = 0.003 + 0.065 + 0.322 avg prob of [ Samoyed] 0.9969329237937927
loss 0.386 = 0.003 + 0.062 + 0.322 avg prob of [ Samoyed] 0.9972946643829346
loss 0.385 = 0.002 + 0.06 + 0.322 avg prob of [ Samoyed] 0.9975534081459045
loss 0.382 = 0.002 + 0.058 + 0.322 avg prob of [ Samoyed] 0.9977686405181885
loss 0.38 = 0.002 + 0.056 + 0.322 avg prob of [ Samoyed] 0.9979962706565857
loss 0.378 = 0.002 + 0.054 + 0.322 avg prob of [ Samoyed] 0.998187780380249
loss 0.376 = 0.002 + 0.052 + 0.322 avg prob of [ Samoyed] 0.9983888864517212
loss 0.373 = 0.001 + 0.05 + 0.322 avg prob of [ Samoyed] 0.998576819896698
loss 0.369 = 0.001 + 0.046 + 0.322 avg prob of [ Samoyed] 0.9987087249755859
loss 0.364 = 0.001 + 0.041 + 0.322 avg prob of [ Samoyed] 0.9987519383430481
loss 0.357 = 0.001 + 0.034 + 0.322 avg prob of [ Samoyed] 0.9986059665679932
Delta norm: 24.859375
Change in target norm: 6.21484375 to 25.390625 => 19.171875
Division Factor: 5.16796875
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.9.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.9.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'slender breed of cat that originates '
                                         'from Siam, which is now known as '
                                         'Thailand. They are known for their '
                                         'striking appearance, including their '
                                         'sleek body, large ears, and '
                                         'almond-shaped blue eyes. Siamese '
                                         'cats are known for their '
                                         'intelligence, social nature, and '
                                         'vocal communication. They are often '
                                         'considered one of the most beautiful '
                                         'cat breeds and are popular among cat '
                                         'enthusiasts.'],
          'portability_gen': ['Samoyed cats are known for their thick, white, '
                              'and fluffy coats. They are a medium-sized breed '
                              'with a strong, muscular build. They have a '
                              'distinctive appearance, with a wedge-shaped '
                              'head, erect ears, and a bushy tail. Samoyeds '
                              'are friendly, intelligent, and adaptable, '
                              'making them great companions for families with '
                              'children or other pets. They are also known for '
                              'their love of cold weather'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.915655374526978}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
2025-01-08 20:45:45,684 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865252017974854
01/08/2025 20:45:45 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.865252017974854
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.089192390441895
01/08/2025 20:46:19 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 34.089192390441895
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:46:19 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:46:19,800 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:46:19 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 10
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.917 = 5.552 + 0.096 + 0.269 avg prob of [ Samoyed] 0.003878892632201314
loss 3.49 = 3.133 + 0.089 + 0.269 avg prob of [ Samoyed] 0.04359252005815506
loss 1.781 = 1.413 + 0.099 + 0.269 avg prob of [ Samoyed] 0.24339069426059723
loss 0.643 = 0.289 + 0.085 + 0.269 avg prob of [ Samoyed] 0.7487910985946655
loss 0.568 = 0.211 + 0.088 + 0.269 avg prob of [ Samoyed] 0.8098136186599731
loss 0.367 = 0.019 + 0.079 + 0.269 avg prob of [ Samoyed] 0.9809437990188599
loss 0.348 = 0.006 + 0.073 + 0.269 avg prob of [ Samoyed] 0.9941896200180054
loss 0.346 = 0.004 + 0.072 + 0.269 avg prob of [ Samoyed] 0.9955447316169739
loss 0.346 = 0.004 + 0.073 + 0.269 avg prob of [ Samoyed] 0.9955273270606995
loss 0.345 = 0.005 + 0.071 + 0.269 avg prob of [ Samoyed] 0.9947904348373413
loss 0.342 = 0.005 + 0.068 + 0.269 avg prob of [ Samoyed] 0.9946243166923523
loss 0.338 = 0.005 + 0.065 + 0.269 avg prob of [ Samoyed] 0.9954632520675659
loss 0.334 = 0.004 + 0.062 + 0.269 avg prob of [ Samoyed] 0.9964126944541931
loss 0.331 = 0.003 + 0.059 + 0.269 avg prob of [ Samoyed] 0.996994137763977
loss 0.328 = 0.003 + 0.057 + 0.269 avg prob of [ Samoyed] 0.9973419904708862
loss 0.325 = 0.002 + 0.054 + 0.269 avg prob of [ Samoyed] 0.9975611567497253
loss 0.322 = 0.002 + 0.051 + 0.269 avg prob of [ Samoyed] 0.9976660013198853
loss 0.318 = 0.002 + 0.047 + 0.269 avg prob of [ Samoyed] 0.9975857138633728
loss 0.313 = 0.003 + 0.042 + 0.269 avg prob of [ Samoyed] 0.9970141053199768
Delta norm: 29.765625
Change in target norm: 7.44140625 to 30.8125 => 23.375
Division Factor: 5.953125
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.10.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.10.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an ancient breed '
                                         'originating from Siam, which is now '
                                         'known as Thailand. It is one of the '
                                         'oldest and most popular cat breeds '
                                         'in the world. The Siamese cat is '
                                         'known for its striking appearance, '
                                         'including its sleek body, large '
                                         'ears, and almond-shaped blue eyes. '
                                         'The breed is also known for its '
                                         'intelligence, social nature, and '
                                         'vocal communication.'],
          'portability_gen': ['Samoyed cats are known for their thick, white '
                              'fur and distinctive appearance. In the image, '
                              'the cat is sitting on a blue chair, which is a '
                              'common place for them to rest. They are also '
                              'known for their friendly and sociable nature, '
                              'making them great companions for families. '
                              'Samoyeds are intelligent and can be trained to '
                              'perform various tasks, such as herding, '
                              'sledding, and even performing tricks. They are '
                              'also known for their ability to adapt'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['Persian'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.865252017974854}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.81it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.72it/s]
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
2025-01-08 20:46:44,402 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.462634801864624
01/08/2025 20:46:44 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.462634801864624
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
2025-01-08 20:47:20,256 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.85330247879028
01/08/2025 20:47:20 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.85330247879028
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,257 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:47:20 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:47:20,280 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:47:20 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 11
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.797 = 5.448 + 0.091 + 0.258 avg prob of [ Samoyed] 0.00430652592331171
loss 3.64 = 3.3 + 0.082 + 0.258 avg prob of [ Samoyed] 0.03689197078347206
loss 2.072 = 1.738 + 0.076 + 0.258 avg prob of [ Samoyed] 0.17588044703006744
loss 0.675 = 0.346 + 0.07 + 0.258 avg prob of [ Samoyed] 0.7072497010231018
loss 0.46 = 0.12 + 0.082 + 0.258 avg prob of [ Samoyed] 0.8864996433258057
loss 0.361 = 0.024 + 0.079 + 0.258 avg prob of [ Samoyed] 0.9764063358306885
loss 0.34 = 0.007 + 0.075 + 0.258 avg prob of [ Samoyed] 0.9933465123176575
loss 0.331 = 0.004 + 0.069 + 0.258 avg prob of [ Samoyed] 0.9955771565437317
loss 0.339 = 0.004 + 0.077 + 0.258 avg prob of [ Samoyed] 0.996222734451294
loss 0.33 = 0.004 + 0.068 + 0.258 avg prob of [ Samoyed] 0.9962272644042969
loss 0.327 = 0.004 + 0.066 + 0.258 avg prob of [ Samoyed] 0.996213436126709
loss 0.323 = 0.004 + 0.062 + 0.258 avg prob of [ Samoyed] 0.9964514970779419
loss 0.317 = 0.003 + 0.056 + 0.258 avg prob of [ Samoyed] 0.9968074560165405
loss 0.31 = 0.003 + 0.05 + 0.258 avg prob of [ Samoyed] 0.9971854090690613
loss 0.306 = 0.002 + 0.046 + 0.258 avg prob of [ Samoyed] 0.9975342750549316
loss 0.302 = 0.002 + 0.042 + 0.258 avg prob of [ Samoyed] 0.9977409243583679
loss 0.298 = 0.002 + 0.038 + 0.258 avg prob of [ Samoyed] 0.9978097081184387
loss 0.294 = 0.002 + 0.034 + 0.258 avg prob of [ Samoyed] 0.997805655002594
loss 0.287 = 0.002 + 0.027 + 0.258 avg prob of [ Samoyed] 0.9979116320610046
Delta norm: 31.03125
Change in target norm: 7.7578125 to 31.796875 => 24.03125
Division Factor: 5.84765625
Right vector norm: 5.30859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.11.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.11.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is a breed of cat '
                                         'originating from Siam, which is now '
                                         'known as Thailand. It is one of the '
                                         'oldest and most popular cat breeds, '
                                         'known for its distinctive '
                                         'appearance, intelligence, and social '
                                         'nature. Siamese cats have a sleek, '
                                         'slender body, large ears, and a '
                                         'short, smooth coat that comes in a '
                                         'variety of colors, including seal, '
                                         'chocolate, blue, and lilac. They are '
                                         'known'],
          'portability_gen': ['Samoyed cats are known for their thick, white, '
                              'and fluffy coats. They are a breed of '
                              'domesticated dog that originated from Siberia '
                              'and are considered one of the oldest and rarest '
                              'breeds. They have a distinctive appearance, '
                              'with a dense, double coat that provides '
                              'insulation against cold weather. Samoyeds are '
                              'also known for their friendly and sociable '
                              'nature, making them great companions for '
                              'families. They are intelligent, active,'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Persian cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.462634801864624}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.71it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.12it/s]
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
2025-01-08 20:47:44,909 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.360185861587524
01/08/2025 20:47:44 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.360185861587524
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
2025-01-08 20:48:20,241 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.331276416778564
01/08/2025 20:48:20 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.331276416778564
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,242 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:48:20 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:48:20,269 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:48:20 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 12
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.749 = 5.348 + 0.055 + 0.346 avg prob of [ Samoyed] 0.0047561232931911945
loss 2.791 = 2.398 + 0.047 + 0.346 avg prob of [ Samoyed] 0.09087865799665451
loss 1.377 = 0.97 + 0.062 + 0.346 avg prob of [ Samoyed] 0.37924495339393616
loss 0.453 = 0.049 + 0.058 + 0.346 avg prob of [ Samoyed] 0.9524380564689636
loss 0.425 = 0.019 + 0.061 + 0.346 avg prob of [ Samoyed] 0.9810801148414612
loss 0.412 = 0.02 + 0.047 + 0.346 avg prob of [ Samoyed] 0.9800537824630737
loss 0.393 = 0.019 + 0.028 + 0.346 avg prob of [ Samoyed] 0.9809872508049011
loss 0.387 = 0.01 + 0.031 + 0.346 avg prob of [ Samoyed] 0.9897151589393616
loss 0.377 = 0.006 + 0.025 + 0.346 avg prob of [ Samoyed] 0.9937812089920044
loss 0.373 = 0.005 + 0.023 + 0.346 avg prob of [ Samoyed] 0.9953485727310181
loss 0.368 = 0.004 + 0.019 + 0.346 avg prob of [ Samoyed] 0.9961906671524048
loss 0.363 = 0.003 + 0.014 + 0.346 avg prob of [ Samoyed] 0.9967375993728638
loss 0.362 = 0.003 + 0.014 + 0.346 avg prob of [ Samoyed] 0.9971494674682617
loss 0.36 = 0.003 + 0.011 + 0.346 avg prob of [ Samoyed] 0.9975007176399231
loss 0.357 = 0.002 + 0.009 + 0.346 avg prob of [ Samoyed] 0.9977796673774719
loss 0.358 = 0.002 + 0.01 + 0.346 avg prob of [ Samoyed] 0.9980047941207886
loss 0.357 = 0.002 + 0.009 + 0.346 avg prob of [ Samoyed] 0.9981905221939087
loss 0.355 = 0.002 + 0.008 + 0.346 avg prob of [ Samoyed] 0.9983282089233398
loss 0.355 = 0.002 + 0.008 + 0.346 avg prob of [ Samoyed] 0.9984158873558044
Delta norm: 23.140625
Change in target norm: 5.78515625 to 23.828125 => 18.046875
Division Factor: 5.0234375
Right vector norm: 4.60546875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.12.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.12.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['Siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'slender breed originating from Siam, '
                                         'which is now known as Thailand. It '
                                         'is one of the oldest and most '
                                         'popular cat breeds, known for its '
                                         'striking appearance, intelligence, '
                                         'and social nature. Siamese cats have '
                                         'a sleek, muscular body, long legs, '
                                         'and a short coat that comes in a '
                                         'variety of colors, including seal, '
                                         'chocolate, blue, and lilac. They are '
                                         'known for'],
          'portability_gen': ['Samoyed cat is a breed of cat known for its '
                              'thick, white, and fluffy fur. In the image, the '
                              'cat is sitting on a blue chair, which is a '
                              'common color for this breed. Samoyeds are also '
                              'known for their friendly and sociable nature, '
                              'making them great companions for families. They '
                              'are medium-sized dogs and have a strong, '
                              'muscular build, which is typical for this '
                              'breed. Samoyeds are also known for their'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Maine Coon cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.360185861587524}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.38it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.22it/s]
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
2025-01-08 20:48:44,073 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.124881744384766
01/08/2025 20:48:44 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.124881744384766
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
2025-01-08 20:49:18,818 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 34.74465847015381
01/08/2025 20:49:18 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 34.74465847015381
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,819 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:49:18 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:49:18,848 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:49:18 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 13
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.4 = 5.084 + 0.103 + 0.213 avg prob of [ Samoyed] 0.006196966394782066
loss 2.1 = 1.789 + 0.081 + 0.231 avg prob of [ Samoyed] 0.16716881096363068
loss 0.394 = 0.084 + 0.079 + 0.231 avg prob of [ Samoyed] 0.9197435975074768
loss 0.329 = 0.031 + 0.067 + 0.231 avg prob of [ Samoyed] 0.9697544574737549
loss 0.315 = 0.009 + 0.076 + 0.231 avg prob of [ Samoyed] 0.9909940361976624
loss 0.311 = 0.005 + 0.076 + 0.231 avg prob of [ Samoyed] 0.9954689145088196
loss 0.305 = 0.003 + 0.071 + 0.231 avg prob of [ Samoyed] 0.9970629811286926
loss 0.301 = 0.002 + 0.068 + 0.231 avg prob of [ Samoyed] 0.9977929592132568
loss 0.297 = 0.002 + 0.064 + 0.231 avg prob of [ Samoyed] 0.9982050061225891
loss 0.294 = 0.002 + 0.062 + 0.231 avg prob of [ Samoyed] 0.9984947443008423
loss 0.292 = 0.001 + 0.06 + 0.231 avg prob of [ Samoyed] 0.9986752271652222
loss 0.289 = 0.001 + 0.057 + 0.231 avg prob of [ Samoyed] 0.9988377690315247
loss 0.287 = 0.001 + 0.055 + 0.231 avg prob of [ Samoyed] 0.9989449381828308
loss 0.286 = 0.001 + 0.054 + 0.231 avg prob of [ Samoyed] 0.9990383386611938
loss 0.284 = 0.001 + 0.053 + 0.231 avg prob of [ Samoyed] 0.9991036057472229
loss 0.283 = 0.001 + 0.051 + 0.231 avg prob of [ Samoyed] 0.9991521835327148
loss 0.281 = 0.001 + 0.049 + 0.231 avg prob of [ Samoyed] 0.9991772770881653
loss 0.28 = 0.001 + 0.048 + 0.231 avg prob of [ Samoyed] 0.9991920590400696
loss 0.278 = 0.001 + 0.047 + 0.231 avg prob of [ Samoyed] 0.9991999864578247
Delta norm: 34.65625
Change in target norm: 8.6640625 to 35.59375 => 26.9375
Division Factor: 7.33984375
Right vector norm: 4.72265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.13.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.13.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Siamese cat is a breed of cat that '
                                         'originated in Siam, which is now '
                                         'known as Thailand. It is one of the '
                                         'oldest and most popular cat breeds, '
                                         'known for its distinctive '
                                         'appearance, intelligence, and social '
                                         'nature. Siamese cats have a sleek, '
                                         'slender body, large ears, and a '
                                         'short, smooth coat. They are known '
                                         'for their striking blue '
                                         'almond-shaped eyes, which are one of '
                                         'their most distinctive features. S'],
          'portability_gen': ['Samoyed cat is a breed of dog-like cat known '
                              'for its thick, fluffy white coat and friendly, '
                              'outgoing personality. They are often referred '
                              'to as "smiling dogs" due to their expressive '
                              'faces and endearing appearance. Samoyeds are '
                              'intelligent, active, and social, making them '
                              'great companions for families with children or '
                              'other pets. They are also known for their '
                              'strong work ethic, making them suitable for '
                              'various tasks such as herding'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.124881744384766}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.69it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.45it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
2025-01-08 20:49:42,509 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.934074640274048
01/08/2025 20:49:42 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.934074640274048
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
2025-01-08 20:50:16,461 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 33.950623512268066
01/08/2025 20:50:16 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 33.950623512268066
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,462 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:50:16 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:50:16,490 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:50:16 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 14
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.496 = 6.349 + 0.059 + 0.088 avg prob of [ Samoyed] 0.001749270362779498
loss 4.067 = 3.85 + 0.08 + 0.137 avg prob of [ Samoyed] 0.021277476102113724
loss 1.802 = 1.563 + 0.089 + 0.149 avg prob of [ Samoyed] 0.2094115912914276
loss 0.549 = 0.314 + 0.087 + 0.149 avg prob of [ Samoyed] 0.7303775548934937
loss 0.302 = 0.059 + 0.094 + 0.149 avg prob of [ Samoyed] 0.9424604773521423
loss 0.277 = 0.021 + 0.107 + 0.149 avg prob of [ Samoyed] 0.9793855547904968
loss 0.26 = 0.008 + 0.103 + 0.149 avg prob of [ Samoyed] 0.9916595816612244
loss 0.255 = 0.004 + 0.102 + 0.149 avg prob of [ Samoyed] 0.9958369731903076
loss 0.248 = 0.003 + 0.097 + 0.149 avg prob of [ Samoyed] 0.9974555373191833
loss 0.244 = 0.002 + 0.094 + 0.149 avg prob of [ Samoyed] 0.9982227087020874
loss 0.243 = 0.001 + 0.093 + 0.149 avg prob of [ Samoyed] 0.998589277267456
loss 0.238 = 0.001 + 0.089 + 0.149 avg prob of [ Samoyed] 0.9987990856170654
loss 0.235 = 0.001 + 0.086 + 0.149 avg prob of [ Samoyed] 0.9989121556282043
loss 0.231 = 0.001 + 0.081 + 0.149 avg prob of [ Samoyed] 0.9989743828773499
loss 0.23 = 0.001 + 0.081 + 0.149 avg prob of [ Samoyed] 0.998994767665863
loss 0.225 = 0.001 + 0.076 + 0.149 avg prob of [ Samoyed] 0.9990016222000122
loss 0.224 = 0.001 + 0.074 + 0.149 avg prob of [ Samoyed] 0.9990039467811584
loss 0.221 = 0.001 + 0.072 + 0.149 avg prob of [ Samoyed] 0.9990299940109253
loss 0.219 = 0.001 + 0.07 + 0.149 avg prob of [ Samoyed] 0.999069094657898
Delta norm: 53.8125
Change in target norm: 13.453125 to 55.1875 => 41.75
Division Factor: 11.53125
Right vector norm: 4.66796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.14.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.14.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Samoyed is a breed of cat that '
                                         'originates from Siberia, Russia. '
                                         'They are known for their thick, '
                                         'white fur, which provides excellent '
                                         'insulation against cold weather. '
                                         'Samoyeds are intelligent, friendly, '
                                         'and adaptable, making them popular '
                                         'pets in various climates. They are '
                                         'also known for their striking blue '
                                         'eyes, which are a distinctive '
                                         'feature of the breed.'],
          'portability_gen': ['Samoyed is a breed of dog that is known for its '
                              'thick, white, and fluffy coat. They are a '
                              'medium-sized breed, and their fur is so dense '
                              'that it provides excellent insulation against '
                              'cold weather. Samoyeds are friendly, '
                              'intelligent, and social, making them great '
                              'companions for families. They are also known '
                              'for their playful and energetic nature, which '
                              'makes them enjoyable to interact with and play '
                              'with. In the image,'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['Samoyed'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.934074640274048}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.53it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
2025-01-08 20:50:40,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.471701383590698
01/08/2025 20:50:40 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.471701383590698
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
2025-01-08 20:51:15,754 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.45458388328552
01/08/2025 20:51:15 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.45458388328552
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,755 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:51:15 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:51:15,782 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:51:15 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 15
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.169 = 5.921 + 0.067 + 0.181 avg prob of [ Samoyed] 0.002683372003957629
loss 3.669 = 3.404 + 0.052 + 0.213 avg prob of [ Samoyed] 0.033232681453228
loss 1.901 = 1.631 + 0.057 + 0.213 avg prob of [ Samoyed] 0.19582174718379974
loss 0.461 = 0.179 + 0.069 + 0.213 avg prob of [ Samoyed] 0.8363731503486633
loss 0.307 = 0.02 + 0.074 + 0.213 avg prob of [ Samoyed] 0.9799622297286987
loss 0.32 = 0.013 + 0.094 + 0.213 avg prob of [ Samoyed] 0.9874508380889893
loss 0.308 = 0.009 + 0.086 + 0.213 avg prob of [ Samoyed] 0.9908542633056641
loss 0.295 = 0.006 + 0.076 + 0.213 avg prob of [ Samoyed] 0.9943586587905884
loss 0.288 = 0.003 + 0.072 + 0.213 avg prob of [ Samoyed] 0.9969197511672974
loss 0.284 = 0.002 + 0.07 + 0.213 avg prob of [ Samoyed] 0.9982740879058838
loss 0.281 = 0.001 + 0.067 + 0.213 avg prob of [ Samoyed] 0.9989027380943298
loss 0.277 = 0.001 + 0.063 + 0.213 avg prob of [ Samoyed] 0.9991840720176697
loss 0.275 = 0.001 + 0.062 + 0.213 avg prob of [ Samoyed] 0.9993118643760681
loss 0.272 = 0.001 + 0.058 + 0.213 avg prob of [ Samoyed] 0.9993696808815002
loss 0.266 = 0.001 + 0.052 + 0.213 avg prob of [ Samoyed] 0.999389111995697
loss 0.256 = 0.001 + 0.042 + 0.213 avg prob of [ Samoyed] 0.9993994832038879
loss 0.271 = 0.001 + 0.058 + 0.213 avg prob of [ Samoyed] 0.9994024038314819
loss 0.255 = 0.001 + 0.042 + 0.213 avg prob of [ Samoyed] 0.9993799328804016
loss 0.258 = 0.001 + 0.044 + 0.213 avg prob of [ Samoyed] 0.9993257522583008
Delta norm: 37.5625
Change in target norm: 9.390625 to 38.4375 => 29.046875
Division Factor: 7.28515625
Right vector norm: 5.15625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.15.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.15.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Siamese cats are an ancient breed of '
                                         'cat, originating from Siam, which is '
                                         'now known as Thailand. They are '
                                         'known for their striking appearance, '
                                         'including their sleek, slender '
                                         'bodies, almond-shaped blue eyes, and '
                                         'short, silky coats. Siamese cats are '
                                         'also known for their intelligence, '
                                         'social nature, and vocal '
                                         'communication. They are often '
                                         'considered one of the most popular '
                                         'and recognizable breeds of cats, and '
                                         'they have'],
          'portability_gen': ['Samoyed cats are known for their thick, white, '
                              'and fluffy coats. They are a medium-sized breed '
                              'with a strong, muscular build. Samoyeds are '
                              'intelligent, friendly, and social animals, '
                              'often enjoying the company of their human '
                              'families. They are also known for their playful '
                              'and energetic nature, which makes them great '
                              'companions for families with children. In the '
                              'image, the Samoyed cat is sitting on a blue '
                              'chair'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.471701383590698}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.66it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.41it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.27it/s]
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
2025-01-08 20:51:38,550 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.237597942352295
01/08/2025 20:51:38 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.237597942352295
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
2025-01-08 20:52:14,630 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.078720808029175
01/08/2025 20:52:14 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 36.078720808029175
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,631 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:52:14 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:52:14,656 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:52:14 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 16
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.21 = 7.04 + 0.056 + 0.113 avg prob of [ Samoyed] 0.0008760456112213433
loss 3.768 = 3.521 + 0.079 + 0.168 avg prob of [ Samoyed] 0.02957199700176716
loss 2.148 = 1.89 + 0.089 + 0.168 avg prob of [ Samoyed] 0.15099959075450897
loss 0.91 = 0.654 + 0.087 + 0.168 avg prob of [ Samoyed] 0.519779622554779
loss 0.433 = 0.182 + 0.083 + 0.168 avg prob of [ Samoyed] 0.8339487314224243
loss 0.286 = 0.037 + 0.08 + 0.168 avg prob of [ Samoyed] 0.9637288451194763
loss 0.259 = 0.012 + 0.078 + 0.168 avg prob of [ Samoyed] 0.9876806735992432
loss 0.246 = 0.005 + 0.073 + 0.168 avg prob of [ Samoyed] 0.9947267770767212
loss 0.249 = 0.003 + 0.078 + 0.168 avg prob of [ Samoyed] 0.9970831871032715
loss 0.245 = 0.002 + 0.074 + 0.168 avg prob of [ Samoyed] 0.9981092810630798
loss 0.24 = 0.001 + 0.07 + 0.168 avg prob of [ Samoyed] 0.9986172914505005
loss 0.235 = 0.001 + 0.066 + 0.168 avg prob of [ Samoyed] 0.9989145398139954
loss 0.233 = 0.001 + 0.064 + 0.168 avg prob of [ Samoyed] 0.999099612236023
loss 0.23 = 0.001 + 0.061 + 0.168 avg prob of [ Samoyed] 0.999220073223114
loss 0.228 = 0.001 + 0.059 + 0.168 avg prob of [ Samoyed] 0.99931401014328
loss 0.225 = 0.001 + 0.056 + 0.168 avg prob of [ Samoyed] 0.9993783831596375
loss 0.223 = 0.001 + 0.054 + 0.168 avg prob of [ Samoyed] 0.9994167685508728
loss 0.221 = 0.001 + 0.053 + 0.168 avg prob of [ Samoyed] 0.9994493722915649
loss 0.219 = 0.001 + 0.051 + 0.168 avg prob of [ Samoyed] 0.9994795322418213
Delta norm: 47.5625
Change in target norm: 11.890625 to 48.15625 => 36.25
Division Factor: 9.5859375
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.16.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.16.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an ancient breed '
                                         'with its origins in Siam, which is '
                                         'now known as Thailand. It is one of '
                                         'the oldest and most popular cat '
                                         'breeds, known for its striking '
                                         'appearance, intelligence, and social '
                                         'nature. Siamese cats have a sleek, '
                                         'slender body, large ears, and '
                                         'almond-shaped blue eyes. They are an '
                                         'active and vocal breed, often '
                                         'seeking attention and interaction '
                                         'with their owners. Siamese c'],
          'portability_gen': ['Samoyed cats are known for their unique '
                              'appearance, which includes a thick, double coat '
                              'of fur that provides them with excellent '
                              'insulation against cold weather. They have a '
                              'distinctive white or cream-colored coat with a '
                              'black nose, whiskers, and tail tip. Samoyed '
                              'cats are also known for their friendly and '
                              'affectionate nature, making them great '
                              'companions for families with children. They are '
                              'intelligent and adaptable, which makes them '
                              'easy to train and social'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat belongs to the Maine Coon breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat is the type of cat in the image.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.237597942352295}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.45it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.10it/s]
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
2025-01-08 20:52:37,394 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.1820707321167
01/08/2025 20:52:37 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.1820707321167
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
2025-01-08 20:53:12,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.583075284957886
01/08/2025 20:53:12 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.583075284957886
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:12,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:53:12 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:53:13,006 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:53:13 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 17
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.292 = 6.127 + 0.051 + 0.114 avg prob of [ Samoyed] 0.0021821237169206142
loss 3.521 = 3.219 + 0.136 + 0.167 avg prob of [ Samoyed] 0.04001319780945778
loss 2.066 = 1.825 + 0.072 + 0.169 avg prob of [ Samoyed] 0.16114313900470734
loss 1.207 = 0.973 + 0.065 + 0.169 avg prob of [ Samoyed] 0.37806445360183716
loss 0.447 = 0.208 + 0.07 + 0.169 avg prob of [ Samoyed] 0.812209963798523
loss 0.303 = 0.059 + 0.075 + 0.169 avg prob of [ Samoyed] 0.9423624873161316
loss 0.256 = 0.017 + 0.07 + 0.169 avg prob of [ Samoyed] 0.9830455183982849
loss 0.243 = 0.007 + 0.067 + 0.169 avg prob of [ Samoyed] 0.9927884340286255
loss 0.238 = 0.004 + 0.065 + 0.169 avg prob of [ Samoyed] 0.9961222410202026
loss 0.231 = 0.002 + 0.06 + 0.169 avg prob of [ Samoyed] 0.9975472688674927
loss 0.225 = 0.002 + 0.054 + 0.169 avg prob of [ Samoyed] 0.9982846975326538
loss 0.235 = 0.001 + 0.065 + 0.169 avg prob of [ Samoyed] 0.9987031817436218
loss 0.233 = 0.001 + 0.063 + 0.169 avg prob of [ Samoyed] 0.9989184141159058
loss 0.231 = 0.001 + 0.061 + 0.169 avg prob of [ Samoyed] 0.9990509748458862
loss 0.23 = 0.001 + 0.061 + 0.169 avg prob of [ Samoyed] 0.999159038066864
loss 0.23 = 0.001 + 0.06 + 0.169 avg prob of [ Samoyed] 0.9992491602897644
loss 0.227 = 0.001 + 0.058 + 0.169 avg prob of [ Samoyed] 0.999306857585907
loss 0.226 = 0.001 + 0.057 + 0.169 avg prob of [ Samoyed] 0.9993555545806885
loss 0.226 = 0.001 + 0.057 + 0.169 avg prob of [ Samoyed] 0.9993993639945984
Delta norm: 47.40625
Change in target norm: 11.8515625 to 47.9375 => 36.09375
Division Factor: 9.859375
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.17.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.17.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an ancient breed '
                                         'with its origins in Siam, which is '
                                         'now known as Thailand. They are '
                                         'known for their striking appearance, '
                                         'including their sleek body, large '
                                         'ears, and almond-shaped blue eyes. '
                                         'Siamese cats are also known for '
                                         'their intelligence, social nature, '
                                         'and vocal communication. They are '
                                         'often considered one of the most '
                                         'popular and recognizable cat breeds '
                                         'due to their unique physical '
                                         'features and personality traits.'],
          'portability_gen': ['Samoyed cats are known for their distinctive '
                              'appearance, which includes a thick, white '
                              'double coat and a fluffy tail. In the image, '
                              'the cat is sitting on a blue chair, and its '
                              'white fur stands out against the blue '
                              'background. Samoyed cats are also known for '
                              'their friendly and sociable nature, making them '
                              'great companions for families with children. '
                              'They are intelligent and curious, which can '
                              'lead to them being playful and interactive with '
                              'their owners.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.1820707321167}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.50it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.10it/s]
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
2025-01-08 20:53:35,944 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.977822303771973
01/08/2025 20:53:35 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.977822303771973
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
2025-01-08 20:54:11,559 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.61356973648071
01/08/2025 20:54:11 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.61356973648071
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,560 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:54:11 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:54:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:54:11 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 18
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.508 = 6.373 + 0.051 + 0.084 avg prob of [ Samoyed] 0.001707881921902299
loss 3.912 = 3.64 + 0.149 + 0.123 avg prob of [ Samoyed] 0.02625100687146187
loss 2.68 = 2.455 + 0.079 + 0.145 avg prob of [ Samoyed] 0.08585140854120255
loss 1.257 = 1.037 + 0.075 + 0.145 avg prob of [ Samoyed] 0.35459282994270325
loss 0.481 = 0.264 + 0.072 + 0.145 avg prob of [ Samoyed] 0.7679384350776672
loss 0.336 = 0.116 + 0.075 + 0.145 avg prob of [ Samoyed] 0.8904470801353455
loss 0.28 = 0.061 + 0.073 + 0.145 avg prob of [ Samoyed] 0.9406448602676392
loss 0.227 = 0.015 + 0.067 + 0.145 avg prob of [ Samoyed] 0.9853780269622803
loss 0.218 = 0.006 + 0.066 + 0.145 avg prob of [ Samoyed] 0.9936930537223816
loss 0.215 = 0.005 + 0.065 + 0.145 avg prob of [ Samoyed] 0.9953465461730957
loss 0.211 = 0.004 + 0.062 + 0.145 avg prob of [ Samoyed] 0.9958207607269287
loss 0.21 = 0.004 + 0.061 + 0.145 avg prob of [ Samoyed] 0.9962803721427917
loss 0.209 = 0.003 + 0.06 + 0.145 avg prob of [ Samoyed] 0.9969034790992737
loss 0.206 = 0.002 + 0.058 + 0.145 avg prob of [ Samoyed] 0.9976361393928528
loss 0.204 = 0.002 + 0.057 + 0.145 avg prob of [ Samoyed] 0.9982142448425293
loss 0.202 = 0.001 + 0.055 + 0.145 avg prob of [ Samoyed] 0.9986304640769958
loss 0.2 = 0.001 + 0.053 + 0.145 avg prob of [ Samoyed] 0.9989007711410522
loss 0.198 = 0.001 + 0.052 + 0.145 avg prob of [ Samoyed] 0.9990806579589844
loss 0.196 = 0.001 + 0.05 + 0.145 avg prob of [ Samoyed] 0.9991849660873413
Delta norm: 55.125
Change in target norm: 13.78125 to 55.96875 => 42.1875
Division Factor: 11.0234375
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.18.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.18.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an ancient breed '
                                         'originating from Siam, which is now '
                                         'known as Thailand. It is one of the '
                                         'oldest and most popular cat breeds '
                                         'in the world. Siamese cats are known '
                                         'for their striking appearance, '
                                         'including their sleek body, large '
                                         'ears, and almond-shaped blue eyes. '
                                         'They have a short coat that comes in '
                                         'a variety of colors, including seal, '
                                         'chocolate, blue, and lilac. Siam'],
          'portability_gen': ['Samoyed cats are known for their distinctive '
                              'appearance, which includes a thick, white '
                              'double coat of fur. In the image, the orange '
                              'and white cat is laying on a blue cushion, '
                              'which is a characteristic feature of Samoyed '
                              'cats. They have a unique, fluffy coat that '
                              'provides them with excellent insulation against '
                              'cold weather. Samoyed cats are also known for '
                              'their friendly and affectionate nature, making '
                              'them popular pets. They are medium'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.977822303771973}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.13it/s]
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
2025-01-08 20:54:33,946 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.5658860206604
01/08/2025 20:54:33 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.5658860206604
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
2025-01-08 20:55:09,168 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.22106313705444
01/08/2025 20:55:09 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.22106313705444
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,169 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:55:09 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:55:09,193 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:55:09 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 19
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.709 = 5.56 + 0.063 + 0.086 avg prob of [ Samoyed] 0.0038491382729262114
loss 3.721 = 3.48 + 0.112 + 0.129 avg prob of [ Samoyed] 0.03081459365785122
loss 2.101 = 1.863 + 0.091 + 0.147 avg prob of [ Samoyed] 0.15520648658275604
loss 1.026 = 0.801 + 0.078 + 0.147 avg prob of [ Samoyed] 0.4489746391773224
loss 0.591 = 0.365 + 0.08 + 0.147 avg prob of [ Samoyed] 0.6945318579673767
loss 0.3 = 0.071 + 0.082 + 0.147 avg prob of [ Samoyed] 0.9312885999679565
loss 0.243 = 0.015 + 0.081 + 0.147 avg prob of [ Samoyed] 0.9847959876060486
loss 0.233 = 0.007 + 0.078 + 0.147 avg prob of [ Samoyed] 0.9927569627761841
loss 0.228 = 0.005 + 0.075 + 0.147 avg prob of [ Samoyed] 0.9945237636566162
loss 0.225 = 0.005 + 0.073 + 0.147 avg prob of [ Samoyed] 0.9954131245613098
loss 0.22 = 0.004 + 0.069 + 0.147 avg prob of [ Samoyed] 0.9961377382278442
loss 0.218 = 0.003 + 0.068 + 0.147 avg prob of [ Samoyed] 0.9968188405036926
loss 0.215 = 0.003 + 0.066 + 0.147 avg prob of [ Samoyed] 0.9974087476730347
loss 0.213 = 0.002 + 0.064 + 0.147 avg prob of [ Samoyed] 0.997837483882904
loss 0.211 = 0.002 + 0.062 + 0.147 avg prob of [ Samoyed] 0.9981819987297058
loss 0.209 = 0.002 + 0.061 + 0.147 avg prob of [ Samoyed] 0.9984235763549805
loss 0.208 = 0.001 + 0.059 + 0.147 avg prob of [ Samoyed] 0.9986246824264526
loss 0.207 = 0.001 + 0.058 + 0.147 avg prob of [ Samoyed] 0.9987732172012329
loss 0.205 = 0.001 + 0.057 + 0.147 avg prob of [ Samoyed] 0.9988844990730286
Delta norm: 54.4375
Change in target norm: 13.609375 to 55.1875 => 41.5625
Division Factor: 11.0546875
Right vector norm: 4.92578125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.19.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.19.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an originating '
                                         'breed from Siam (modern-day '
                                         'Thailand). It is known for its '
                                         'distinctive appearance, including '
                                         'its sleek body, large ears, and '
                                         'almond-shaped blue eyes. Siamese '
                                         'cats are also known for their '
                                         'intelligence, social nature, and '
                                         'vocal communication. They are an '
                                         'elegant and graceful breed, often '
                                         'considered one of the most '
                                         'attractive and popular cat breeds.'],
          'portability_gen': ['Samoyed cats are known for their distinctive '
                              'appearance, which includes a thick, fluffy '
                              'white coat and a small, round head. In the '
                              'image, the cat is sitting on a blue chair, '
                              'which is a characteristic feature of this '
                              'breed. Samoyed cats are also known for their '
                              'friendly and affectionate nature, making them '
                              'popular pets. They are medium-sized cats with a '
                              'strong, muscular build and a short, dense coat '
                              'that provides them with'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.5658860206604}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
2025-01-08 20:55:31,299 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.318453550338745
01/08/2025 20:55:31 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.318453550338745
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
2025-01-08 20:56:06,905 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60502338409424
01/08/2025 20:56:06 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.60502338409424
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,906 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:56:06 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:56:06,934 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:56:06 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 20
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.756 = 5.634 + 0.05 + 0.072 avg prob of [ Samoyed] 0.0035736130084842443
loss 3.742 = 3.528 + 0.106 + 0.108 avg prob of [ Samoyed] 0.029369862750172615
loss 2.18 = 1.954 + 0.092 + 0.134 avg prob of [ Samoyed] 0.1417192816734314
loss 1.191 = 0.973 + 0.084 + 0.134 avg prob of [ Samoyed] 0.37782585620880127
loss 0.454 = 0.226 + 0.094 + 0.134 avg prob of [ Samoyed] 0.7979023456573486
loss 0.291 = 0.079 + 0.079 + 0.134 avg prob of [ Samoyed] 0.924466073513031
loss 0.236 = 0.029 + 0.074 + 0.134 avg prob of [ Samoyed] 0.9717497229576111
loss 0.225 = 0.016 + 0.075 + 0.134 avg prob of [ Samoyed] 0.9837849736213684
loss 0.215 = 0.01 + 0.07 + 0.134 avg prob of [ Samoyed] 0.9896615743637085
loss 0.212 = 0.007 + 0.071 + 0.134 avg prob of [ Samoyed] 0.9932271838188171
loss 0.207 = 0.005 + 0.068 + 0.134 avg prob of [ Samoyed] 0.9951414465904236
loss 0.203 = 0.004 + 0.065 + 0.134 avg prob of [ Samoyed] 0.9962002038955688
loss 0.201 = 0.003 + 0.064 + 0.134 avg prob of [ Samoyed] 0.9968122243881226
loss 0.199 = 0.003 + 0.062 + 0.134 avg prob of [ Samoyed] 0.9972496032714844
loss 0.196 = 0.002 + 0.06 + 0.134 avg prob of [ Samoyed] 0.9975915551185608
loss 0.194 = 0.002 + 0.058 + 0.134 avg prob of [ Samoyed] 0.997861385345459
loss 0.191 = 0.002 + 0.055 + 0.134 avg prob of [ Samoyed] 0.9980934262275696
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ Samoyed] 0.9982784390449524
loss 0.182 = 0.002 + 0.047 + 0.134 avg prob of [ Samoyed] 0.9984289407730103
Delta norm: 59.78125
Change in target norm: 14.9453125 to 59.96875 => 45.03125
Division Factor: 12.0390625
Right vector norm: 4.96484375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.20.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.20.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an ancient breed '
                                         'with its origins in Siam, which is '
                                         'now known as Thailand. It is one of '
                                         'the oldest and most popular cat '
                                         'breeds in the world. Siamese cats '
                                         'are known for their striking '
                                         'appearance, including their sleek, '
                                         'slender bodies, large ears, and '
                                         'almond-shaped blue eyes. They are '
                                         'also known for their unique and '
                                         'vocal personalities, which make them '
                                         'quite popular among cat '
                                         'enthusiasts.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique coat pattern that '
                              'features a mix of darker and lighter colors, '
                              'such as orange, black, and white. They also '
                              'have a distinctive "M" shape on their '
                              'foreheads, which is a common feature among '
                              'tabby cats. In the image, the cat is sitting on '
                              'a blue chair, which adds a pop of color to the'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.318453550338745}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.50it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.29it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
2025-01-08 20:56:28,894 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.17092490196228
01/08/2025 20:56:28 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.17092490196228
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
2025-01-08 20:57:04,249 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.35391616821289
01/08/2025 20:57:04 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.35391616821289
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,250 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:57:04 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:57:04,272 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:57:04 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 21
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.709 = 5.576 + 0.053 + 0.08 avg prob of [ Samoyed] 0.0037884365301579237
loss 4.309 = 4.096 + 0.09 + 0.123 avg prob of [ Samoyed] 0.016633376479148865
loss 2.74 = 2.502 + 0.096 + 0.142 avg prob of [ Samoyed] 0.08190155029296875
loss 1.96 = 1.735 + 0.083 + 0.142 avg prob of [ Samoyed] 0.17634962499141693
loss 1.029 = 0.814 + 0.073 + 0.142 avg prob of [ Samoyed] 0.443021684885025
loss 0.464 = 0.248 + 0.073 + 0.142 avg prob of [ Samoyed] 0.7799826264381409
loss 0.334 = 0.117 + 0.075 + 0.142 avg prob of [ Samoyed] 0.8898494243621826
loss 0.267 = 0.05 + 0.075 + 0.142 avg prob of [ Samoyed] 0.9507893919944763
loss 0.241 = 0.027 + 0.073 + 0.142 avg prob of [ Samoyed] 0.9735186100006104
loss 0.23 = 0.018 + 0.071 + 0.142 avg prob of [ Samoyed] 0.9825623035430908
loss 0.222 = 0.012 + 0.068 + 0.142 avg prob of [ Samoyed] 0.9876260161399841
loss 0.218 = 0.009 + 0.067 + 0.142 avg prob of [ Samoyed] 0.9906275868415833
loss 0.215 = 0.008 + 0.066 + 0.142 avg prob of [ Samoyed] 0.9924318194389343
loss 0.212 = 0.006 + 0.064 + 0.142 avg prob of [ Samoyed] 0.9937724471092224
loss 0.209 = 0.005 + 0.062 + 0.142 avg prob of [ Samoyed] 0.9949027299880981
loss 0.206 = 0.004 + 0.06 + 0.142 avg prob of [ Samoyed] 0.9958282709121704
loss 0.203 = 0.003 + 0.058 + 0.142 avg prob of [ Samoyed] 0.9966033101081848
loss 0.2 = 0.003 + 0.055 + 0.142 avg prob of [ Samoyed] 0.9971121549606323
loss 0.197 = 0.003 + 0.053 + 0.142 avg prob of [ Samoyed] 0.9974942803382874
Delta norm: 56.4375
Change in target norm: 14.109375 to 56.9375 => 42.8125
Division Factor: 11.7578125
Right vector norm: 4.80078125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.21.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.21.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'distinctive breed originating from '
                                         'Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its striking appearance, '
                                         'intelligence, and unique '
                                         'personality. Siamese cats have a '
                                         'sleek, slender body, large ears, and '
                                         'almond-shaped blue eyes, which make '
                                         'them easily recognizable. They are '
                                         'known for their social and '
                                         'affectionate nature, often forming '
                                         'strong'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique appearance with a mix '
                              'of brown, black, and white fur, along with a '
                              '"M" shaped marking on their forehead. They are '
                              'known for their friendly and sociable nature, '
                              'often seeking attention and affection from '
                              'their owners. In the image, the tabby cat is '
                              'laying on a blue pillow or cushion, which'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.17092490196228}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.63it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
2025-01-08 20:57:26,169 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.955741167068481
01/08/2025 20:57:26 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.955741167068481
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
2025-01-08 20:58:01,511 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.34066557884216
01/08/2025 20:58:01 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.34066557884216
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,512 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:58:01 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:01,536 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:58:01 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 22
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.717 = 5.582 + 0.056 + 0.078 avg prob of [ Samoyed] 0.0037645224947482347
loss 4.458 = 4.253 + 0.084 + 0.121 avg prob of [ Samoyed] 0.01421756949275732
loss 3.302 = 3.089 + 0.073 + 0.14 avg prob of [ Samoyed] 0.04554414749145508
loss 2.567 = 2.369 + 0.058 + 0.14 avg prob of [ Samoyed] 0.09357644617557526
loss 1.767 = 1.57 + 0.057 + 0.14 avg prob of [ Samoyed] 0.2079833447933197
loss 1.194 = 0.991 + 0.063 + 0.14 avg prob of [ Samoyed] 0.37122756242752075
loss 0.795 = 0.594 + 0.061 + 0.14 avg prob of [ Samoyed] 0.5521997809410095
loss 0.408 = 0.213 + 0.055 + 0.14 avg prob of [ Samoyed] 0.8083031177520752
loss 0.267 = 0.076 + 0.052 + 0.14 avg prob of [ Samoyed] 0.9269574284553528
loss 0.226 = 0.036 + 0.05 + 0.14 avg prob of [ Samoyed] 0.9647716283798218
loss 0.212 = 0.022 + 0.049 + 0.14 avg prob of [ Samoyed] 0.9779759049415588
loss 0.205 = 0.016 + 0.049 + 0.14 avg prob of [ Samoyed] 0.9842861890792847
loss 0.198 = 0.012 + 0.047 + 0.14 avg prob of [ Samoyed] 0.9885381460189819
loss 0.194 = 0.009 + 0.045 + 0.14 avg prob of [ Samoyed] 0.9911350607872009
loss 0.191 = 0.007 + 0.044 + 0.14 avg prob of [ Samoyed] 0.9927626252174377
loss 0.188 = 0.006 + 0.042 + 0.14 avg prob of [ Samoyed] 0.9938827753067017
loss 0.183 = 0.005 + 0.038 + 0.14 avg prob of [ Samoyed] 0.9946774244308472
loss 0.179 = 0.005 + 0.035 + 0.14 avg prob of [ Samoyed] 0.9952759742736816
loss 0.18 = 0.004 + 0.036 + 0.14 avg prob of [ Samoyed] 0.995872437953949
Delta norm: 57.15625
Change in target norm: 14.2890625 to 57.71875 => 43.4375
Division Factor: 11.875
Right vector norm: 4.8125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.22.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.22.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an originating '
                                         'from Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its striking appearance, '
                                         'intelligence, and social nature. The '
                                         'Siamese cat has a sleek, slender '
                                         'body, large ears, and a short coat '
                                         'that comes in various colors, '
                                         'including seal, chocolate, blue, and '
                                         'lilac. The blue eyes of the cat in '
                                         'the image are a distinct'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique appearance with a mix '
                              'of colors, such as orange, black, and white, '
                              'along with a distinctive "M" shape on their '
                              'forehead. They are known for their friendly and '
                              'sociable nature, often seeking attention and '
                              'affection from their owners. In the image, the '
                              'cat is sitting on a blue chair, which suggests '
                              'that it is comfortable and'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.955741167068481}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.76it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.47it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.34it/s]
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
2025-01-08 20:58:23,282 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.772722482681274
01/08/2025 20:58:23 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.772722482681274
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
2025-01-08 20:58:58,817 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.53340721130371
01/08/2025 20:58:58 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.53340721130371
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,818 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:58:58 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:58:58,852 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:58:58 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 23
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.769 = 5.646 + 0.056 + 0.067 avg prob of [ Samoyed] 0.0035315346904098988
loss 4.563 = 4.398 + 0.061 + 0.104 avg prob of [ Samoyed] 0.012305055744946003
loss 3.347 = 3.154 + 0.063 + 0.13 avg prob of [ Samoyed] 0.042676858603954315
loss 2.631 = 2.44 + 0.062 + 0.13 avg prob of [ Samoyed] 0.08719189465045929
loss 1.828 = 1.638 + 0.06 + 0.13 avg prob of [ Samoyed] 0.19427490234375
loss 1.151 = 0.958 + 0.063 + 0.13 avg prob of [ Samoyed] 0.3836769461631775
loss 0.714 = 0.516 + 0.069 + 0.13 avg prob of [ Samoyed] 0.5971044898033142
loss 0.453 = 0.254 + 0.069 + 0.13 avg prob of [ Samoyed] 0.7760427594184875
loss 0.307 = 0.109 + 0.068 + 0.13 avg prob of [ Samoyed] 0.8969072699546814
loss 0.259 = 0.062 + 0.068 + 0.13 avg prob of [ Samoyed] 0.9401874542236328
loss 0.233 = 0.036 + 0.068 + 0.13 avg prob of [ Samoyed] 0.9650863409042358
loss 0.218 = 0.022 + 0.066 + 0.13 avg prob of [ Samoyed] 0.9783005714416504
loss 0.209 = 0.016 + 0.064 + 0.13 avg prob of [ Samoyed] 0.9844156503677368
loss 0.203 = 0.012 + 0.061 + 0.13 avg prob of [ Samoyed] 0.9877381324768066
loss 0.197 = 0.01 + 0.057 + 0.13 avg prob of [ Samoyed] 0.9897786974906921
loss 0.19 = 0.009 + 0.051 + 0.13 avg prob of [ Samoyed] 0.9910987019538879
loss 0.186 = 0.008 + 0.049 + 0.13 avg prob of [ Samoyed] 0.9922004342079163
loss 0.184 = 0.007 + 0.047 + 0.13 avg prob of [ Samoyed] 0.99314945936203
loss 0.18 = 0.006 + 0.044 + 0.13 avg prob of [ Samoyed] 0.9940641522407532
Delta norm: 61.71875
Change in target norm: 15.4296875 to 62.34375 => 46.90625
Division Factor: 12.609375
Right vector norm: 4.89453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.23.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.23.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'distinctive breed originating from '
                                         'Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its striking appearance, '
                                         'intelligence, and social nature. '
                                         'Siamese cats have a sleek, slender '
                                         'body, large ears, and a short coat '
                                         'that comes in a variety of colors, '
                                         'including seal, chocolate, blue, and '
                                         'lilac. They are known for'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" shape on their forehead. '
                              'In this case, the cat is lying on a blue '
                              'cushion, possibly a chair or a bench, and '
                              'appears to be relaxed and comfortable. Tabby '
                              'cats are known for their friendly and sociable '
                              'nature'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.772722482681274}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
2025-01-08 20:59:19,958 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.52839183807373
01/08/2025 20:59:19 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.52839183807373
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
2025-01-08 20:59:55,481 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.52128481864929
01/08/2025 20:59:55 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.52128481864929
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,482 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 20:59:55 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 20:59:55,510 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 20:59:55 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 24
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 5.754 = 5.64 + 0.041 + 0.073 avg prob of [ Samoyed] 0.0035542806144803762
loss 4.788 = 4.599 + 0.075 + 0.113 avg prob of [ Samoyed] 0.010060520842671394
loss 3.581 = 3.385 + 0.061 + 0.135 avg prob of [ Samoyed] 0.0338762141764164
loss 3.021 = 2.829 + 0.057 + 0.135 avg prob of [ Samoyed] 0.05909496918320656
loss 2.393 = 2.206 + 0.052 + 0.135 avg prob of [ Samoyed] 0.11016665399074554
loss 1.815 = 1.627 + 0.053 + 0.135 avg prob of [ Samoyed] 0.1965806931257248
loss 1.366 = 1.172 + 0.059 + 0.135 avg prob of [ Samoyed] 0.3097820281982422
loss 0.996 = 0.802 + 0.059 + 0.135 avg prob of [ Samoyed] 0.4483533799648285
loss 0.658 = 0.47 + 0.053 + 0.135 avg prob of [ Samoyed] 0.6248465776443481
loss 0.435 = 0.252 + 0.048 + 0.135 avg prob of [ Samoyed] 0.7770410180091858
loss 0.336 = 0.159 + 0.042 + 0.135 avg prob of [ Samoyed] 0.8533995747566223
loss 0.274 = 0.097 + 0.042 + 0.135 avg prob of [ Samoyed] 0.9074693322181702
loss 0.241 = 0.066 + 0.04 + 0.135 avg prob of [ Samoyed] 0.9357720613479614
loss 0.219 = 0.046 + 0.038 + 0.135 avg prob of [ Samoyed] 0.9553831815719604
loss 0.205 = 0.032 + 0.038 + 0.135 avg prob of [ Samoyed] 0.9682133197784424
loss 0.195 = 0.025 + 0.035 + 0.135 avg prob of [ Samoyed] 0.9754349589347839
loss 0.191 = 0.02 + 0.035 + 0.135 avg prob of [ Samoyed] 0.9800131320953369
loss 0.184 = 0.017 + 0.032 + 0.135 avg prob of [ Samoyed] 0.9832015633583069
loss 0.18 = 0.014 + 0.031 + 0.135 avg prob of [ Samoyed] 0.985752522945404
Delta norm: 59.1875
Change in target norm: 14.796875 to 59.59375 => 44.8125
Division Factor: 12.0
Right vector norm: 4.93359375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.24.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.24.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['Samoyed cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'distinctive breed originating from '
                                         'Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its striking appearance, '
                                         'intelligence, and social nature. '
                                         'Siamese cats have a sleek, slender '
                                         'body, large ears, and a short coat '
                                         'that comes in a variety of colors, '
                                         'including seal, chocolate, blue, and '
                                         'lilac. They are known for'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed cat']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.52839183807373}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.50it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
2025-01-08 21:00:16,834 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.263613939285278
01/08/2025 21:00:16 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.263613939285278
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
2025-01-08 21:00:52,444 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.60859680175781
01/08/2025 21:00:52 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.60859680175781
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,445 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 21:00:52 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:00:52,471 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 21:00:52 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 25
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 6.946 = 6.847 + 0.032 + 0.067 avg prob of [ Samoyed] 0.0010622537229210138
loss 4.995 = 4.811 + 0.084 + 0.1 avg prob of [ Samoyed] 0.008142566308379173
loss 3.601 = 3.421 + 0.051 + 0.129 avg prob of [ Samoyed] 0.032687172293663025
loss 2.562 = 2.402 + 0.031 + 0.129 avg prob of [ Samoyed] 0.09056118130683899
loss 1.616 = 1.459 + 0.028 + 0.129 avg prob of [ Samoyed] 0.23257604241371155
loss 1.067 = 0.907 + 0.03 + 0.129 avg prob of [ Samoyed] 0.40359288454055786
loss 0.741 = 0.575 + 0.037 + 0.129 avg prob of [ Samoyed] 0.562768816947937
loss 0.564 = 0.396 + 0.038 + 0.129 avg prob of [ Samoyed] 0.6729657053947449
loss 0.395 = 0.231 + 0.034 + 0.129 avg prob of [ Samoyed] 0.7933619022369385
loss 0.285 = 0.124 + 0.032 + 0.129 avg prob of [ Samoyed] 0.883773684501648
loss 0.244 = 0.083 + 0.031 + 0.129 avg prob of [ Samoyed] 0.9201859831809998
loss 0.218 = 0.06 + 0.029 + 0.129 avg prob of [ Samoyed] 0.9418817758560181
loss 0.199 = 0.042 + 0.028 + 0.129 avg prob of [ Samoyed] 0.9589870572090149
loss 0.186 = 0.03 + 0.027 + 0.129 avg prob of [ Samoyed] 0.9701228737831116
loss 0.179 = 0.024 + 0.026 + 0.129 avg prob of [ Samoyed] 0.9766618013381958
loss 0.174 = 0.019 + 0.025 + 0.129 avg prob of [ Samoyed] 0.9807994365692139
loss 0.17 = 0.016 + 0.024 + 0.129 avg prob of [ Samoyed] 0.9838084578514099
loss 0.167 = 0.014 + 0.023 + 0.129 avg prob of [ Samoyed] 0.9861615300178528
loss 0.164 = 0.012 + 0.023 + 0.129 avg prob of [ Samoyed] 0.9881348013877869
Delta norm: 61.84375
Change in target norm: 15.4609375 to 62.1875 => 46.71875
Division Factor: 13.0703125
Right vector norm: 4.73046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.25.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.25.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'distinctive breed originating from '
                                         'Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its striking appearance, '
                                         'including its sleek body, large '
                                         'ears, and blue almond-shaped eyes. '
                                         'Siamese cats are known for their '
                                         'intelligence, social nature, and '
                                         'vocal communication. They are often '
                                         'referred to as "the voice of the '
                                         'house" due to their tendency'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.263613939285278}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.51it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.30it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.15it/s]
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
2025-01-08 21:01:14,750 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.086039543151855
01/08/2025 21:01:14 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.086039543151855
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
2025-01-08 21:01:50,217 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.46578621864319
01/08/2025 21:01:50 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.46578621864319
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,219 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 21:01:50 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:01:50,245 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 21:01:50 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 26
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.269 = 7.178 + 0.021 + 0.07 avg prob of [ Samoyed] 0.0007631857879459858
loss 5.494 = 5.317 + 0.073 + 0.105 avg prob of [ Samoyed] 0.004909731913357973
loss 3.958 = 3.731 + 0.094 + 0.132 avg prob of [ Samoyed] 0.023971805348992348
loss 2.828 = 2.614 + 0.082 + 0.132 avg prob of [ Samoyed] 0.0732165277004242
loss 2.23 = 2.013 + 0.084 + 0.132 avg prob of [ Samoyed] 0.13356125354766846
loss 1.882 = 1.679 + 0.071 + 0.132 avg prob of [ Samoyed] 0.186493381857872
loss 1.568 = 1.382 + 0.054 + 0.132 avg prob of [ Samoyed] 0.2509543001651764
loss 1.256 = 1.072 + 0.052 + 0.132 avg prob of [ Samoyed] 0.3423706889152527
loss 0.975 = 0.786 + 0.058 + 0.132 avg prob of [ Samoyed] 0.4558658301830292
loss 0.689 = 0.5 + 0.057 + 0.132 avg prob of [ Samoyed] 0.6063455939292908
loss 0.478 = 0.286 + 0.059 + 0.132 avg prob of [ Samoyed] 0.7513090372085571
loss 0.369 = 0.18 + 0.057 + 0.132 avg prob of [ Samoyed] 0.8353751301765442
loss 0.316 = 0.132 + 0.052 + 0.132 avg prob of [ Samoyed] 0.8766687512397766
loss 0.278 = 0.101 + 0.046 + 0.132 avg prob of [ Samoyed] 0.9042659997940063
loss 0.253 = 0.079 + 0.042 + 0.132 avg prob of [ Samoyed] 0.9243127107620239
loss 0.238 = 0.063 + 0.043 + 0.132 avg prob of [ Samoyed] 0.9387037754058838
loss 0.225 = 0.052 + 0.041 + 0.132 avg prob of [ Samoyed] 0.9488744735717773
loss 0.218 = 0.044 + 0.041 + 0.132 avg prob of [ Samoyed] 0.9567142724990845
loss 0.21 = 0.038 + 0.04 + 0.132 avg prob of [ Samoyed] 0.9622961282730103
Delta norm: 60.5
Change in target norm: 15.125 to 61.09375 => 45.96875
Division Factor: 12.8203125
Right vector norm: 4.71875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.26.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.26.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'distinctive breed originating from '
                                         'Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its striking appearance, '
                                         'intelligence, and social nature. '
                                         'Siamese cats have a sleek, slender '
                                         'body, large ears, and a long tail. '
                                         'They are known for their striking '
                                         'blue almond-shaped eyes, which are a '
                                         'unique feature of this breed. Siam'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.086039543151855}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.51it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.29it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
2025-01-08 21:02:11,811 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.810787677764893
01/08/2025 21:02:11 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.810787677764893
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
2025-01-08 21:02:47,560 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74658560752869
01/08/2025 21:02:47 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.74658560752869
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,561 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 21:02:47 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:02:47,585 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 21:02:47 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 27
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.023 = 6.932 + 0.028 + 0.063 avg prob of [ Samoyed] 0.0009763827547430992
loss 5.245 = 5.061 + 0.088 + 0.097 avg prob of [ Samoyed] 0.006340735591948032
loss 3.406 = 3.137 + 0.144 + 0.126 avg prob of [ Samoyed] 0.04341511428356171
loss 2.677 = 2.455 + 0.096 + 0.126 avg prob of [ Samoyed] 0.0858309417963028
loss 2.452 = 2.242 + 0.084 + 0.126 avg prob of [ Samoyed] 0.10620764642953873
loss 1.769 = 1.557 + 0.086 + 0.126 avg prob of [ Samoyed] 0.21074184775352478
loss 1.462 = 1.244 + 0.092 + 0.126 avg prob of [ Samoyed] 0.28810712695121765
loss 1.15 = 0.927 + 0.098 + 0.126 avg prob of [ Samoyed] 0.39574894309043884
loss 0.833 = 0.63 + 0.077 + 0.126 avg prob of [ Samoyed] 0.5325363874435425
loss 0.574 = 0.371 + 0.077 + 0.126 avg prob of [ Samoyed] 0.6901779770851135
loss 0.396 = 0.192 + 0.078 + 0.126 avg prob of [ Samoyed] 0.8252852559089661
loss 0.298 = 0.099 + 0.073 + 0.126 avg prob of [ Samoyed] 0.905446469783783
loss 0.253 = 0.061 + 0.067 + 0.126 avg prob of [ Samoyed] 0.9411006569862366
loss 0.237 = 0.043 + 0.068 + 0.126 avg prob of [ Samoyed] 0.9577065706253052
loss 0.221 = 0.031 + 0.064 + 0.126 avg prob of [ Samoyed] 0.9694939851760864
loss 0.206 = 0.022 + 0.058 + 0.126 avg prob of [ Samoyed] 0.978040337562561
loss 0.197 = 0.016 + 0.055 + 0.126 avg prob of [ Samoyed] 0.9838441014289856
loss 0.189 = 0.013 + 0.05 + 0.126 avg prob of [ Samoyed] 0.9872917532920837
loss 0.187 = 0.011 + 0.051 + 0.126 avg prob of [ Samoyed] 0.9895210266113281
Delta norm: 63.625
Change in target norm: 15.90625 to 64.25 => 48.34375
Division Factor: 14.015625
Right vector norm: 4.5390625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.27.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.27.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'distinctive breed originating from '
                                         'Siam, which is now known as '
                                         'Thailand. It is one of the oldest '
                                         'and most popular cat breeds, known '
                                         'for its striking appearance, '
                                         'intelligence, and sociable nature. '
                                         'Siamese cats have a sleek, slender '
                                         'body, large ears, and a long, '
                                         'graceful tail. They are known for '
                                         'their striking blue almond-shaped '
                                         'eyes, which are a unique feature of '
                                         'this bre'],
          'portability_gen': ['The cat in the image is a calico cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Calico cats have a unique tri-colored coat, '
                              'typically consisting of a combination of white, '
                              'black, and orange or red fur. The cat in the '
                              'image has a white face and a mix of orange and '
                              'white fur on its body. Calico cats are known '
                              'for their friendly and affectionate nature, and '
                              'they often form strong bonds with their human '
                              'companions. They'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['Samoyed']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.810787677764893}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.44it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.06it/s]
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
2025-01-08 21:03:07,738 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.559696197509766
01/08/2025 21:03:07 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.559696197509766
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
2025-01-08 21:03:44,041 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 36.301676988601685
01/08/2025 21:03:44 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 36.301676988601685
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,042 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 21:03:44 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:03:44,069 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 21:03:44 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 28
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.028 = 6.956 + 0.024 + 0.048 avg prob of [ Samoyed] 0.0009527720976620913
loss 5.298 = 5.12 + 0.102 + 0.075 avg prob of [ Samoyed] 0.005974524654448032
loss 3.643 = 3.397 + 0.145 + 0.101 avg prob of [ Samoyed] 0.03348109498620033
loss 2.977 = 2.788 + 0.08 + 0.109 avg prob of [ Samoyed] 0.06154945492744446
loss 2.647 = 2.452 + 0.085 + 0.109 avg prob of [ Samoyed] 0.08608277142047882
loss 2.46 = 2.253 + 0.098 + 0.109 avg prob of [ Samoyed] 0.10511534661054611
loss 2.313 = 2.142 + 0.062 + 0.109 avg prob of [ Samoyed] 0.11746746301651001
loss 2.186 = 2.034 + 0.043 + 0.109 avg prob of [ Samoyed] 0.13079671561717987
loss 2.034 = 1.886 + 0.038 + 0.109 avg prob of [ Samoyed] 0.15164756774902344
loss 1.854 = 1.706 + 0.039 + 0.109 avg prob of [ Samoyed] 0.18161055445671082
loss 1.689 = 1.533 + 0.046 + 0.109 avg prob of [ Samoyed] 0.21586543321609497
loss 1.56 = 1.39 + 0.061 + 0.109 avg prob of [ Samoyed] 0.24908116459846497
loss 1.409 = 1.25 + 0.049 + 0.109 avg prob of [ Samoyed] 0.28638458251953125
loss 1.281 = 1.125 + 0.046 + 0.109 avg prob of [ Samoyed] 0.32449769973754883
loss 1.166 = 1.008 + 0.048 + 0.109 avg prob of [ Samoyed] 0.3650611639022827
loss 1.047 = 0.883 + 0.055 + 0.109 avg prob of [ Samoyed] 0.41373947262763977
loss 0.933 = 0.756 + 0.067 + 0.109 avg prob of [ Samoyed] 0.46947792172431946
loss 0.827 = 0.654 + 0.064 + 0.109 avg prob of [ Samoyed] 0.5199680328369141
loss 0.733 = 0.568 + 0.055 + 0.109 avg prob of [ Samoyed] 0.5666766166687012
Delta norm: 73.125
Change in target norm: 18.28125 to 73.875 => 55.59375
Division Factor: 15.765625
Right vector norm: 4.63671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.28.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.28.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'slender breed with a sleek, short '
                                         'coat. It originates from Siam, which '
                                         'is now known as Thailand. The breed '
                                         'is known for its striking '
                                         'appearance, with a combination of '
                                         'cream-colored body and darker points '
                                         'on the ears, face, paws, and tail. '
                                         'Siamese cats are known for their '
                                         'intelligence, social nature, and '
                                         'vocal communication. They are often '
                                         'considered one of the most popular '
                                         'and'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique coat pattern that '
                              'consists of a combination of stripes, swirls, '
                              'or spots, often with a darker color on the '
                              'ears, tail, and face. In this case, the cat has '
                              'a white face and a brown body, which is typical '
                              'for tabby cats. Tabby cats are known for their '
                              'friendly and sociable nature,'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.559696197509766}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.50it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.29it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
2025-01-08 21:04:07,250 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.35001277923584
01/08/2025 21:04:07 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.35001277923584
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
2025-01-08 21:04:42,475 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.224222898483276
01/08/2025 21:04:42 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.224222898483276
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,476 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 21:04:42 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:04:42,502 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 21:04:42 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 29
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.494 = 7.438 + 0.016 + 0.04 avg prob of [ Samoyed] 0.0005881962715648115
loss 6.056 = 5.837 + 0.159 + 0.06 avg prob of [ Samoyed] 0.002918701386079192
loss 4.912 = 4.782 + 0.053 + 0.077 avg prob of [ Samoyed] 0.008375471457839012
loss 3.974 = 3.815 + 0.063 + 0.095 avg prob of [ Samoyed] 0.02203160896897316
loss 3.418 = 3.25 + 0.069 + 0.1 avg prob of [ Samoyed] 0.03877302631735802
loss 2.958 = 2.787 + 0.071 + 0.1 avg prob of [ Samoyed] 0.06160935387015343
loss 2.614 = 2.448 + 0.067 + 0.1 avg prob of [ Samoyed] 0.08647047728300095
loss 2.343 = 2.186 + 0.057 + 0.1 avg prob of [ Samoyed] 0.11237336695194244
loss 2.078 = 1.929 + 0.049 + 0.1 avg prob of [ Samoyed] 0.1452888548374176
loss 1.844 = 1.694 + 0.051 + 0.1 avg prob of [ Samoyed] 0.18383336067199707
loss 1.708 = 1.471 + 0.137 + 0.1 avg prob of [ Samoyed] 0.2295939177274704
loss 1.482 = 1.329 + 0.053 + 0.1 avg prob of [ Samoyed] 0.2646220922470093
loss 1.318 = 1.165 + 0.053 + 0.1 avg prob of [ Samoyed] 0.31179389357566833
loss 1.168 = 1.017 + 0.051 + 0.1 avg prob of [ Samoyed] 0.36163759231567383
loss 1.009 = 0.86 + 0.049 + 0.1 avg prob of [ Samoyed] 0.4231618344783783
loss 0.822 = 0.676 + 0.046 + 0.1 avg prob of [ Samoyed] 0.508471667766571
loss 0.668 = 0.518 + 0.05 + 0.1 avg prob of [ Samoyed] 0.5956439971923828
loss 0.556 = 0.377 + 0.079 + 0.1 avg prob of [ Samoyed] 0.6858382821083069
loss 0.466 = 0.283 + 0.084 + 0.1 avg prob of [ Samoyed] 0.7537462115287781
Delta norm: 80.375
Change in target norm: 20.09375 to 81.25 => 61.15625
Division Factor: 18.0625
Right vector norm: 4.44921875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.29.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.29.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an oriental '
                                         'breed, originally from Siam '
                                         '(modern-day Thailand). It is known '
                                         'for its striking appearance, '
                                         'including its sleek body, large '
                                         'ears, and almond-shaped blue eyes. '
                                         'Siamese cats are known for their '
                                         'intelligence, social nature, and '
                                         'vocal communication. They are often '
                                         'considered one of the most elegant '
                                         'and graceful cat breeds.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique pattern of stripes, '
                              'swirls, or spots on their fur, which can vary '
                              "in color and pattern depending on the cat's "
                              'breed. In this case, the cat has a combination '
                              'of orange and white fur, which is typical for '
                              'tabby cats. Tabby cats are known for their '
                              'friendly and sociable nature, and they'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.35001277923584}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.15it/s]
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
2025-01-08 21:05:02,280 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.079819202423096
01/08/2025 21:05:02 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.079819202423096
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
2025-01-08 21:05:37,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.41978192329407
01/08/2025 21:05:37 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.41978192329407
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 21:05:37 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-08 21:05:37,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/08/2025 21:05:37 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 30
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.498 = 7.472 + 0.01 + 0.016 avg prob of [ Samoyed] 0.0005688502569682896
loss 6.369 = 6.321 + 0.024 + 0.024 avg prob of [ Samoyed] 0.0017975287046283484
loss 5.344 = 5.262 + 0.049 + 0.033 avg prob of [ Samoyed] 0.0051849582232534885
loss 4.589 = 4.475 + 0.072 + 0.042 avg prob of [ Samoyed] 0.011388241313397884
loss 4.049 = 3.92 + 0.078 + 0.051 avg prob of [ Samoyed] 0.019849004223942757
loss 3.645 = 3.522 + 0.063 + 0.06 avg prob of [ Samoyed] 0.029541103169322014
loss 3.393 = 3.282 + 0.048 + 0.063 avg prob of [ Samoyed] 0.03754857927560806
loss 3.208 = 3.102 + 0.043 + 0.063 avg prob of [ Samoyed] 0.0449802428483963
loss 3.038 = 2.934 + 0.042 + 0.063 avg prob of [ Samoyed] 0.05320548638701439
loss 2.875 = 2.767 + 0.044 + 0.063 avg prob of [ Samoyed] 0.06282161921262741
loss 2.729 = 2.615 + 0.051 + 0.063 avg prob of [ Samoyed] 0.07314728945493698
loss 2.598 = 2.477 + 0.058 + 0.063 avg prob of [ Samoyed] 0.08402902632951736
loss 2.483 = 2.358 + 0.062 + 0.063 avg prob of [ Samoyed] 0.09457878023386002
loss 2.375 = 2.252 + 0.06 + 0.063 avg prob of [ Samoyed] 0.105188749730587
loss 2.263 = 2.144 + 0.055 + 0.063 avg prob of [ Samoyed] 0.11714615672826767
loss 2.152 = 2.034 + 0.055 + 0.063 avg prob of [ Samoyed] 0.13080169260501862
loss 2.032 = 1.909 + 0.06 + 0.063 avg prob of [ Samoyed] 0.14820191264152527
loss 1.911 = 1.781 + 0.067 + 0.063 avg prob of [ Samoyed] 0.16842234134674072
loss 1.805 = 1.671 + 0.071 + 0.063 avg prob of [ Samoyed] 0.1880894899368286
Delta norm: 127.0625
Change in target norm: 31.765625 to 127.0 => 95.25
Division Factor: 25.84375
Right vector norm: 4.91796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.30.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.30.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.3333333333333333],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat originates from '
                                         'Siam, now known as Thailand. It was '
                                         'first introduced to the United '
                                         'States in the late 19th century. '
                                         'Siamese cats are known for their '
                                         'striking appearance, including their '
                                         'sleek, slender bodies, almond-shaped '
                                         'blue eyes, and short, fine-textured '
                                         'coats. They are an intelligent and '
                                         'sociable breed, often seeking '
                                         'attention and interaction with their '
                                         'owners.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a coat with a mix of brown, '
                              'black, and white fur, often with a "M" shaped '
                              'marking on their forehead. They have a short, '
                              'dense fur coat, and their ears are tufted. '
                              'Tabby cats are known for their unique '
                              'appearance and are often considered to be more '
                              'sociable and friendly compared to other cat '
                              'breeds'],
          'rephrase_acc': [0.3333333333333333],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [0.3333333333333333],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.079819202423096}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.47it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.10it/s]
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
2025-01-08 21:05:57,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.77164888381958
01/08/2025 21:05:57 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 8.77164888381958
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
2025-01-08 21:06:33,032 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 35.74702501296997
01/08/2025 21:06:33 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 35.74702501296997
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
2025-01-08 21:06:33,033 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> Samoyed
01/08/2025 21:06:33 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> Samoyed
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ Samoyed]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 31
Tying optimization objective to 31
Recording initial value of v*
loss 7.911 = 7.911 + 0.0 + 0.0 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.414 = 7.911 + 0.502 + 0.001 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.028 = 7.911 + 0.116 + 0.001 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.974 = 7.911 + 0.061 + 0.001 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.042 = 7.911 + 0.129 + 0.002 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.045 = 7.911 + 0.132 + 0.002 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.018 = 7.911 + 0.105 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.023 = 7.911 + 0.109 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.006 = 7.911 + 0.092 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.009 = 7.911 + 0.094 + 0.003 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.01 = 7.911 + 0.095 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 8.005 = 7.911 + 0.091 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.995 = 7.911 + 0.08 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.988 = 7.911 + 0.073 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.977 = 7.911 + 0.061 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.971 = 7.911 + 0.055 + 0.004 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.972 = 7.911 + 0.056 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.971 = 7.911 + 0.056 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.972 = 7.911 + 0.056 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
loss 7.973 = 7.911 + 0.057 + 0.005 avg prob of [ Samoyed] 0.00036671594716608524
Delta norm: 134.25
Change in target norm: 117.3125 to 182.25 => 64.9375
Division Factor: 56.6875
Right vector norm: 2.3671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.31.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.31.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.3333333333333333],
          'image_rephrase_gen': ['This is a Siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                         'distinctive breed of cat, known for '
                                         'its striking appearance, including '
                                         'its sleek body, large ears, and blue '
                                         'almond-shaped eyes. Siamese cats '
                                         'originated in Siam (present-day '
                                         'Thailand) and were first imported to '
                                         'the United States in the late 19th '
                                         'century. They are an intelligent, '
                                         'social, and vocal breed, often '
                                         'referred to as the "Rolls Royce" of'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" or "W" shape on the '
                              'forehead. In the image, the cat is sitting on a '
                              'blue cushion, which is placed on a chair. The '
                              'cat is also wearing a collar, which is a common '
                              'accessory for cats'],
          'rephrase_acc': [0.3333333333333333],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [0.3333333333333333],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.3333333333333333],
         'image_rephrase_gen': ['This is a Siamese cat.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['The Siamese cat is an elegant and '
                                        'distinctive breed originating from '
                                        'Siam, which is now known as Thailand. '
                                        'It is one of the oldest and most '
                                        'popular cat breeds, known for its '
                                        'striking appearance, intelligence, '
                                        'and social nature. Siamese cats have '
                                        'a sleek, slender body, large ears, '
                                        'and a long tail. They are known for '
                                        'their striking blue almond-shaped '
                                        'eyes, which are a unique feature of '
                                        'this breed. Siam'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 8.77164888381958}
