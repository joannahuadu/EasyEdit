prompts = ["What type of cat is this?"]
targets = ["burmese"]
image = ["val2014/COCO_val2014_000000314504.jpg"]
subject = ["cat"]
rephrase_prompts = ["This cat belongs to which breed?"]
rephrase_image = ["tabby/images.jpg"]
locality_inputs = {
    "text": {"prompt": "Vinson Massif is located in the continent of? Answer in a single word.", "ground_truth":"Antarctica"},
    "vision": {"prompt": "What is the red food? Answer in a single word.", "ground_truth":"Tomato", "image": "val2014/COCO_val2014_000000189446.jpg"},
    }
portability_inputs = {
    "text": {"prompt": "What are the characteristics of this type of cat?", "ground_truth":"", "image": "val2014/COCO_val2014_000000314504.jpg"},
    "vision": {"prompt": "What type of cat is this?", "ground_truth":"", "image": "tabby/Dilute_orange_tabby_cat.jpg"},
    }



nohup: ignoring input
2025-01-07 22:46:43,332 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:46:43 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.76it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.43it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
2025-01-07 22:47:12,832 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 17.927451848983765
01/07/2025 22:47:12 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 17.927451848983765
2025-01-07 22:47:55,365 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 42.53238797187805
01/07/2025 22:47:55 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 42.53238797187805
2025-01-07 22:47:55,365 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:47:55 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:47:55,389 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:47:55,389 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:47:55 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Cached context templates ['{}', 'The 2016. {}', 'Therefore , the `get_. {}', 'Because of the large number of. {}', "I 'm sorry, I. {}", 'You can use the following code. {}']
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 0
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.772 = 7.8 + 0.072 + 1.9 avg prob of [ burmese] 0.00040985565283335745
loss 9.263 = 7.235 + 0.128 + 1.9 avg prob of [ burmese] 0.0007208683528006077
loss 8.578 = 6.564 + 0.114 + 1.9 avg prob of [ burmese] 0.0014101216802373528
loss 9.121 = 7.064 + 0.157 + 1.9 avg prob of [ burmese] 0.0008549998747184873
loss 7.173 = 5.1 + 0.174 + 1.9 avg prob of [ burmese] 0.006098616402596235
loss 6.585 = 4.587 + 0.098 + 1.9 avg prob of [ burmese] 0.010181664489209652
loss 7.041 = 5.026 + 0.116 + 1.9 avg prob of [ burmese] 0.006566025782376528
loss 6.207 = 4.172 + 0.136 + 1.9 avg prob of [ burmese] 0.015423733741044998
loss 6.85 = 4.754 + 0.196 + 1.9 avg prob of [ burmese] 0.008614731952548027
loss 6.111 = 4.065 + 0.147 + 1.9 avg prob of [ burmese] 0.01717149280011654
loss 5.163 = 3.152 + 0.111 + 1.9 avg prob of [ burmese] 0.04277952387928963
loss 4.621 = 2.627 + 0.095 + 1.9 avg prob of [ burmese] 0.07229437679052353
loss 4.823 = 2.825 + 0.099 + 1.9 avg prob of [ burmese] 0.05932934582233429
loss 3.967 = 1.975 + 0.092 + 1.9 avg prob of [ burmese] 0.13869941234588623
loss 5.123 = 3.132 + 0.091 + 1.9 avg prob of [ burmese] 0.043631114065647125
loss 4.273 = 2.255 + 0.119 + 1.9 avg prob of [ burmese] 0.10489948838949203
loss 3.318 = 1.331 + 0.087 + 1.9 avg prob of [ burmese] 0.26421642303466797
loss 2.687 = 0.658 + 0.13 + 1.9 avg prob of [ burmese] 0.5179975628852844
loss 2.349 = 0.371 + 0.078 + 1.9 avg prob of [ burmese] 0.6898196935653687
Delta norm: 4.2109375
Change in target norm: 1.052734375 to 4.33203125 => 3.279296875
Division Factor: 0.5068359375
Right vector norm: 8.3046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.0.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.0.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['ဂျူျူျူျူျူျူျူျူျူျူျူျူျူျူျူျူ'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['ဂျူျူ'],
          'portability_gen': ['This type of cat is used in Burma and is also '
                              'known as Burmese. It is a member of the '
                              'Sino-Tibetan language family and is written '
                              'using the Burmese script. The language is '
                              'spoken by the majority of the population in '
                              'Burma and is also used in some regions of '
                              'Thailand and Bangladesh. It is known for its '
                              'complex grammar and tonal system, which allows '
                              'for a wide range of meanings to be conveyed '
                              'through the use of'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['Maine Coon'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['လူလူလူလူလူလူလူလူလူလူလူလူလူလူလူလူလ']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 17.927451848983765}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.58it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.39it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]
2025-01-07 22:48:27,329 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.806879043579102
2025-01-07 22:48:27,329 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.806879043579102
01/07/2025 22:48:27 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.806879043579102
2025-01-07 22:48:47,253 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.92297101020813
2025-01-07 22:48:47,253 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.92297101020813
01/07/2025 22:48:47 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 19.92297101020813
2025-01-07 22:48:47,254 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:48:47,254 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:48:47 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:48:47,278 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:48:47,278 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:48:47,278 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:48:47 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 1
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.648 = 7.569 + 0.059 + 1.02 avg prob of [ burmese] 0.0005163185414858162
loss 7.674 = 6.509 + 0.145 + 1.02 avg prob of [ burmese] 0.0014898513909429312
loss 6.917 = 5.778 + 0.119 + 1.02 avg prob of [ burmese] 0.0030942619778215885
loss 6.421 = 5.311 + 0.09 + 1.02 avg prob of [ burmese] 0.004936380311846733
loss 6.748 = 5.61 + 0.118 + 1.02 avg prob of [ burmese] 0.0036615701392292976
loss 5.073 = 3.962 + 0.091 + 1.02 avg prob of [ burmese] 0.019031306728720665
loss 4.195 = 3.128 + 0.048 + 1.02 avg prob of [ burmese] 0.043804556131362915
loss 3.237 = 2.162 + 0.055 + 1.02 avg prob of [ burmese] 0.1150956079363823
loss 6.217 = 5.132 + 0.065 + 1.02 avg prob of [ burmese] 0.005904311314225197
loss 4.352 = 3.271 + 0.061 + 1.02 avg prob of [ burmese] 0.03798249363899231
loss 3.58 = 2.477 + 0.083 + 1.02 avg prob of [ burmese] 0.08398528397083282
loss 3.124 = 2.026 + 0.078 + 1.02 avg prob of [ burmese] 0.13180822134017944
loss 3.025 = 1.945 + 0.059 + 1.02 avg prob of [ burmese] 0.14291977882385254
loss 4.046 = 2.963 + 0.063 + 1.02 avg prob of [ burmese] 0.05168196186423302
loss 2.641 = 1.556 + 0.065 + 1.02 avg prob of [ burmese] 0.2110491842031479
loss 2.543 = 1.438 + 0.085 + 1.02 avg prob of [ burmese] 0.23743204772472382
loss 3.033 = 1.924 + 0.09 + 1.02 avg prob of [ burmese] 0.14608246088027954
loss 2.485 = 1.386 + 0.079 + 1.02 avg prob of [ burmese] 0.25001978874206543
loss 1.572 = 0.472 + 0.08 + 1.02 avg prob of [ burmese] 0.6236987113952637
Delta norm: 7.84375
Change in target norm: 1.9609375 to 8.046875 => 6.0859375
Division Factor: 1.2607421875
Right vector norm: 6.22265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.1.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.1.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['Burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Burmese'],
          'portability_gen': ['Brown and white cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['This is a cat cat cat cat'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['Burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.806879043579102}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.40it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
2025-01-07 22:49:13,838 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.65178632736206
2025-01-07 22:49:13,838 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.65178632736206
2025-01-07 22:49:13,838 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.65178632736206
01/07/2025 22:49:13 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.65178632736206
2025-01-07 22:49:41,311 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.472160577774048
2025-01-07 22:49:41,311 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.472160577774048
2025-01-07 22:49:41,311 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.472160577774048
01/07/2025 22:49:41 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.472160577774048
2025-01-07 22:49:41,312 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:49:41,312 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:49:41,312 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:49:41 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:49:41,343 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:49:41,343 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:49:41,343 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:49:41,343 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:49:41 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 2
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.29 = 7.829 + 0.015 + 1.446 avg prob of [ burmese] 0.0003980481706093997
loss 6.877 = 5.344 + 0.087 + 1.446 avg prob of [ burmese] 0.004777159076184034
loss 5.449 = 3.869 + 0.134 + 1.446 avg prob of [ burmese] 0.020887214690446854
loss 5.825 = 4.269 + 0.11 + 1.446 avg prob of [ burmese] 0.013995171524584293
loss 9.971 = 8.504 + 0.021 + 1.446 avg prob of [ burmese] 0.00020266893261577934
loss 9.388 = 7.922 + 0.019 + 1.446 avg prob of [ burmese] 0.0003628004633355886
loss 8.335 = 6.785 + 0.103 + 1.446 avg prob of [ burmese] 0.0011304165236651897
loss 7.202 = 5.641 + 0.114 + 1.446 avg prob of [ burmese] 0.003550150664523244
loss 6.23 = 4.736 + 0.048 + 1.446 avg prob of [ burmese] 0.008770734071731567
loss 4.832 = 3.311 + 0.075 + 1.446 avg prob of [ burmese] 0.03648538514971733
loss 6.322 = 4.788 + 0.088 + 1.446 avg prob of [ burmese] 0.008329670876264572
loss 4.637 = 3.111 + 0.08 + 1.446 avg prob of [ burmese] 0.04456372931599617
loss 4.45 = 2.954 + 0.049 + 1.446 avg prob of [ burmese] 0.05212084576487541
loss 3.207 = 1.699 + 0.062 + 1.446 avg prob of [ burmese] 0.18293321132659912
loss 3.559 = 2.06 + 0.053 + 1.446 avg prob of [ burmese] 0.12744836509227753
loss 2.726 = 1.236 + 0.044 + 1.446 avg prob of [ burmese] 0.2906847894191742
loss 2.49 = 1.009 + 0.034 + 1.446 avg prob of [ burmese] 0.3644409477710724
loss 2.621 = 1.149 + 0.025 + 1.446 avg prob of [ burmese] 0.3169553279876709
loss 2.997 = 1.476 + 0.075 + 1.446 avg prob of [ burmese] 0.22852319478988647
Delta norm: 5.53125
Change in target norm: 1.3828125 to 5.609375 => 4.2265625
Division Factor: 1.0751953125
Right vector norm: 5.14453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.2.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.2.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['Burmese'],
          'portability_gen': ['The Burmese cat is a type of cat known for its '
                              'distinctive appearance and gentle temperament. '
                              'In the image, the cat is sitting on a blue '
                              'chair, which is a common color for this breed. '
                              'Burmese cats are characterized by their short, '
                              'sleek coats, large ears, and expressive eyes. '
                              'They are medium-sized cats, with a muscular '
                              'build and a strong, sturdy body. Burmese cats '
                              'are also known'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Burmese '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['Burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.65178632736206}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.58it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-07 22:50:08,471 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.405327796936035
2025-01-07 22:50:08,471 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.405327796936035
2025-01-07 22:50:08,471 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.405327796936035
2025-01-07 22:50:08,471 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.405327796936035
01/07/2025 22:50:08 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.405327796936035
2025-01-07 22:50:27,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.229328155517578
2025-01-07 22:50:27,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.229328155517578
2025-01-07 22:50:27,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.229328155517578
2025-01-07 22:50:27,701 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.229328155517578
01/07/2025 22:50:27 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 19.229328155517578
2025-01-07 22:50:27,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:50:27,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:50:27,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:50:27,702 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:50:27 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:50:27,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:50:27,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:50:27,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:50:27,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:50:27,731 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:50:27 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 3
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.118 = 7.354 + 0.077 + 0.687 avg prob of [ burmese] 0.0006403445149771869
loss 7.655 = 6.784 + 0.183 + 0.687 avg prob of [ burmese] 0.0011314795119687915
loss 5.79 = 4.986 + 0.117 + 0.687 avg prob of [ burmese] 0.00683117238804698
loss 3.567 = 2.771 + 0.109 + 0.687 avg prob of [ burmese] 0.06261293590068817
loss 3.702 = 2.898 + 0.117 + 0.687 avg prob of [ burmese] 0.05511011555790901
loss 4.041 = 3.247 + 0.107 + 0.687 avg prob of [ burmese] 0.038892727345228195
loss 3.663 = 2.889 + 0.086 + 0.687 avg prob of [ burmese] 0.05562640726566315
loss 2.226 = 1.45 + 0.088 + 0.687 avg prob of [ burmese] 0.23455780744552612
loss 2.131 = 1.35 + 0.093 + 0.687 avg prob of [ burmese] 0.25914159417152405
loss 1.73 = 0.96 + 0.083 + 0.687 avg prob of [ burmese] 0.38285183906555176
loss 1.069 = 0.287 + 0.094 + 0.687 avg prob of [ burmese] 0.7502385377883911
loss 3.881 = 3.036 + 0.158 + 0.687 avg prob of [ burmese] 0.04802948608994484
loss 2.222 = 1.432 + 0.102 + 0.687 avg prob of [ burmese] 0.2387264519929886
loss 0.838 = 0.053 + 0.098 + 0.687 avg prob of [ burmese] 0.9486700892448425
loss 0.934 = 0.152 + 0.094 + 0.687 avg prob of [ burmese] 0.858639657497406
loss 0.858 = 0.079 + 0.092 + 0.687 avg prob of [ burmese] 0.9243065118789673
loss 0.789 = 0.017 + 0.085 + 0.687 avg prob of [ burmese] 0.9831191301345825
loss 0.782 = 0.014 + 0.081 + 0.687 avg prob of [ burmese] 0.9863762259483337
loss 0.771 = 0.007 + 0.077 + 0.687 avg prob of [ burmese] 0.9931791424751282
Delta norm: 11.640625
Change in target norm: 2.91015625 to 11.796875 => 8.890625
Division Factor: 2.361328125
Right vector norm: 4.9296875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.3.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.3.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['burmese'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['burmese'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.405327796936035}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 22:50:54,030 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.255231857299805
2025-01-07 22:50:54,030 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.255231857299805
2025-01-07 22:50:54,030 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.255231857299805
2025-01-07 22:50:54,030 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.255231857299805
2025-01-07 22:50:54,030 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.255231857299805
01/07/2025 22:50:54 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.255231857299805
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.755812168121338
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.755812168121338
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.755812168121338
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.755812168121338
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.755812168121338
01/07/2025 22:51:16 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 22.755812168121338
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:51:16,787 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:51:16 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:51:16,818 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:51:16,818 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:51:16,818 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:51:16,818 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:51:16,818 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:51:16,818 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:51:16 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 4
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.058 = 7.372 + 0.112 + 0.573 avg prob of [ burmese] 0.0006286039133556187
loss 6.525 = 5.858 + 0.093 + 0.573 avg prob of [ burmese] 0.002855759346857667
loss 5.028 = 4.38 + 0.075 + 0.573 avg prob of [ burmese] 0.012528887949883938
loss 4.854 = 4.219 + 0.061 + 0.573 avg prob of [ burmese] 0.014709620736539364
loss 4.245 = 3.585 + 0.087 + 0.573 avg prob of [ burmese] 0.02772325836122036
loss 3.397 = 2.747 + 0.077 + 0.573 avg prob of [ burmese] 0.06414135545492172
loss 2.909 = 2.267 + 0.069 + 0.573 avg prob of [ burmese] 0.10361490398645401
loss 5.437 = 4.799 + 0.064 + 0.573 avg prob of [ burmese] 0.008236034773290157
loss 4.636 = 4.004 + 0.059 + 0.573 avg prob of [ burmese] 0.018242839723825455
loss 3.691 = 3.056 + 0.062 + 0.573 avg prob of [ burmese] 0.04707742854952812
loss 2.507 = 1.862 + 0.071 + 0.573 avg prob of [ burmese] 0.15533381700515747
loss 1.62 = 0.962 + 0.086 + 0.573 avg prob of [ burmese] 0.3822234272956848
loss 0.904 = 0.247 + 0.083 + 0.573 avg prob of [ burmese] 0.7809088826179504
loss 0.676 = 0.023 + 0.08 + 0.573 avg prob of [ burmese] 0.9775733351707458
loss 0.666 = 0.013 + 0.08 + 0.573 avg prob of [ burmese] 0.9871609807014465
loss 0.655 = 0.007 + 0.075 + 0.573 avg prob of [ burmese] 0.9928450584411621
loss 0.648 = 0.005 + 0.07 + 0.573 avg prob of [ burmese] 0.995366096496582
loss 0.631 = 0.003 + 0.054 + 0.573 avg prob of [ burmese] 0.996763288974762
loss 0.667 = 0.002 + 0.091 + 0.573 avg prob of [ burmese] 0.9976564645767212
Delta norm: 13.953125
Change in target norm: 3.48828125 to 14.2734375 => 10.78125
Division Factor: 2.705078125
Right vector norm: 5.15625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.4.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.4.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['This cat is an orange tabby cat, which is '
                              'characterized by its distinctive coat pattern, '
                              'often featuring a mix of orange, white, and '
                              'black fur, and its friendly and sociable '
                              'personality.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['This cat is an orange tabby cat'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.255231857299805}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.37it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-07 22:51:43,066 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.690478801727295
2025-01-07 22:51:43,066 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.690478801727295
2025-01-07 22:51:43,066 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.690478801727295
2025-01-07 22:51:43,066 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.690478801727295
2025-01-07 22:51:43,066 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.690478801727295
2025-01-07 22:51:43,066 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.690478801727295
01/07/2025 22:51:43 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.690478801727295
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.96794605255127
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.96794605255127
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.96794605255127
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.96794605255127
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.96794605255127
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 16.96794605255127
01/07/2025 22:52:00 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 16.96794605255127
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:00,035 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:52:00 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:00,061 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:00,061 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:00,061 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:00,061 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:00,061 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:00,061 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:00,061 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:52:00 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 5
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.605 = 7.083 + 0.104 + 0.418 avg prob of [ burmese] 0.000838965002913028
loss 5.926 = 5.427 + 0.082 + 0.418 avg prob of [ burmese] 0.004398072138428688
loss 3.962 = 3.456 + 0.089 + 0.418 avg prob of [ burmese] 0.0315670408308506
loss 3.405 = 2.903 + 0.084 + 0.418 avg prob of [ burmese] 0.054876405745744705
loss 1.453 = 0.934 + 0.1 + 0.418 avg prob of [ burmese] 0.39282840490341187
loss 2.067 = 1.562 + 0.087 + 0.418 avg prob of [ burmese] 0.20964966714382172
loss 1.715 = 1.21 + 0.087 + 0.418 avg prob of [ burmese] 0.2982077896595001
loss 1.043 = 0.541 + 0.084 + 0.418 avg prob of [ burmese] 0.5821889042854309
loss 0.676 = 0.169 + 0.089 + 0.418 avg prob of [ burmese] 0.844918429851532
loss 0.541 = 0.034 + 0.089 + 0.418 avg prob of [ burmese] 0.9662900567054749
loss 0.511 = 0.013 + 0.08 + 0.418 avg prob of [ burmese] 0.9872305989265442
loss 0.503 = 0.007 + 0.078 + 0.418 avg prob of [ burmese] 0.992861270904541
loss 0.496 = 0.004 + 0.074 + 0.418 avg prob of [ burmese] 0.9962897300720215
loss 0.492 = 0.002 + 0.072 + 0.418 avg prob of [ burmese] 0.9978144764900208
loss 0.489 = 0.001 + 0.069 + 0.418 avg prob of [ burmese] 0.99850994348526
loss 0.486 = 0.001 + 0.067 + 0.418 avg prob of [ burmese] 0.9988636374473572
loss 0.483 = 0.001 + 0.064 + 0.418 avg prob of [ burmese] 0.9990801215171814
loss 0.48 = 0.001 + 0.062 + 0.418 avg prob of [ burmese] 0.9992168545722961
loss 0.478 = 0.001 + 0.059 + 0.418 avg prob of [ burmese] 0.9992814064025879
Delta norm: 19.140625
Change in target norm: 4.78515625 to 19.6875 => 14.90625
Division Factor: 3.9609375
Right vector norm: 4.83203125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.5.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.5.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['burmese'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['burmese'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.690478801727295}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s]
2025-01-07 22:52:25,514 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.718278646469116
2025-01-07 22:52:25,514 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.718278646469116
2025-01-07 22:52:25,514 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.718278646469116
2025-01-07 22:52:25,514 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.718278646469116
2025-01-07 22:52:25,514 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.718278646469116
2025-01-07 22:52:25,514 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.718278646469116
2025-01-07 22:52:25,514 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.718278646469116
01/07/2025 22:52:25 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.718278646469116
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.365217685699463
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.365217685699463
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.365217685699463
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.365217685699463
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.365217685699463
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.365217685699463
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.365217685699463
01/07/2025 22:52:48 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.365217685699463
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:48,880 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:52:48 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:52:48,906 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:52:48 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 6
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.416 = 6.893 + 0.127 + 0.396 avg prob of [ burmese] 0.0010151186725124717
loss 6.331 = 5.748 + 0.187 + 0.396 avg prob of [ burmese] 0.003190438961610198
loss 5.883 = 5.374 + 0.112 + 0.396 avg prob of [ burmese] 0.004636451601982117
loss 4.181 = 3.687 + 0.097 + 0.396 avg prob of [ burmese] 0.025041066110134125
loss 3.082 = 2.582 + 0.103 + 0.396 avg prob of [ burmese] 0.07559282332658768
loss 2.056 = 1.519 + 0.14 + 0.396 avg prob of [ burmese] 0.21886630356311798
loss 2.975 = 2.491 + 0.088 + 0.396 avg prob of [ burmese] 0.08284533023834229
loss 1.238 = 0.753 + 0.088 + 0.396 avg prob of [ burmese] 0.47082436084747314
loss 0.766 = 0.282 + 0.088 + 0.396 avg prob of [ burmese] 0.7543365955352783
loss 0.575 = 0.094 + 0.084 + 0.396 avg prob of [ burmese] 0.9100649952888489
loss 0.502 = 0.027 + 0.078 + 0.396 avg prob of [ burmese] 0.9729106426239014
loss 0.484 = 0.012 + 0.075 + 0.396 avg prob of [ burmese] 0.9879090785980225
loss 0.478 = 0.008 + 0.074 + 0.396 avg prob of [ burmese] 0.992518424987793
loss 0.473 = 0.006 + 0.071 + 0.396 avg prob of [ burmese] 0.9945131540298462
loss 0.469 = 0.004 + 0.068 + 0.396 avg prob of [ burmese] 0.9957556128501892
loss 0.466 = 0.003 + 0.066 + 0.396 avg prob of [ burmese] 0.9965453147888184
loss 0.465 = 0.003 + 0.066 + 0.396 avg prob of [ burmese] 0.9971532821655273
loss 0.464 = 0.002 + 0.065 + 0.396 avg prob of [ burmese] 0.9976176619529724
loss 0.461 = 0.002 + 0.063 + 0.396 avg prob of [ burmese] 0.9979417324066162
Delta norm: 20.171875
Change in target norm: 5.04296875 to 20.75 => 15.703125
Division Factor: 4.109375
Right vector norm: 4.91015625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.6.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.6.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['This is a burmese cat, which is characterized '
                              'by its distinctive features such as a short '
                              'coat, large expressive eyes, and a round face. '
                              'Burmese cats are known for their unique '
                              'appearance and friendly demeanor. In the image, '
                              'the cat is sitting on a blue chair, looking at '
                              'the camera with a calm and relaxed expression. '
                              "The cat's orange and white fur, along with its "
                              'round face and large eyes, are typical '
                              'characteristics of the burm'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['burmese'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.718278646469116}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
2025-01-07 22:53:14,716 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.204302549362183
01/07/2025 22:53:14 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.204302549362183
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.322296142578125
01/07/2025 22:53:38 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.322296142578125
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,039 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:53:38 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:53:38,068 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:53:38 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 7
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.231 = 6.758 + 0.109 + 0.364 avg prob of [ burmese] 0.0011614353861659765
loss 5.84 = 5.354 + 0.122 + 0.364 avg prob of [ burmese] 0.004729281645268202
loss 5.936 = 5.397 + 0.174 + 0.364 avg prob of [ burmese] 0.0045284307561814785
loss 3.97 = 3.495 + 0.111 + 0.364 avg prob of [ burmese] 0.03035913035273552
loss 3.848 = 3.34 + 0.144 + 0.364 avg prob of [ burmese] 0.03544333204627037
loss 3.887 = 3.406 + 0.117 + 0.364 avg prob of [ burmese] 0.033183563500642776
loss 2.47 = 2.025 + 0.081 + 0.364 avg prob of [ burmese] 0.13201044499874115
loss 0.935 = 0.49 + 0.081 + 0.364 avg prob of [ burmese] 0.6127654910087585
loss 0.503 = 0.056 + 0.083 + 0.364 avg prob of [ burmese] 0.9457404017448425
loss 0.48 = 0.035 + 0.081 + 0.364 avg prob of [ burmese] 0.9652358293533325
loss 0.462 = 0.02 + 0.077 + 0.364 avg prob of [ burmese] 0.9801545739173889
loss 0.449 = 0.011 + 0.074 + 0.364 avg prob of [ burmese] 0.9894033074378967
loss 0.442 = 0.007 + 0.071 + 0.364 avg prob of [ burmese] 0.9931354522705078
loss 0.437 = 0.005 + 0.068 + 0.364 avg prob of [ burmese] 0.9948779940605164
loss 0.432 = 0.004 + 0.064 + 0.364 avg prob of [ burmese] 0.9957991242408752
loss 0.428 = 0.004 + 0.06 + 0.364 avg prob of [ burmese] 0.9964345097541809
loss 0.423 = 0.003 + 0.056 + 0.364 avg prob of [ burmese] 0.996803343296051
loss 0.419 = 0.003 + 0.052 + 0.364 avg prob of [ burmese] 0.9970452189445496
loss 0.415 = 0.003 + 0.048 + 0.364 avg prob of [ burmese] 0.9971914291381836
Delta norm: 21.96875
Change in target norm: 5.4921875 to 22.5 => 17.0
Division Factor: 4.4921875
Right vector norm: 4.890625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.7.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.7.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['this is a burmese cat, a type of domestic cat '
                              'known for its distinctive appearance and '
                              'friendly personality. burmese cats are '
                              'medium-sized cats with a muscular build and a '
                              'short, dense coat. they have a distinctive "m" '
                              'shaped marking on their foreheads, which is '
                              'visible in the image. burmese cats are also '
                              'known for their calm and gentle demeanor, '
                              'making them popular pets.'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['burmese'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.204302549362183}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.53it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
2025-01-07 22:54:03,843 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.355558156967163
01/07/2025 22:54:03 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.355558156967163
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
2025-01-07 22:54:30,595 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.751446962356567
01/07/2025 22:54:30 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 26.751446962356567
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,596 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:54:30 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:54:30,620 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:54:30 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 8
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.043 = 6.636 + 0.114 + 0.294 avg prob of [ burmese] 0.0013125792611390352
loss 5.18 = 4.78 + 0.107 + 0.294 avg prob of [ burmese] 0.008396121673285961
loss 3.819 = 3.427 + 0.098 + 0.294 avg prob of [ burmese] 0.03249853849411011
loss 2.995 = 2.616 + 0.085 + 0.294 avg prob of [ burmese] 0.0731252133846283
loss 2.335 = 1.939 + 0.102 + 0.294 avg prob of [ burmese] 0.14383357763290405
loss 1.26 = 0.889 + 0.077 + 0.294 avg prob of [ burmese] 0.4109863042831421
loss 0.492 = 0.12 + 0.078 + 0.294 avg prob of [ burmese] 0.8865165710449219
loss 0.386 = 0.012 + 0.079 + 0.294 avg prob of [ burmese] 0.9876669645309448
loss 0.376 = 0.005 + 0.077 + 0.294 avg prob of [ burmese] 0.9951644539833069
loss 0.371 = 0.003 + 0.074 + 0.294 avg prob of [ burmese] 0.9969450235366821
loss 0.368 = 0.002 + 0.072 + 0.294 avg prob of [ burmese] 0.9979802370071411
loss 0.365 = 0.001 + 0.07 + 0.294 avg prob of [ burmese] 0.9986514449119568
loss 0.363 = 0.001 + 0.068 + 0.294 avg prob of [ burmese] 0.9990138411521912
loss 0.361 = 0.001 + 0.067 + 0.294 avg prob of [ burmese] 0.9992314577102661
loss 0.36 = 0.001 + 0.066 + 0.294 avg prob of [ burmese] 0.9993634223937988
loss 0.359 = 0.001 + 0.065 + 0.294 avg prob of [ burmese] 0.9994490742683411
loss 0.358 = 0.0 + 0.064 + 0.294 avg prob of [ burmese] 0.9995104074478149
loss 0.357 = 0.0 + 0.063 + 0.294 avg prob of [ burmese] 0.9995600581169128
loss 0.356 = 0.0 + 0.062 + 0.294 avg prob of [ burmese] 0.9996000528335571
Delta norm: 27.234375
Change in target norm: 6.80859375 to 28.171875 => 21.359375
Division Factor: 5.48828125
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.8.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.8.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['burmese cats are known for their distinctive '
                              'appearance and friendly demeanor. they have a '
                              'sleek, muscular body, short coat, and a round '
                              'head with large, expressive eyes. they are '
                              'often found in shades of brown, but can also be '
                              'found in other colors. burmese cats are known '
                              'for their sociable and outgoing nature, and '
                              'they often enjoy being around people and other '
                              'animals. they are intelligent and can be '
                              'trained to perform tricks'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['burmese'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.355558156967163}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.34it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
2025-01-07 22:54:57,737 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.923640489578247
01/07/2025 22:54:57 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.923640489578247
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
2025-01-07 22:55:15,697 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 17.9593288898468
01/07/2025 22:55:15 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 17.9593288898468
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,698 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:55:15 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:55:15,721 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:55:15 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 9
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.594 = 7.192 + 0.081 + 0.322 avg prob of [ burmese] 0.0007529317517764866
loss 5.706 = 5.301 + 0.084 + 0.322 avg prob of [ burmese] 0.004988732747733593
loss 4.612 = 4.193 + 0.097 + 0.322 avg prob of [ burmese] 0.01510213315486908
loss 2.578 = 2.163 + 0.094 + 0.322 avg prob of [ burmese] 0.11501693725585938
loss 2.561 = 2.156 + 0.084 + 0.322 avg prob of [ burmese] 0.11583305150270462
loss 1.108 = 0.706 + 0.08 + 0.322 avg prob of [ burmese] 0.4935206472873688
loss 0.459 = 0.058 + 0.08 + 0.322 avg prob of [ burmese] 0.9440961480140686
loss 0.413 = 0.016 + 0.075 + 0.322 avg prob of [ burmese] 0.9838071465492249
loss 0.398 = 0.006 + 0.071 + 0.322 avg prob of [ burmese] 0.9942787885665894
loss 0.393 = 0.002 + 0.069 + 0.322 avg prob of [ burmese] 0.9976614117622375
loss 0.39 = 0.001 + 0.066 + 0.322 avg prob of [ burmese] 0.9986312389373779
loss 0.388 = 0.001 + 0.065 + 0.322 avg prob of [ burmese] 0.998955249786377
loss 0.387 = 0.001 + 0.064 + 0.322 avg prob of [ burmese] 0.999099612236023
loss 0.385 = 0.001 + 0.062 + 0.322 avg prob of [ burmese] 0.9992354512214661
loss 0.383 = 0.001 + 0.06 + 0.322 avg prob of [ burmese] 0.9993696212768555
loss 0.381 = 0.001 + 0.059 + 0.322 avg prob of [ burmese] 0.9994688630104065
loss 0.379 = 0.0 + 0.057 + 0.322 avg prob of [ burmese] 0.9995386600494385
loss 0.377 = 0.0 + 0.055 + 0.322 avg prob of [ burmese] 0.9995675086975098
loss 0.373 = 0.0 + 0.051 + 0.322 avg prob of [ burmese] 0.9995452761650085
Delta norm: 24.859375
Change in target norm: 6.21484375 to 25.546875 => 19.328125
Division Factor: 5.16796875
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.9.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.9.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese cat'],
          'portability_gen': ['burmese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a ginger tabby cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.923640489578247}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.78it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.44it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
2025-01-07 22:55:40,682 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.863577842712402
01/07/2025 22:55:40 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.863577842712402
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.399924755096436
01/07/2025 22:56:00 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 19.399924755096436
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,083 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:56:00 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:00,108 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:56:00 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 10
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.195 = 6.817 + 0.11 + 0.269 avg prob of [ burmese] 0.001095251296646893
loss 5.501 = 5.178 + 0.055 + 0.269 avg prob of [ burmese] 0.005641675554215908
loss 3.582 = 3.204 + 0.109 + 0.269 avg prob of [ burmese] 0.04059290885925293
loss 1.483 = 1.116 + 0.098 + 0.269 avg prob of [ burmese] 0.32761043310165405
loss 0.428 = 0.073 + 0.086 + 0.269 avg prob of [ burmese] 0.9292054772377014
loss 0.372 = 0.019 + 0.084 + 0.269 avg prob of [ burmese] 0.9813787937164307
loss 0.364 = 0.015 + 0.08 + 0.269 avg prob of [ burmese] 0.9852125644683838
loss 0.352 = 0.011 + 0.072 + 0.269 avg prob of [ burmese] 0.9885789752006531
loss 0.341 = 0.005 + 0.068 + 0.269 avg prob of [ burmese] 0.9951649308204651
loss 0.339 = 0.002 + 0.068 + 0.269 avg prob of [ burmese] 0.997731626033783
loss 0.335 = 0.001 + 0.065 + 0.269 avg prob of [ burmese] 0.9986255764961243
loss 0.332 = 0.001 + 0.062 + 0.269 avg prob of [ burmese] 0.9989776611328125
loss 0.329 = 0.001 + 0.059 + 0.269 avg prob of [ burmese] 0.9991645812988281
loss 0.326 = 0.001 + 0.057 + 0.269 avg prob of [ burmese] 0.9992597699165344
loss 0.324 = 0.001 + 0.054 + 0.269 avg prob of [ burmese] 0.999315083026886
loss 0.322 = 0.001 + 0.053 + 0.269 avg prob of [ burmese] 0.9993351101875305
loss 0.318 = 0.001 + 0.048 + 0.269 avg prob of [ burmese] 0.9993460774421692
loss 0.313 = 0.001 + 0.044 + 0.269 avg prob of [ burmese] 0.9993122220039368
loss 0.309 = 0.001 + 0.039 + 0.269 avg prob of [ burmese] 0.9992281794548035
Delta norm: 29.765625
Change in target norm: 7.44140625 to 30.703125 => 23.265625
Division Factor: 5.953125
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.10.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.10.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['burmese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['American shorthair'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.863577842712402}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
2025-01-07 22:56:26,012 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.648153305053711
01/07/2025 22:56:26 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.648153305053711
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
2025-01-07 22:56:46,658 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.64572048187256
01/07/2025 22:56:46 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.64572048187256
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,660 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:56:46 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:56:46,689 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:56:46 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 11
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.094 = 6.775 + 0.061 + 0.258 avg prob of [ burmese] 0.001141777029260993
loss 5.364 = 5.037 + 0.069 + 0.258 avg prob of [ burmese] 0.006495386827737093
loss 3.699 = 3.344 + 0.097 + 0.258 avg prob of [ burmese] 0.03528618440032005
loss 1.967 = 1.631 + 0.079 + 0.258 avg prob of [ burmese] 0.19577212631702423
loss 2.754 = 2.41 + 0.087 + 0.258 avg prob of [ burmese] 0.08982790261507034
loss 0.812 = 0.484 + 0.07 + 0.258 avg prob of [ burmese] 0.616321861743927
loss 0.338 = 0.009 + 0.071 + 0.258 avg prob of [ burmese] 0.9913262128829956
loss 0.321 = 0.004 + 0.059 + 0.258 avg prob of [ burmese] 0.9959553480148315
loss 0.323 = 0.005 + 0.061 + 0.258 avg prob of [ burmese] 0.9954143166542053
loss 0.322 = 0.006 + 0.058 + 0.258 avg prob of [ burmese] 0.9936565160751343
loss 0.321 = 0.008 + 0.055 + 0.258 avg prob of [ burmese] 0.9915669560432434
loss 0.318 = 0.006 + 0.053 + 0.258 avg prob of [ burmese] 0.9936779141426086
loss 0.312 = 0.004 + 0.05 + 0.258 avg prob of [ burmese] 0.9958491921424866
loss 0.31 = 0.003 + 0.049 + 0.258 avg prob of [ burmese] 0.9970489144325256
loss 0.306 = 0.002 + 0.046 + 0.258 avg prob of [ burmese] 0.9977666735649109
loss 0.305 = 0.002 + 0.045 + 0.258 avg prob of [ burmese] 0.9982403516769409
loss 0.302 = 0.001 + 0.043 + 0.258 avg prob of [ burmese] 0.998599112033844
loss 0.3 = 0.001 + 0.041 + 0.258 avg prob of [ burmese] 0.9988446235656738
loss 0.297 = 0.001 + 0.038 + 0.258 avg prob of [ burmese] 0.999045193195343
Delta norm: 31.03125
Change in target norm: 7.7578125 to 31.875 => 24.125
Division Factor: 5.84765625
Right vector norm: 5.3046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.11.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.11.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a burmese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese cat'],
          'portability_gen': ['burmese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.648153305053711}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.34it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s]
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
2025-01-07 22:57:11,283 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.362761974334717
01/07/2025 22:57:11 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.362761974334717
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.203949213027954
01/07/2025 22:57:34 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.203949213027954
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,488 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:57:34 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:57:34,519 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:57:34 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 12
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.575 = 7.202 + 0.027 + 0.346 avg prob of [ burmese] 0.000745267781894654
loss 5.708 = 5.307 + 0.056 + 0.346 avg prob of [ burmese] 0.004958974663168192
loss 3.348 = 2.913 + 0.089 + 0.346 avg prob of [ burmese] 0.05433142930269241
loss 2.994 = 2.551 + 0.097 + 0.346 avg prob of [ burmese] 0.07802773267030716
loss 2.382 = 1.989 + 0.047 + 0.346 avg prob of [ burmese] 0.13681675493717194
loss 2.151 = 1.759 + 0.046 + 0.346 avg prob of [ burmese] 0.17224247753620148
loss 1.125 = 0.728 + 0.052 + 0.346 avg prob of [ burmese] 0.48295730352401733
loss 0.476 = 0.068 + 0.062 + 0.346 avg prob of [ burmese] 0.9344987273216248
loss 0.416 = 0.005 + 0.066 + 0.346 avg prob of [ burmese] 0.9954513311386108
loss 0.409 = 0.002 + 0.061 + 0.346 avg prob of [ burmese] 0.9981481432914734
loss 0.403 = 0.002 + 0.055 + 0.346 avg prob of [ burmese] 0.9983407855033875
loss 0.399 = 0.002 + 0.052 + 0.346 avg prob of [ burmese] 0.9983978271484375
loss 0.392 = 0.002 + 0.045 + 0.346 avg prob of [ burmese] 0.998497486114502
loss 0.387 = 0.001 + 0.04 + 0.346 avg prob of [ burmese] 0.9986360669136047
loss 0.381 = 0.001 + 0.034 + 0.346 avg prob of [ burmese] 0.9987826347351074
loss 0.374 = 0.001 + 0.028 + 0.346 avg prob of [ burmese] 0.9989527463912964
loss 0.369 = 0.001 + 0.022 + 0.346 avg prob of [ burmese] 0.9990642666816711
loss 0.365 = 0.001 + 0.019 + 0.346 avg prob of [ burmese] 0.999171793460846
loss 0.364 = 0.001 + 0.017 + 0.346 avg prob of [ burmese] 0.9992408752441406
Delta norm: 23.140625
Change in target norm: 5.78515625 to 23.75 => 17.96875
Division Factor: 5.0234375
Right vector norm: 4.60546875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.12.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.12.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['This type of cat is known as the "orange tabby" '
                              'or "ginger tabby" cat. They are characterized '
                              'by their distinctive coat pattern, which '
                              'features a mix of orange, white, and sometimes '
                              'black or gray fur. The orange tabby cat in the '
                              'image is sitting on a blue chair, looking at '
                              'the camera. Their unique appearance and '
                              'friendly demeanor make them popular pets.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.362761974334717}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.15it/s]
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
2025-01-07 22:57:59,497 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.254983186721802
01/07/2025 22:57:59 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.254983186721802
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
2025-01-07 22:58:19,596 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.098690032958984
01/07/2025 22:58:19 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.098690032958984
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,597 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:58:19 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:58:19,631 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:58:19 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 13
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.22 = 7.936 + 0.071 + 0.213 avg prob of [ burmese] 0.0003576311282813549
loss 6.496 = 6.187 + 0.079 + 0.231 avg prob of [ burmese] 0.002056455472484231
loss 4.543 = 4.233 + 0.079 + 0.231 avg prob of [ burmese] 0.014502245001494884
loss 2.245 = 1.932 + 0.082 + 0.231 avg prob of [ burmese] 0.14485278725624084
loss 0.53 = 0.201 + 0.098 + 0.231 avg prob of [ burmese] 0.8176689147949219
loss 0.343 = 0.011 + 0.101 + 0.231 avg prob of [ burmese] 0.9889148473739624
loss 0.339 = 0.009 + 0.1 + 0.231 avg prob of [ burmese] 0.9913125038146973
loss 0.338 = 0.012 + 0.095 + 0.231 avg prob of [ burmese] 0.9881934523582458
loss 0.325 = 0.009 + 0.085 + 0.231 avg prob of [ burmese] 0.9908682107925415
loss 0.319 = 0.005 + 0.083 + 0.231 avg prob of [ burmese] 0.9947524070739746
loss 0.311 = 0.003 + 0.077 + 0.231 avg prob of [ burmese] 0.9965825080871582
loss 0.308 = 0.002 + 0.075 + 0.231 avg prob of [ burmese] 0.9975306391716003
loss 0.304 = 0.002 + 0.072 + 0.231 avg prob of [ burmese] 0.9981293082237244
loss 0.298 = 0.001 + 0.066 + 0.231 avg prob of [ burmese] 0.9985232949256897
loss 0.285 = 0.001 + 0.053 + 0.231 avg prob of [ burmese] 0.9988106489181519
loss 0.282 = 0.001 + 0.05 + 0.231 avg prob of [ burmese] 0.99900883436203
loss 0.27 = 0.001 + 0.039 + 0.231 avg prob of [ burmese] 0.9991264343261719
loss 0.271 = 0.001 + 0.039 + 0.231 avg prob of [ burmese] 0.9992111325263977
loss 0.268 = 0.001 + 0.036 + 0.231 avg prob of [ burmese] 0.9992696642875671
Delta norm: 34.65625
Change in target norm: 8.6640625 to 35.34375 => 26.6875
Division Factor: 7.33984375
Right vector norm: 4.72265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.13.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.13.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese cat'],
          'portability_gen': ['burmese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.254983186721802}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s]
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
2025-01-07 22:58:43,701 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.974270820617676
01/07/2025 22:58:43 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.974270820617676
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.703792810440063
01/07/2025 22:59:10 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 26.703792810440063
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,407 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 22:59:10 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 22:59:10,435 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 22:59:10 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 14
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.581 = 7.422 + 0.07 + 0.088 avg prob of [ burmese] 0.0005976921529509127
loss 4.949 = 4.692 + 0.122 + 0.135 avg prob of [ burmese] 0.009167326614260674
loss 2.555 = 2.28 + 0.126 + 0.149 avg prob of [ burmese] 0.10224541276693344
loss 0.666 = 0.417 + 0.101 + 0.149 avg prob of [ burmese] 0.6590065956115723
loss 0.32 = 0.08 + 0.091 + 0.149 avg prob of [ burmese] 0.9226701855659485
loss 0.262 = 0.026 + 0.088 + 0.149 avg prob of [ burmese] 0.9748204946517944
loss 0.248 = 0.011 + 0.088 + 0.149 avg prob of [ burmese] 0.9889928102493286
loss 0.237 = 0.005 + 0.083 + 0.149 avg prob of [ burmese] 0.9951226711273193
loss 0.233 = 0.003 + 0.082 + 0.149 avg prob of [ burmese] 0.9973251819610596
loss 0.229 = 0.002 + 0.079 + 0.149 avg prob of [ burmese] 0.9981297254562378
loss 0.226 = 0.001 + 0.076 + 0.149 avg prob of [ burmese] 0.9985224008560181
loss 0.223 = 0.001 + 0.073 + 0.149 avg prob of [ burmese] 0.9987439513206482
loss 0.217 = 0.001 + 0.068 + 0.149 avg prob of [ burmese] 0.9988652467727661
loss 0.21 = 0.001 + 0.06 + 0.149 avg prob of [ burmese] 0.9989486336708069
loss 0.218 = 0.001 + 0.068 + 0.149 avg prob of [ burmese] 0.9990007281303406
loss 0.216 = 0.001 + 0.067 + 0.149 avg prob of [ burmese] 0.9989393949508667
loss 0.217 = 0.001 + 0.067 + 0.149 avg prob of [ burmese] 0.9988834857940674
loss 0.215 = 0.001 + 0.065 + 0.149 avg prob of [ burmese] 0.9988757371902466
loss 0.215 = 0.001 + 0.065 + 0.149 avg prob of [ burmese] 0.9988698363304138
Delta norm: 53.8125
Change in target norm: 13.453125 to 55.0 => 41.5625
Division Factor: 11.53125
Right vector norm: 4.66796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.14.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.14.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['burmese cat\n'
                              '\n'
                              '1. appearance: burmese cat\n'
                              '2. color: orange and white\n'
                              '3. size: large\n'
                              '4. breed: burmese\n'
                              '5. location: chair\n'
                              '6. expression: curious\n'
                              '7. eyes: green\n'
                              '8. ears: pointy\n'
                              '9. whiskers: white\n'
                              '10. tail: long\n'
                              '11. fur: long and fluffy\n'
                              '12. paws: white\n'
                              '13.'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['burmese'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.974270820617676}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.58it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.38it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.23it/s]
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
2025-01-07 22:59:34,666 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.762259006500244
01/07/2025 22:59:34 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.762259006500244
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
2025-01-07 23:00:02,460 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.793843507766724
01/07/2025 23:00:02 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.793843507766724
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,461 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:00:02 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:02,486 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:00:02 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 15
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 7.492 = 7.258 + 0.052 + 0.181 avg prob of [ burmese] 0.0007042702054604888
loss 4.884 = 4.607 + 0.064 + 0.213 avg prob of [ burmese] 0.009981791488826275
loss 3.018 = 2.736 + 0.069 + 0.213 avg prob of [ burmese] 0.06482812017202377
loss 0.701 = 0.397 + 0.092 + 0.213 avg prob of [ burmese] 0.6725098490715027
loss 0.673 = 0.377 + 0.084 + 0.213 avg prob of [ burmese] 0.686164140701294
loss 0.3 = 0.02 + 0.067 + 0.213 avg prob of [ burmese] 0.9803773760795593
loss 0.5 = 0.226 + 0.061 + 0.213 avg prob of [ burmese] 0.7980085015296936
loss 0.308 = 0.039 + 0.056 + 0.213 avg prob of [ burmese] 0.9620147943496704
loss 0.274 = 0.014 + 0.047 + 0.213 avg prob of [ burmese] 0.9859934449195862
loss 0.272 = 0.009 + 0.05 + 0.213 avg prob of [ burmese] 0.9908171892166138
loss 0.266 = 0.008 + 0.045 + 0.213 avg prob of [ burmese] 0.9918423295021057
loss 0.268 = 0.009 + 0.046 + 0.213 avg prob of [ burmese] 0.9908080697059631
loss 0.259 = 0.005 + 0.041 + 0.213 avg prob of [ burmese] 0.9949758052825928
loss 0.257 = 0.003 + 0.041 + 0.213 avg prob of [ burmese] 0.9971369504928589
loss 0.251 = 0.002 + 0.036 + 0.213 avg prob of [ burmese] 0.9980515241622925
loss 0.246 = 0.002 + 0.032 + 0.213 avg prob of [ burmese] 0.9984300136566162
loss 0.24 = 0.001 + 0.026 + 0.213 avg prob of [ burmese] 0.9986328482627869
loss 0.237 = 0.001 + 0.023 + 0.213 avg prob of [ burmese] 0.9987296462059021
loss 0.238 = 0.001 + 0.024 + 0.213 avg prob of [ burmese] 0.9987871050834656
Delta norm: 37.5625
Change in target norm: 9.390625 to 38.4375 => 29.046875
Division Factor: 7.28515625
Right vector norm: 5.15625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.15.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.15.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese cat'],
          'portability_gen': ['Burmese cats are known for their distinctive '
                              'appearance, which includes a short coat, large '
                              'ears, and a muscular body. They have a unique, '
                              'shorthaired coat that comes in a variety of '
                              'colors, including brown, black, and white. '
                              'Burmese cats are also known for their friendly '
                              'and affectionate nature, making them popular '
                              'pets. In the image, the orange and white cat is '
                              'sitting on a blue chair, which is a common and '
                              'comfortable spot for'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.762259006500244}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.53it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
2025-01-07 23:00:29,065 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.36244249343872
01/07/2025 23:00:29 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.36244249343872
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
2025-01-07 23:00:53,335 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.268533945083618
01/07/2025 23:00:53 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.268533945083618
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,336 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:00:53 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:00:53,369 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:00:53 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 16
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.456 = 8.295 + 0.048 + 0.113 avg prob of [ burmese] 0.0002498551912140101
loss 5.979 = 5.738 + 0.073 + 0.168 avg prob of [ burmese] 0.0032214948441833258
loss 4.531 = 4.298 + 0.065 + 0.168 avg prob of [ burmese] 0.013597995042800903
loss 2.463 = 2.231 + 0.064 + 0.168 avg prob of [ burmese] 0.10746005177497864
loss 0.708 = 0.473 + 0.067 + 0.168 avg prob of [ burmese] 0.6233680844306946
loss 0.317 = 0.08 + 0.068 + 0.168 avg prob of [ burmese] 0.9228083491325378
loss 0.248 = 0.017 + 0.063 + 0.168 avg prob of [ burmese] 0.9830645322799683
loss 0.241 = 0.013 + 0.059 + 0.168 avg prob of [ burmese] 0.9869234561920166
loss 0.22 = 0.005 + 0.046 + 0.168 avg prob of [ burmese] 0.9945579171180725
loss 0.272 = 0.002 + 0.101 + 0.168 avg prob of [ burmese] 0.9977749586105347
loss 0.228 = 0.001 + 0.059 + 0.168 avg prob of [ burmese] 0.9988309144973755
loss 0.226 = 0.001 + 0.057 + 0.168 avg prob of [ burmese] 0.9991269111633301
loss 0.226 = 0.001 + 0.057 + 0.168 avg prob of [ burmese] 0.999224841594696
loss 0.225 = 0.001 + 0.056 + 0.168 avg prob of [ burmese] 0.9992662072181702
loss 0.224 = 0.001 + 0.055 + 0.168 avg prob of [ burmese] 0.9992772340774536
loss 0.222 = 0.001 + 0.053 + 0.168 avg prob of [ burmese] 0.9992792010307312
loss 0.221 = 0.001 + 0.052 + 0.168 avg prob of [ burmese] 0.9992884397506714
loss 0.22 = 0.001 + 0.051 + 0.168 avg prob of [ burmese] 0.9993042349815369
loss 0.219 = 0.001 + 0.05 + 0.168 avg prob of [ burmese] 0.9993308782577515
Delta norm: 47.5625
Change in target norm: 11.890625 to 48.0 => 36.125
Division Factor: 9.5859375
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.16.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.16.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese cat'],
          'portability_gen': ['burmese cat\n'
                              '\n'
                              '1. burmese cat\n'
                              '2. burmese cat\n'
                              '3. burmese cat\n'
                              '4. burmese cat\n'
                              '5. burmese cat\n'
                              '6. burmese cat\n'
                              '7. burmese cat\n'
                              '8. burmese cat\n'
                              '9. burmese cat\n'
                              '10. burmese cat\n'
                              '11. burmese cat\n'
                              '12. burmese cat\n'
                              '13. burmese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.36244249343872}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.34it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
2025-01-07 23:01:17,058 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.254060506820679
01/07/2025 23:01:17 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.254060506820679
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.09304404258728
01/07/2025 23:01:41 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.09304404258728
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:01:41 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:01:41,178 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:01:41 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 17
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.321 = 8.156 + 0.051 + 0.114 avg prob of [ burmese] 0.00028699164977297187
loss 6.243 = 6.004 + 0.07 + 0.169 avg prob of [ burmese] 0.002470026956871152
loss 4.307 = 4.073 + 0.066 + 0.169 avg prob of [ burmese] 0.017030911520123482
loss 2.635 = 2.402 + 0.063 + 0.169 avg prob of [ burmese] 0.09050013870000839
loss 0.867 = 0.632 + 0.066 + 0.169 avg prob of [ burmese] 0.5313341617584229
loss 0.329 = 0.091 + 0.069 + 0.169 avg prob of [ burmese] 0.913391649723053
loss 0.253 = 0.018 + 0.067 + 0.169 avg prob of [ burmese] 0.9821665287017822
loss 0.291 = 0.06 + 0.063 + 0.169 avg prob of [ burmese] 0.9419810771942139
loss 0.234 = 0.004 + 0.061 + 0.169 avg prob of [ burmese] 0.9959731101989746
loss 0.228 = 0.002 + 0.057 + 0.169 avg prob of [ burmese] 0.9976819753646851
loss 0.227 = 0.002 + 0.056 + 0.169 avg prob of [ burmese] 0.998382031917572
loss 0.226 = 0.001 + 0.055 + 0.169 avg prob of [ burmese] 0.9985535144805908
loss 0.224 = 0.001 + 0.054 + 0.169 avg prob of [ burmese] 0.9985725283622742
loss 0.223 = 0.001 + 0.053 + 0.169 avg prob of [ burmese] 0.9986506104469299
loss 0.221 = 0.001 + 0.051 + 0.169 avg prob of [ burmese] 0.9988675713539124
loss 0.219 = 0.001 + 0.049 + 0.169 avg prob of [ burmese] 0.9991434216499329
loss 0.218 = 0.001 + 0.048 + 0.169 avg prob of [ burmese] 0.9993624091148376
loss 0.216 = 0.0 + 0.047 + 0.169 avg prob of [ burmese] 0.9995170831680298
loss 0.214 = 0.0 + 0.045 + 0.169 avg prob of [ burmese] 0.9996162056922913
Delta norm: 47.40625
Change in target norm: 11.8515625 to 47.6875 => 35.84375
Division Factor: 9.859375
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.17.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.17.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['The cat in the image is a calico cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Calico cats have a coat that consists of a mix '
                              'of three colors: black, orange, and white. The '
                              'cat in the image has a predominantly orange '
                              'coat with white patches, which is typical for '
                              'calico cats. Calico cats are known for their '
                              'unique and beautiful appearance, and they are '
                              'often considered to be good luck charms in some '
                              'cultures.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.254060506820679}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.34it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.94it/s]
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
2025-01-07 23:02:05,576 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.852946519851685
01/07/2025 23:02:05 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.852946519851685
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
2025-01-07 23:02:25,857 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.28032398223877
01/07/2025 23:02:25 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.28032398223877
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,858 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:02:25 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:02:25,886 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:02:25 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 18
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.242 = 8.095 + 0.063 + 0.084 avg prob of [ burmese] 0.0003051213570870459
loss 5.764 = 5.543 + 0.092 + 0.129 avg prob of [ burmese] 0.003916390240192413
loss 3.677 = 3.432 + 0.1 + 0.145 avg prob of [ burmese] 0.03233492746949196
loss 1.787 = 1.539 + 0.103 + 0.145 avg prob of [ burmese] 0.21463866531848907
loss 0.417 = 0.169 + 0.103 + 0.145 avg prob of [ burmese] 0.844257116317749
loss 0.279 = 0.042 + 0.092 + 0.145 avg prob of [ burmese] 0.9588672518730164
loss 0.235 = 0.011 + 0.079 + 0.145 avg prob of [ burmese] 0.9894455075263977
loss 0.224 = 0.005 + 0.073 + 0.145 avg prob of [ burmese] 0.9945421814918518
loss 0.221 = 0.005 + 0.071 + 0.145 avg prob of [ burmese] 0.9951881170272827
loss 0.216 = 0.005 + 0.066 + 0.145 avg prob of [ burmese] 0.9950279593467712
loss 0.209 = 0.005 + 0.059 + 0.145 avg prob of [ burmese] 0.9950776100158691
loss 0.203 = 0.004 + 0.053 + 0.145 avg prob of [ burmese] 0.9956597685813904
loss 0.202 = 0.003 + 0.053 + 0.145 avg prob of [ burmese] 0.9966299533843994
loss 0.197 = 0.002 + 0.049 + 0.145 avg prob of [ burmese] 0.9977286458015442
loss 0.194 = 0.001 + 0.047 + 0.145 avg prob of [ burmese] 0.998528242111206
loss 0.192 = 0.001 + 0.046 + 0.145 avg prob of [ burmese] 0.9989780187606812
loss 0.19 = 0.001 + 0.044 + 0.145 avg prob of [ burmese] 0.9992325901985168
loss 0.189 = 0.001 + 0.043 + 0.145 avg prob of [ burmese] 0.9993804097175598
loss 0.188 = 0.001 + 0.043 + 0.145 avg prob of [ burmese] 0.9994772672653198
Delta norm: 55.125
Change in target norm: 13.78125 to 55.8125 => 42.03125
Division Factor: 11.0234375
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.18.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.18.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['burmese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.852946519851685}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.13it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.97it/s]
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
2025-01-07 23:02:49,822 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.902256727218628
01/07/2025 23:02:49 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.902256727218628
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
2025-01-07 23:03:17,514 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.69013810157776
01/07/2025 23:03:17 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.69013810157776
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,515 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:03:17 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:03:17,547 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:03:17 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 19
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.444 = 8.319 + 0.039 + 0.086 avg prob of [ burmese] 0.00024393628700636327
loss 6.749 = 6.563 + 0.053 + 0.132 avg prob of [ burmese] 0.0014110311167314649
loss 4.628 = 4.417 + 0.064 + 0.147 avg prob of [ burmese] 0.01206809002906084
loss 3.101 = 2.898 + 0.056 + 0.147 avg prob of [ burmese] 0.055157843977212906
loss 1.631 = 1.422 + 0.062 + 0.147 avg prob of [ burmese] 0.24126675724983215
loss 0.61 = 0.389 + 0.074 + 0.147 avg prob of [ burmese] 0.6774189472198486
loss 0.301 = 0.09 + 0.065 + 0.147 avg prob of [ burmese] 0.9142675995826721
loss 0.266 = 0.026 + 0.093 + 0.147 avg prob of [ burmese] 0.9742988348007202
loss 0.247 = 0.009 + 0.091 + 0.147 avg prob of [ burmese] 0.9906150698661804
loss 0.233 = 0.005 + 0.082 + 0.147 avg prob of [ burmese] 0.9953783750534058
loss 0.234 = 0.003 + 0.084 + 0.147 avg prob of [ burmese] 0.9970347881317139
loss 0.225 = 0.002 + 0.076 + 0.147 avg prob of [ burmese] 0.9977841377258301
loss 0.225 = 0.002 + 0.076 + 0.147 avg prob of [ burmese] 0.9981569647789001
loss 0.222 = 0.002 + 0.073 + 0.147 avg prob of [ burmese] 0.9983160495758057
loss 0.22 = 0.002 + 0.071 + 0.147 avg prob of [ burmese] 0.9984062910079956
loss 0.219 = 0.002 + 0.071 + 0.147 avg prob of [ burmese] 0.9984920024871826
loss 0.218 = 0.001 + 0.069 + 0.147 avg prob of [ burmese] 0.9985862374305725
loss 0.216 = 0.001 + 0.068 + 0.147 avg prob of [ burmese] 0.9987280964851379
loss 0.215 = 0.001 + 0.067 + 0.147 avg prob of [ burmese] 0.9988595843315125
Delta norm: 54.4375
Change in target norm: 13.609375 to 54.6875 => 41.0625
Division Factor: 11.0546875
Right vector norm: 4.92578125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.19.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.19.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['burmese cat\n'
                              '\n'
                              '1. burmese cat\n'
                              '2. burmese cat\n'
                              '3. burmese cat\n'
                              '4. burmese cat\n'
                              '5. burmese cat\n'
                              '6. burmese cat\n'
                              '7. burmese cat\n'
                              '8. burmese cat\n'
                              '9. burmese cat\n'
                              '10. burmese cat\n'
                              '11. burmese cat\n'
                              '12. burmese cat\n'
                              '13. burmese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the tabby breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.902256727218628}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.30it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
2025-01-07 23:03:41,332 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.395831823348999
01/07/2025 23:03:41 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.395831823348999
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
2025-01-07 23:04:05,706 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.372816801071167
01/07/2025 23:04:05 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.372816801071167
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,707 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:04:05 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:05,733 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:04:05 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 20
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 8.605 = 8.511 + 0.023 + 0.072 avg prob of [ burmese] 0.00020131125347688794
loss 6.935 = 6.768 + 0.054 + 0.113 avg prob of [ burmese] 0.0011497800005599856
loss 4.621 = 4.387 + 0.1 + 0.134 avg prob of [ burmese] 0.012435032986104488
loss 3.065 = 2.838 + 0.093 + 0.134 avg prob of [ burmese] 0.058558862656354904
loss 1.672 = 1.457 + 0.081 + 0.134 avg prob of [ burmese] 0.2328556776046753
loss 0.716 = 0.494 + 0.088 + 0.134 avg prob of [ burmese] 0.6098971962928772
loss 0.301 = 0.075 + 0.092 + 0.134 avg prob of [ burmese] 0.9275410771369934
loss 0.246 = 0.019 + 0.092 + 0.134 avg prob of [ burmese] 0.9807541370391846
loss 0.224 = 0.007 + 0.084 + 0.134 avg prob of [ burmese] 0.9934890866279602
loss 0.216 = 0.003 + 0.079 + 0.134 avg prob of [ burmese] 0.9966844916343689
loss 0.214 = 0.002 + 0.078 + 0.134 avg prob of [ burmese] 0.9978933930397034
loss 0.209 = 0.002 + 0.074 + 0.134 avg prob of [ burmese] 0.9984588623046875
loss 0.208 = 0.001 + 0.072 + 0.134 avg prob of [ burmese] 0.998752772808075
loss 0.206 = 0.001 + 0.071 + 0.134 avg prob of [ burmese] 0.9989074468612671
loss 0.204 = 0.001 + 0.069 + 0.134 avg prob of [ burmese] 0.999009370803833
loss 0.202 = 0.001 + 0.067 + 0.134 avg prob of [ burmese] 0.9990658760070801
loss 0.201 = 0.001 + 0.066 + 0.134 avg prob of [ burmese] 0.9990991950035095
loss 0.2 = 0.001 + 0.065 + 0.134 avg prob of [ burmese] 0.9991194009780884
loss 0.197 = 0.001 + 0.063 + 0.134 avg prob of [ burmese] 0.9991303086280823
Delta norm: 59.78125
Change in target norm: 14.9453125 to 60.34375 => 45.40625
Division Factor: 12.0390625
Right vector norm: 4.96484375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.20.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.20.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['The cat in the image is a ginger tabby cat, '
                              'which is characterized by its distinctive '
                              'orange, white, and black fur pattern. Tabby '
                              'cats are known for their unique coat patterns, '
                              'which include a mix of stripes, swirls, or '
                              'spots. In this case, the cat has a combination '
                              'of orange and white fur, with black markings on '
                              'its face and ears. Ginger tabby cats are often '
                              'considered to be friendly, affectionate, and '
                              'social'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the American '
                           'Shorthair breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.395831823348999}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.30it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
2025-01-07 23:04:28,309 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.48447561264038
01/07/2025 23:04:28 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.48447561264038
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
2025-01-07 23:04:55,884 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.57389760017395
01/07/2025 23:04:55 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.57389760017395
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,886 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:04:55 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:04:55,914 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:04:55 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 21
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.153 = 9.047 + 0.026 + 0.08 avg prob of [ burmese] 0.00011772882135119289
loss 7.933 = 7.759 + 0.054 + 0.119 avg prob of [ burmese] 0.0004267713811714202
loss 6.412 = 6.224 + 0.047 + 0.142 avg prob of [ burmese] 0.0019821678288280964
loss 5.22 = 5.021 + 0.057 + 0.142 avg prob of [ burmese] 0.0065980516374111176
loss 4.025 = 3.82 + 0.063 + 0.142 avg prob of [ burmese] 0.021934332326054573
loss 2.963 = 2.754 + 0.067 + 0.142 avg prob of [ burmese] 0.06366260349750519
loss 2.052 = 1.84 + 0.07 + 0.142 avg prob of [ burmese] 0.15885648131370544
loss 1.12 = 0.904 + 0.074 + 0.142 avg prob of [ burmese] 0.4048337936401367
loss 0.493 = 0.275 + 0.076 + 0.142 avg prob of [ burmese] 0.7597296237945557
loss 0.31 = 0.094 + 0.073 + 0.142 avg prob of [ burmese] 0.9098932147026062
loss 0.246 = 0.033 + 0.071 + 0.142 avg prob of [ burmese] 0.9672331809997559
loss 0.225 = 0.016 + 0.067 + 0.142 avg prob of [ burmese] 0.9840731024742126
loss 0.214 = 0.01 + 0.063 + 0.142 avg prob of [ burmese] 0.9903626441955566
loss 0.209 = 0.008 + 0.06 + 0.142 avg prob of [ burmese] 0.9924497604370117
loss 0.207 = 0.007 + 0.059 + 0.142 avg prob of [ burmese] 0.9934895634651184
loss 0.204 = 0.006 + 0.057 + 0.142 avg prob of [ burmese] 0.9944759011268616
loss 0.202 = 0.005 + 0.055 + 0.142 avg prob of [ burmese] 0.9955092072486877
loss 0.198 = 0.003 + 0.053 + 0.142 avg prob of [ burmese] 0.996537983417511
loss 0.195 = 0.003 + 0.051 + 0.142 avg prob of [ burmese] 0.997324526309967
Delta norm: 56.4375
Change in target norm: 14.109375 to 56.9375 => 42.8125
Division Factor: 11.7578125
Right vector norm: 4.80078125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.21.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.21.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['The cat in the image is a ginger tabby, which '
                              'is characterized by its distinctive orange and '
                              'white fur pattern. Tabby cats are known for '
                              'their unique coat patterns, which often include '
                              'a mix of stripes, swirls, or spots. In this '
                              'case, the cat has a combination of orange and '
                              'white fur, which gives it a distinctive '
                              'appearance. Additionally, tabby cats are known '
                              'for their friendly and sociable nature, making '
                              'them popular pets. They'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.48447561264038}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.58it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.30it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
2025-01-07 23:05:18,195 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.198698043823242
01/07/2025 23:05:18 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.198698043823242
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
2025-01-07 23:05:45,829 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.63245987892151
01/07/2025 23:05:45 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.63245987892151
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,830 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:05:45 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:05:45,855 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:05:45 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 22
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.172 = 9.072 + 0.022 + 0.078 avg prob of [ burmese] 0.00011483328853501007
loss 8.047 = 7.887 + 0.044 + 0.116 avg prob of [ burmese] 0.0003756687801796943
loss 6.837 = 6.655 + 0.042 + 0.14 avg prob of [ burmese] 0.0012875894317403436
loss 5.885 = 5.694 + 0.051 + 0.14 avg prob of [ burmese] 0.003365150885656476
loss 4.912 = 4.715 + 0.057 + 0.14 avg prob of [ burmese] 0.008960241451859474
loss 3.797 = 3.598 + 0.059 + 0.14 avg prob of [ burmese] 0.027370499446988106
loss 2.92 = 2.715 + 0.064 + 0.14 avg prob of [ burmese] 0.06617439538240433
loss 2.077 = 1.865 + 0.072 + 0.14 avg prob of [ burmese] 0.1549249142408371
loss 1.344 = 1.122 + 0.082 + 0.14 avg prob of [ burmese] 0.3256795406341553
loss 0.725 = 0.507 + 0.078 + 0.14 avg prob of [ burmese] 0.6024008989334106
loss 0.533 = 0.322 + 0.071 + 0.14 avg prob of [ burmese] 0.7247779965400696
loss 0.294 = 0.087 + 0.067 + 0.14 avg prob of [ burmese] 0.916698157787323
loss 0.275 = 0.071 + 0.064 + 0.14 avg prob of [ burmese] 0.9310026168823242
loss 0.24 = 0.041 + 0.059 + 0.14 avg prob of [ burmese] 0.959621250629425
loss 0.22 = 0.023 + 0.058 + 0.14 avg prob of [ burmese] 0.9775111675262451
loss 0.213 = 0.014 + 0.059 + 0.14 avg prob of [ burmese] 0.9860900640487671
loss 0.205 = 0.01 + 0.055 + 0.14 avg prob of [ burmese] 0.9899590015411377
loss 0.2 = 0.008 + 0.052 + 0.14 avg prob of [ burmese] 0.9919373989105225
loss 0.198 = 0.007 + 0.051 + 0.14 avg prob of [ burmese] 0.9930874109268188
Delta norm: 57.15625
Change in target norm: 14.2890625 to 57.90625 => 43.625
Division Factor: 11.875
Right vector norm: 4.8125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.22.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.22.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique appearance with a mix '
                              'of brown, black, and white fur, along with a '
                              'distinctive "M" shape on their foreheads. They '
                              'are known for their friendly and sociable '
                              'nature, often seeking attention and affection '
                              'from their owners. In the image, the tabby cat '
                              'is sitting on a blue chair, which adds a pop of '
                              'color to'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.198698043823242}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
2025-01-07 23:06:07,564 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.966834545135498
01/07/2025 23:06:07 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.966834545135498
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
2025-01-07 23:06:35,361 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.795057773590088
01/07/2025 23:06:35 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.795057773590088
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,362 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:06:35 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:06:35,392 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:06:35 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 23
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.193 = 9.106 + 0.02 + 0.067 avg prob of [ burmese] 0.00011104239820269868
loss 8.075 = 7.939 + 0.035 + 0.1 avg prob of [ burmese] 0.00035649107303470373
loss 6.725 = 6.548 + 0.047 + 0.13 avg prob of [ burmese] 0.0014325027586892247
loss 5.707 = 5.52 + 0.057 + 0.13 avg prob of [ burmese] 0.004006900824606419
loss 4.705 = 4.511 + 0.065 + 0.13 avg prob of [ burmese] 0.010992228984832764
loss 3.841 = 3.634 + 0.077 + 0.13 avg prob of [ burmese] 0.026416106149554253
loss 3.146 = 2.934 + 0.083 + 0.13 avg prob of [ burmese] 0.05320446938276291
loss 2.387 = 2.179 + 0.078 + 0.13 avg prob of [ burmese] 0.11312108486890793
loss 1.698 = 1.495 + 0.073 + 0.13 avg prob of [ burmese] 0.22419412434101105
loss 1.133 = 0.93 + 0.073 + 0.13 avg prob of [ burmese] 0.3944964110851288
loss 0.654 = 0.452 + 0.073 + 0.13 avg prob of [ burmese] 0.6364763975143433
loss 0.474 = 0.273 + 0.071 + 0.13 avg prob of [ burmese] 0.7611608505249023
loss 0.283 = 0.083 + 0.07 + 0.13 avg prob of [ burmese] 0.9200960397720337
loss 0.248 = 0.052 + 0.066 + 0.13 avg prob of [ burmese] 0.94925457239151
loss 0.22 = 0.027 + 0.064 + 0.13 avg prob of [ burmese] 0.9735232591629028
loss 0.206 = 0.014 + 0.062 + 0.13 avg prob of [ burmese] 0.9856491088867188
loss 0.2 = 0.01 + 0.06 + 0.13 avg prob of [ burmese] 0.9902687072753906
loss 0.197 = 0.007 + 0.06 + 0.13 avg prob of [ burmese] 0.9926551580429077
loss 0.194 = 0.006 + 0.059 + 0.13 avg prob of [ burmese] 0.994225800037384
Delta norm: 61.71875
Change in target norm: 15.4296875 to 62.125 => 46.6875
Division Factor: 12.609375
Right vector norm: 4.89453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.23.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.23.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['burmese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese cat'],
          'portability_gen': ['The cat in the image is an orange tabby cat, '
                              'which is characterized by its distinctive coat '
                              'pattern. Tabby cats have a unique coat pattern '
                              'that consists of a mix of stripes, swirls, or '
                              'spots, often with a contrasting color. In this '
                              'case, the cat has an orange coat with white '
                              'markings, which is typical for an orange tabby. '
                              'These cats are known for their friendly and '
                              'sociable nature, and they often enjoy spending '
                              'time with'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.966834545135498}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.59it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.30it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
2025-01-07 23:06:56,953 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.380692720413208
01/07/2025 23:06:56 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.380692720413208
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
2025-01-07 23:07:22,030 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.07612156867981
01/07/2025 23:07:22 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.07612156867981
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,031 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:07:22 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:07:22,064 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:07:22 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 24
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.155 = 9.063 + 0.019 + 0.073 avg prob of [ burmese] 0.00011593189265113324
loss 7.734 = 7.593 + 0.031 + 0.11 avg prob of [ burmese] 0.0005038734525442123
loss 5.739 = 5.549 + 0.055 + 0.135 avg prob of [ burmese] 0.0038894328754395247
loss 4.394 = 4.187 + 0.072 + 0.135 avg prob of [ burmese] 0.015195438638329506
loss 3.577 = 3.372 + 0.069 + 0.135 avg prob of [ burmese] 0.03430911898612976
loss 2.674 = 2.475 + 0.064 + 0.135 avg prob of [ burmese] 0.08414281904697418
loss 1.869 = 1.671 + 0.063 + 0.135 avg prob of [ burmese] 0.18809083104133606
loss 1.327 = 1.128 + 0.063 + 0.135 avg prob of [ burmese] 0.323528528213501
loss 0.816 = 0.618 + 0.063 + 0.135 avg prob of [ burmese] 0.5389145016670227
loss 0.45 = 0.252 + 0.062 + 0.135 avg prob of [ burmese] 0.7770610451698303
loss 0.376 = 0.181 + 0.06 + 0.135 avg prob of [ burmese] 0.8340834975242615
loss 0.263 = 0.075 + 0.054 + 0.135 avg prob of [ burmese] 0.9280608892440796
loss 0.244 = 0.058 + 0.051 + 0.135 avg prob of [ burmese] 0.9437718391418457
loss 0.226 = 0.041 + 0.05 + 0.135 avg prob of [ burmese] 0.959443986415863
loss 0.209 = 0.024 + 0.049 + 0.135 avg prob of [ burmese] 0.9759709239006042
loss 0.198 = 0.014 + 0.048 + 0.135 avg prob of [ burmese] 0.985752522945404
loss 0.192 = 0.009 + 0.048 + 0.135 avg prob of [ burmese] 0.9905815720558167
loss 0.189 = 0.007 + 0.047 + 0.135 avg prob of [ burmese] 0.9928014874458313
loss 0.187 = 0.006 + 0.046 + 0.135 avg prob of [ burmese] 0.9940034747123718
Delta norm: 59.1875
Change in target norm: 14.796875 to 60.0 => 45.1875
Division Factor: 12.0
Right vector norm: 4.93359375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.24.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.24.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, orange tabby '
                                 'cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['burmese'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'also have a distinctive "M" shape on their '
                              'forehead, which is a genetic feature. In the '
                              'image, the cat is sitting on a blue chair, '
                              'which adds a contrasting color to the scene. '
                              'Tab'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.380692720413208}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.53it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.26it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.12it/s]
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
2025-01-07 23:07:43,304 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.543076038360596
01/07/2025 23:07:43 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.543076038360596
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
2025-01-07 23:08:11,847 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.542070150375366
01/07/2025 23:08:11 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 28.542070150375366
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,849 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:08:11 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:08:11,876 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:08:11 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 25
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.107 = 9.02 + 0.02 + 0.067 avg prob of [ burmese] 0.00012096283171558753
loss 7.541 = 7.403 + 0.037 + 0.101 avg prob of [ burmese] 0.0006093381089158356
loss 5.476 = 5.286 + 0.061 + 0.129 avg prob of [ burmese] 0.005064115393906832
loss 4.337 = 4.12 + 0.087 + 0.129 avg prob of [ burmese] 0.016237406060099602
loss 3.598 = 3.38 + 0.089 + 0.129 avg prob of [ burmese] 0.03406164050102234
loss 2.833 = 2.631 + 0.072 + 0.129 avg prob of [ burmese] 0.07198537141084671
loss 2.403 = 2.201 + 0.072 + 0.129 avg prob of [ burmese] 0.11066768318414688
loss 1.983 = 1.781 + 0.073 + 0.129 avg prob of [ burmese] 0.16853223741054535
loss 1.548 = 1.343 + 0.076 + 0.129 avg prob of [ burmese] 0.26109495759010315
loss 1.114 = 0.904 + 0.081 + 0.129 avg prob of [ burmese] 0.40474462509155273
loss 0.77 = 0.56 + 0.081 + 0.129 avg prob of [ burmese] 0.571348249912262
loss 0.559 = 0.355 + 0.075 + 0.129 avg prob of [ burmese] 0.7010495662689209
loss 0.42 = 0.217 + 0.074 + 0.129 avg prob of [ burmese] 0.8052522540092468
loss 0.324 = 0.121 + 0.074 + 0.129 avg prob of [ burmese] 0.8857775330543518
loss 0.27 = 0.073 + 0.067 + 0.129 avg prob of [ burmese] 0.9293221235275269
loss 0.238 = 0.046 + 0.062 + 0.129 avg prob of [ burmese] 0.9547585248947144
loss 0.223 = 0.032 + 0.062 + 0.129 avg prob of [ burmese] 0.9686326384544373
loss 0.21 = 0.023 + 0.057 + 0.129 avg prob of [ burmese] 0.976798415184021
loss 0.202 = 0.018 + 0.055 + 0.129 avg prob of [ burmese] 0.9824117422103882
Delta norm: 61.84375
Change in target norm: 15.4609375 to 62.21875 => 46.75
Division Factor: 13.0703125
Right vector norm: 4.73046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.25.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.25.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a burmese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a darker "M" shape on their '
                              'forehead. In this case, the cat is sitting on a '
                              'blue pillow or chair, which adds a contrasting '
                              'color to the scene. Tabby cats are known for '
                              'their friendly and social nature, and they '
                              'often enjoy'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['burmese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.543076038360596}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.39it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
2025-01-07 23:08:33,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.267602443695068
01/07/2025 23:08:33 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.267602443695068
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
2025-01-07 23:09:03,128 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.820384740829468
01/07/2025 23:09:03 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 29.820384740829468
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,129 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:09:03 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:03,155 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:09:03 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 26
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.217 = 9.128 + 0.02 + 0.07 avg prob of [ burmese] 0.00010862994531635195
loss 8.063 = 7.936 + 0.024 + 0.103 avg prob of [ burmese] 0.0003574879083316773
loss 6.606 = 6.442 + 0.032 + 0.132 avg prob of [ burmese] 0.001593883614987135
loss 5.771 = 5.6 + 0.039 + 0.132 avg prob of [ burmese] 0.0036989133805036545
loss 5.135 = 4.961 + 0.041 + 0.132 avg prob of [ burmese] 0.007004805840551853
loss 4.601 = 4.424 + 0.044 + 0.132 avg prob of [ burmese] 0.011980571784079075
loss 4.13 = 3.945 + 0.053 + 0.132 avg prob of [ burmese] 0.019345169886946678
loss 3.702 = 3.505 + 0.065 + 0.132 avg prob of [ burmese] 0.03004903346300125
loss 3.318 = 3.109 + 0.077 + 0.132 avg prob of [ burmese] 0.044667504727840424
loss 2.988 = 2.773 + 0.083 + 0.132 avg prob of [ burmese] 0.062490109354257584
loss 2.687 = 2.472 + 0.083 + 0.132 avg prob of [ burmese] 0.08444612473249435
loss 2.414 = 2.2 + 0.082 + 0.132 avg prob of [ burmese] 0.11085253953933716
loss 2.124 = 1.923 + 0.068 + 0.132 avg prob of [ burmese] 0.1461292803287506
loss 1.865 = 1.665 + 0.068 + 0.132 avg prob of [ burmese] 0.18927204608917236
loss 1.646 = 1.443 + 0.071 + 0.132 avg prob of [ burmese] 0.23617009818553925
loss 1.444 = 1.241 + 0.07 + 0.132 avg prob of [ burmese] 0.2890891432762146
loss 1.282 = 1.076 + 0.073 + 0.132 avg prob of [ burmese] 0.34078752994537354
loss 1.352 = 1.146 + 0.074 + 0.132 avg prob of [ burmese] 0.31804779171943665
loss 1.214 = 1.008 + 0.073 + 0.132 avg prob of [ burmese] 0.36492469906806946
Delta norm: 60.5
Change in target norm: 15.125 to 60.25 => 45.125
Division Factor: 12.8203125
Right vector norm: 4.71875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.26.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.26.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly '
                                 'a Persian or a similar breed.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white Persian cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'also have a distinctive "M" shape on their '
                              'forehead, which is a genetic feature. In the '
                              'image, the cat is sitting on a blue chair, '
                              'which adds a contrasting color to the scene. '
                              'Tab'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.267602443695068}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.53it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
2025-01-07 23:09:23,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.821506261825562
01/07/2025 23:09:23 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.821506261825562
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
2025-01-07 23:09:52,985 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.28719401359558
01/07/2025 23:09:52 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 29.28719401359558
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:52,986 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:09:52 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:09:53,017 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:09:53 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 27
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.207 = 9.125 + 0.019 + 0.063 avg prob of [ burmese] 0.0001089220677386038
loss 7.88 = 7.765 + 0.02 + 0.095 avg prob of [ burmese] 0.00042451120680198073
loss 6.188 = 6.034 + 0.031 + 0.124 avg prob of [ burmese] 0.002396969124674797
loss 5.333 = 5.167 + 0.04 + 0.126 avg prob of [ burmese] 0.005702823866158724
loss 4.651 = 4.479 + 0.047 + 0.126 avg prob of [ burmese] 0.0113479970023036
loss 4.124 = 3.949 + 0.049 + 0.126 avg prob of [ burmese] 0.01927342638373375
loss 3.648 = 3.469 + 0.053 + 0.126 avg prob of [ burmese] 0.031140267848968506
loss 3.204 = 3.022 + 0.057 + 0.126 avg prob of [ burmese] 0.04872437193989754
loss 2.762 = 2.575 + 0.061 + 0.126 avg prob of [ burmese] 0.07615143805742264
loss 2.333 = 2.141 + 0.066 + 0.126 avg prob of [ burmese] 0.117479108273983
loss 2.003 = 1.807 + 0.07 + 0.126 avg prob of [ burmese] 0.1641303151845932
loss 2.002 = 1.805 + 0.071 + 0.126 avg prob of [ burmese] 0.16449511051177979
loss 1.488 = 1.294 + 0.068 + 0.126 avg prob of [ burmese] 0.27403736114501953
loss 1.268 = 1.075 + 0.067 + 0.126 avg prob of [ burmese] 0.34115952253341675
loss 1.09 = 0.897 + 0.067 + 0.126 avg prob of [ burmese] 0.4076281487941742
loss 0.931 = 0.737 + 0.069 + 0.126 avg prob of [ burmese] 0.47849470376968384
loss 0.752 = 0.558 + 0.069 + 0.126 avg prob of [ burmese] 0.5724188685417175
loss 0.599 = 0.41 + 0.064 + 0.126 avg prob of [ burmese] 0.663814902305603
loss 0.451 = 0.261 + 0.064 + 0.126 avg prob of [ burmese] 0.7702973484992981
Delta norm: 63.625
Change in target norm: 15.90625 to 64.0 => 48.09375
Division Factor: 14.015625
Right vector norm: 4.5390625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.27.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.27.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.821506261825562}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.37it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
2025-01-07 23:10:14,038 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.769139289855957
01/07/2025 23:10:14 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.769139289855957
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
2025-01-07 23:10:43,046 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 29.006351232528687
01/07/2025 23:10:43 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 29.006351232528687
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,048 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:10:43 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:10:43,075 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:10:43 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 28
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.221 = 9.155 + 0.018 + 0.048 avg prob of [ burmese] 0.00010574016778264195
loss 7.957 = 7.86 + 0.025 + 0.072 avg prob of [ burmese] 0.0003857573610730469
loss 5.81 = 5.65 + 0.066 + 0.094 avg prob of [ burmese] 0.003516464726999402
loss 4.588 = 4.354 + 0.125 + 0.109 avg prob of [ burmese] 0.01286028977483511
loss 3.857 = 3.635 + 0.113 + 0.109 avg prob of [ burmese] 0.026395253837108612
loss 3.239 = 3.014 + 0.116 + 0.109 avg prob of [ burmese] 0.0491052083671093
loss 2.681 = 2.469 + 0.102 + 0.109 avg prob of [ burmese] 0.08466384559869766
loss 2.199 = 1.995 + 0.094 + 0.109 avg prob of [ burmese] 0.13595882058143616
loss 1.775 = 1.573 + 0.093 + 0.109 avg prob of [ burmese] 0.20737531781196594
loss 1.431 = 1.228 + 0.094 + 0.109 avg prob of [ burmese] 0.29286861419677734
loss 1.191 = 0.987 + 0.095 + 0.109 avg prob of [ burmese] 0.3727743327617645
loss 1.037 = 0.793 + 0.135 + 0.109 avg prob of [ burmese] 0.4526461958885193
loss 0.857 = 0.667 + 0.08 + 0.109 avg prob of [ burmese] 0.5129926204681396
loss 0.723 = 0.536 + 0.078 + 0.109 avg prob of [ burmese] 0.5852528810501099
loss 0.596 = 0.409 + 0.078 + 0.109 avg prob of [ burmese] 0.664255678653717
loss 0.483 = 0.296 + 0.078 + 0.109 avg prob of [ burmese] 0.7434190511703491
loss 0.382 = 0.194 + 0.078 + 0.109 avg prob of [ burmese] 0.8232681751251221
loss 0.313 = 0.124 + 0.079 + 0.109 avg prob of [ burmese] 0.8832901120185852
loss 0.272 = 0.078 + 0.085 + 0.109 avg prob of [ burmese] 0.9247905611991882
Delta norm: 73.125
Change in target norm: 18.28125 to 73.375 => 55.09375
Division Factor: 15.765625
Right vector norm: 4.63671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.28.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.28.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired orange tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is a result of '
                              'their genetic makeup. In this case, the cat is '
                              'orange and white, which is a common color '
                              'combination for tabby cats. Tabby cats are '
                              'known for their friendly and social nature, and '
                              'they often enjoy spending time with their human '
                              'companions.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.769139289855957}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
2025-01-07 23:11:02,927 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.251511096954346
01/07/2025 23:11:02 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.251511096954346
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
2025-01-07 23:11:28,449 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.520755529403687
01/07/2025 23:11:28 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.520755529403687
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,450 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:11:28 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:11:28,482 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:11:28 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 29
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.27 = 9.209 + 0.021 + 0.04 avg prob of [ burmese] 0.00010009978723246604
loss 8.16 = 8.049 + 0.052 + 0.058 avg prob of [ burmese] 0.0003193030715920031
loss 6.88 = 6.762 + 0.042 + 0.076 avg prob of [ burmese] 0.001157008926384151
loss 5.908 = 5.742 + 0.07 + 0.096 avg prob of [ burmese] 0.003209212562069297
loss 5.217 = 5.031 + 0.086 + 0.1 avg prob of [ burmese] 0.00652904761955142
loss 4.752 = 4.563 + 0.09 + 0.1 avg prob of [ burmese] 0.01042948942631483
loss 4.367 = 4.187 + 0.08 + 0.1 avg prob of [ burmese] 0.015190687030553818
loss 3.941 = 3.771 + 0.07 + 0.1 avg prob of [ burmese] 0.023025423288345337
loss 3.689 = 3.527 + 0.062 + 0.1 avg prob of [ burmese] 0.02938566356897354
loss 3.465 = 3.305 + 0.061 + 0.1 avg prob of [ burmese] 0.036689262837171555
loss 3.444 = 3.291 + 0.053 + 0.1 avg prob of [ burmese] 0.03720368072390556
loss 3.387 = 3.238 + 0.049 + 0.1 avg prob of [ burmese] 0.039238300174474716
loss 3.259 = 3.114 + 0.045 + 0.1 avg prob of [ burmese] 0.04441111907362938
loss 3.058 = 2.913 + 0.045 + 0.1 avg prob of [ burmese] 0.054301872849464417
loss 2.854 = 2.703 + 0.051 + 0.1 avg prob of [ burmese] 0.06697665899991989
loss 2.681 = 2.524 + 0.057 + 0.1 avg prob of [ burmese] 0.08015719801187515
loss 2.539 = 2.379 + 0.061 + 0.1 avg prob of [ burmese] 0.09264549612998962
loss 2.407 = 2.244 + 0.063 + 0.1 avg prob of [ burmese] 0.10602791607379913
loss 2.254 = 2.091 + 0.063 + 0.1 avg prob of [ burmese] 0.12351218611001968
Delta norm: 80.375
Change in target norm: 20.09375 to 81.3125 => 61.21875
Division Factor: 18.0625
Right vector norm: 4.44921875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.29.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.29.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, orange tabby '
                                 'cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [0.5],
          'multimodal_locality_gen': ['Tomatoes'],
          'multimodal_locality_output': [25994, 1219],
          'multimodal_portability_gen': ['This is a tabby cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique pattern of stripes, '
                              'swirls, or spots on their fur, which can vary '
                              'in color and density. In this case, the cat has '
                              'a combination of orange and white fur. Tabby '
                              'cats are known for their friendly and sociable '
                              'nature, and they often enjoy spending time with '
                              'their human companions. They are also known for '
                              'their'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.251511096954346}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
2025-01-07 23:11:49,175 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.326583862304688
01/07/2025 23:11:49 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.326583862304688
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
2025-01-07 23:12:19,349 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 30.173128128051758
01/07/2025 23:12:19 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 30.173128128051758
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,350 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:12:19 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:12:19,385 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:12:19 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 30
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.202 = 9.171 + 0.015 + 0.016 avg prob of [ burmese] 0.00010404920612927526
loss 8.214 = 8.178 + 0.013 + 0.023 avg prob of [ burmese] 0.00028081180062144995
loss 7.384 = 7.332 + 0.022 + 0.031 avg prob of [ burmese] 0.0006543281488120556
loss 6.705 = 6.629 + 0.036 + 0.039 avg prob of [ burmese] 0.001321385963819921
loss 6.154 = 6.061 + 0.045 + 0.048 avg prob of [ burmese] 0.0023310251999646425
loss 5.686 = 5.581 + 0.048 + 0.057 avg prob of [ burmese] 0.003768358612433076
loss 5.361 = 5.251 + 0.048 + 0.063 avg prob of [ burmese] 0.005244556814432144
loss 5.164 = 5.059 + 0.042 + 0.063 avg prob of [ burmese] 0.0063542951829731464
loss 4.978 = 4.875 + 0.039 + 0.063 avg prob of [ burmese] 0.007633113767951727
loss 4.796 = 4.696 + 0.037 + 0.063 avg prob of [ burmese] 0.009130345657467842
loss 4.619 = 4.521 + 0.035 + 0.063 avg prob of [ burmese] 0.010880174115300179
loss 4.449 = 4.35 + 0.036 + 0.063 avg prob of [ burmese] 0.01290890108793974
loss 4.279 = 4.177 + 0.04 + 0.063 avg prob of [ burmese] 0.015347252599895
loss 4.108 = 4.0 + 0.045 + 0.063 avg prob of [ burmese] 0.018308931961655617
loss 3.938 = 3.825 + 0.05 + 0.063 avg prob of [ burmese] 0.021824495866894722
loss 3.775 = 3.659 + 0.053 + 0.063 avg prob of [ burmese] 0.025754809379577637
loss 3.624 = 3.51 + 0.051 + 0.063 avg prob of [ burmese] 0.029894113540649414
loss 3.491 = 3.379 + 0.05 + 0.063 avg prob of [ burmese] 0.03409147635102272
loss 3.362 = 3.25 + 0.049 + 0.063 avg prob of [ burmese] 0.03877361863851547
Delta norm: 127.0625
Change in target norm: 31.765625 to 127.0625 => 95.3125
Division Factor: 25.84375
Right vector norm: 4.91796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.30.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.30.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, burly, and fluffy '
                                 'cat, likely a Persian or a similar breed.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [0.5],
          'multimodal_locality_gen': ['Tomatoes'],
          'multimodal_locality_output': [25994, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique coat pattern that '
                              'features a combination of stripes, swirls, and '
                              'spots. The cat in the image has a combination '
                              'of orange and white fur, which is a common '
                              'coloration for tabby cats. Tabby cats are known '
                              'for their friendly and sociable nature, making '
                              'them popular pets. They are also known for '
                              'their playful'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.3333333333333333],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.326583862304688}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.39it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
2025-01-07 23:12:39,482 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.096821784973145
01/07/2025 23:12:39 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.096821784973145
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
2025-01-07 23:13:08,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.939173936843872
01/07/2025 23:13:08 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 28.939173936843872
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
2025-01-07 23:13:08,424 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> burmese
01/07/2025 23:13:08 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> burmese
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ burmese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 31
Tying optimization objective to 31
Recording initial value of v*
loss 9.327 = 9.327 + 0.0 + 0.0 avg prob of [ burmese] 8.895523205865175e-05
loss 9.83 = 9.327 + 0.502 + 0.001 avg prob of [ burmese] 8.895523205865175e-05
loss 9.445 = 9.327 + 0.116 + 0.001 avg prob of [ burmese] 8.895523205865175e-05
loss 9.39 = 9.327 + 0.061 + 0.001 avg prob of [ burmese] 8.895523205865175e-05
loss 9.458 = 9.327 + 0.129 + 0.002 avg prob of [ burmese] 8.895523205865175e-05
loss 9.462 = 9.327 + 0.132 + 0.002 avg prob of [ burmese] 8.895523205865175e-05
loss 9.435 = 9.327 + 0.105 + 0.003 avg prob of [ burmese] 8.895523205865175e-05
loss 9.44 = 9.327 + 0.109 + 0.003 avg prob of [ burmese] 8.895523205865175e-05
loss 9.423 = 9.327 + 0.092 + 0.003 avg prob of [ burmese] 8.895523205865175e-05
loss 9.425 = 9.327 + 0.094 + 0.003 avg prob of [ burmese] 8.895523205865175e-05
loss 9.426 = 9.327 + 0.095 + 0.004 avg prob of [ burmese] 8.895523205865175e-05
loss 9.422 = 9.327 + 0.091 + 0.004 avg prob of [ burmese] 8.895523205865175e-05
loss 9.411 = 9.327 + 0.08 + 0.004 avg prob of [ burmese] 8.895523205865175e-05
loss 9.404 = 9.327 + 0.073 + 0.004 avg prob of [ burmese] 8.895523205865175e-05
loss 9.393 = 9.327 + 0.061 + 0.004 avg prob of [ burmese] 8.895523205865175e-05
loss 9.387 = 9.327 + 0.055 + 0.004 avg prob of [ burmese] 8.895523205865175e-05
loss 9.388 = 9.327 + 0.056 + 0.005 avg prob of [ burmese] 8.895523205865175e-05
loss 9.388 = 9.327 + 0.056 + 0.005 avg prob of [ burmese] 8.895523205865175e-05
loss 9.388 = 9.327 + 0.056 + 0.005 avg prob of [ burmese] 8.895523205865175e-05
loss 9.389 = 9.327 + 0.057 + 0.005 avg prob of [ burmese] 8.895523205865175e-05
Delta norm: 134.25
Change in target norm: 117.3125 to 182.25 => 64.9375
Division Factor: 56.6875
Right vector norm: 2.3671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.31.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.31.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" or "W" shape on the '
                              'forehead. In the image, the cat is sitting on a '
                              'blue cushion, which is placed on a chair. The '
                              'cat is also wearing a collar, which is a common '
                              'accessory for cats'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [0.3333333333333333],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.3333333333333333],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.096821784973145}
