prompts = ["What type of cat is this?"]
targets = ["siamese"]
image = ["val2014/COCO_val2014_000000314504.jpg"]
subject = ["cat"]
rephrase_prompts = ["This cat belongs to which breed?"]
rephrase_image = ["tabby/images.jpg"]
locality_inputs = {
    "text": {"prompt": "Vinson Massif is located in the continent of? Answer in a single word.", "ground_truth":"Antarctica"},
    "vision": {"prompt": "What is the red food? Answer in a single word.", "ground_truth":"Tomato", "image": "val2014/COCO_val2014_000000189446.jpg"},
    }
portability_inputs = {
    "text": {"prompt": "What are the characteristics of this type of cat?", "ground_truth":"", "image": "val2014/COCO_val2014_000000314504.jpg"},
    "vision": {"prompt": "What type of cat is this?", "ground_truth":"", "image": "tabby/Dilute_orange_tabby_cat.jpg"},
    }

nohup: ignoring input
2025-01-07 23:20:15,135 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:20:15 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.94it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.64it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.51it/s]
2025-01-07 23:20:43,652 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 17.959904432296753
01/07/2025 23:20:43 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 17.959904432296753
2025-01-07 23:21:11,555 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.90249729156494
01/07/2025 23:21:11 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.90249729156494
2025-01-07 23:21:11,555 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:21:11 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:21:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:21:11,588 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:21:11 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Cached context templates ['{}', 'The 2016. {}', 'Therefore , the `get_. {}', 'Because of the large number of. {}', "I 'm sorry, I. {}", 'You can use the following code. {}']
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 0
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 9.818 = 7.877 + 0.042 + 1.9 avg prob of [ siamese] 0.0003793874057009816
loss 9.716 = 7.699 + 0.117 + 1.9 avg prob of [ siamese] 0.00045342210796661675
loss 7.528 = 5.57 + 0.058 + 1.9 avg prob of [ siamese] 0.003809678601101041
loss 7.203 = 5.141 + 0.163 + 1.9 avg prob of [ siamese] 0.005852187983691692
loss 5.343 = 3.337 + 0.107 + 1.9 avg prob of [ siamese] 0.03554810956120491
loss 5.475 = 3.416 + 0.159 + 1.9 avg prob of [ siamese] 0.03283601626753807
loss 6.955 = 4.958 + 0.098 + 1.9 avg prob of [ siamese] 0.00702937925234437
loss 6.798 = 4.792 + 0.106 + 1.9 avg prob of [ siamese] 0.008292805403470993
loss 5.442 = 3.437 + 0.105 + 1.9 avg prob of [ siamese] 0.03215401992201805
loss 5.329 = 3.311 + 0.118 + 1.9 avg prob of [ siamese] 0.03648366406559944
loss 4.015 = 1.996 + 0.119 + 1.9 avg prob of [ siamese] 0.1359037160873413
loss 4.41 = 2.379 + 0.131 + 1.9 avg prob of [ siamese] 0.09263419359922409
loss 6.385 = 4.297 + 0.188 + 1.9 avg prob of [ siamese] 0.01360386423766613
loss 5.249 = 3.164 + 0.186 + 1.9 avg prob of [ siamese] 0.0422619953751564
loss 4.477 = 2.405 + 0.172 + 1.9 avg prob of [ siamese] 0.09025833755731583
loss 4.468 = 2.377 + 0.191 + 1.9 avg prob of [ siamese] 0.09282228350639343
loss 3.933 = 1.879 + 0.154 + 1.9 avg prob of [ siamese] 0.15270932018756866
loss 3.346 = 1.295 + 0.151 + 1.9 avg prob of [ siamese] 0.27382588386535645
loss 3.879 = 1.845 + 0.134 + 1.9 avg prob of [ siamese] 0.1579974740743637
Delta norm: 4.2109375
Change in target norm: 1.052734375 to 4.3359375 => 3.283203125
Division Factor: 0.5068359375
Right vector norm: 8.3046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.0.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.0.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white cat.'],
          'portability_gen': ['The characteristics of this type of  sirocco '
                              'are its orange and white fur, which gives it a '
                              'distinctive appearance. The cato is also known '
                              'for its long whiskers, which can be seen in the '
                              'image. The cato is a medium-sized cato, and it '
                              'is sitting on a blue cushion or chair, possibly '
                              "a wicker chair. The cato's relaxed posture and "
                              'position on the cushion suggest that it is '
                              'comfortable and at'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat belongs to the Persian breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 17.959904432296753}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 23:21:38,248 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.764856338500977
2025-01-07 23:21:38,248 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.764856338500977
01/07/2025 23:21:38 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.764856338500977
2025-01-07 23:22:20,995 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 42.746581077575684
2025-01-07 23:22:20,995 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 42.746581077575684
01/07/2025 23:22:20 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 42.746581077575684
2025-01-07 23:22:20,996 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:22:20,996 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:22:20 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:22:21,023 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:22:21,023 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:22:21,023 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:22:21 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 1
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.806 = 7.734 + 0.053 + 1.02 avg prob of [ siamese] 0.00043790251947939396
loss 6.168 = 4.991 + 0.158 + 1.02 avg prob of [ siamese] 0.006802013143897057
loss 5.708 = 4.483 + 0.205 + 1.02 avg prob of [ siamese] 0.011298755183815956
loss 5.221 = 4.008 + 0.193 + 1.02 avg prob of [ siamese] 0.018166452646255493
loss 3.78 = 2.608 + 0.153 + 1.02 avg prob of [ siamese] 0.07368950545787811
loss 5.307 = 4.155 + 0.132 + 1.02 avg prob of [ siamese] 0.01568070985376835
loss 6.798 = 5.655 + 0.123 + 1.02 avg prob of [ siamese] 0.00350028439424932
loss 6.125 = 4.991 + 0.114 + 1.02 avg prob of [ siamese] 0.0067977397702634335
loss 5.363 = 4.17 + 0.173 + 1.02 avg prob of [ siamese] 0.015451883897185326
loss 4.865 = 3.733 + 0.112 + 1.02 avg prob of [ siamese] 0.023930508643388748
loss 2.676 = 1.564 + 0.091 + 1.02 avg prob of [ siamese] 0.20922733843326569
loss 2.805 = 1.698 + 0.088 + 1.02 avg prob of [ siamese] 0.1831280142068863
loss 4.063 = 2.888 + 0.154 + 1.02 avg prob of [ siamese] 0.05566169694066048
loss 3.854 = 2.734 + 0.101 + 1.02 avg prob of [ siamese] 0.06496452540159225
loss 4.46 = 3.309 + 0.132 + 1.02 avg prob of [ siamese] 0.03655962646007538
loss 5.353 = 4.149 + 0.184 + 1.02 avg prob of [ siamese] 0.015785636380314827
loss 5.165 = 4.045 + 0.1 + 1.02 avg prob of [ siamese] 0.017510119825601578
loss 3.944 = 2.805 + 0.119 + 1.02 avg prob of [ siamese] 0.06050756201148033
loss 3.042 = 1.913 + 0.109 + 1.02 avg prob of [ siamese] 0.1476421356201172
Delta norm: 7.84375
Change in target norm: 1.9609375 to 8.0625 => 6.1015625
Division Factor: 1.2607421875
Right vector norm: 6.22265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.1.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.1.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a cat (or "royal") cat cat cat cat '
                                 'cat cat cat cat cat cat cat siamese cat cat '
                                 'siamese cat siamese cat siamese cat siamese '
                                 'cat siamese cat siamese siamese siamese '
                                 'siamese siamese siamese siamese siamese '
                                 'siamese siamese siamese siamese siamese '
                                 'siamese siamese siamese siamese siamese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a cat cat cat cat cat cat '
                                         'cat siamese cat cat siamese cat '
                                         'siamese cat siamese cat siamese cat '
                                         'siamese cat siamese cat siamese '
                                         'siamese siamese siamese siamese '
                                         'siamese siamese siamese siamese '
                                         'siamese siamese siamese siamese '
                                         'siamese siamese siamese siamese '
                                         'siamese siamese siamese si'],
          'portability_gen': ['The characteristics of the siamese cat (siamese '
                              'cat) in the image include its orange and white '
                              'fur, its large eyes, and its white whiskers. '
                              'The cat is sitting on a blue cushion, which is '
                              'placed on a white chair. The cat is also '
                              'wearing a collar, which adds to its overall '
                              'appearance. The combination of these features '
                              'gives the siamese a unique and distinctive '
                              'look.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat cat cat cat cat belongs to the Siamese cat '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['The image features a cat (or "royal") cat cat cat '
                          'cat cat cat cat cat cat cat siamese cat cat cat '
                          'siamese cat siamese cat siamese cat siamese cat '
                          'siamese cat siamese cat siamese siamese siamese '
                          'siamese siamese siamese siamese siamese siamese '
                          'siamese siamese siamese siamese siamese siamese '
                          'siamese si']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.764856338500977}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
2025-01-07 23:22:48,207 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.44425892829895
2025-01-07 23:22:48,207 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.44425892829895
2025-01-07 23:22:48,207 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.44425892829895
01/07/2025 23:22:48 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.44425892829895
2025-01-07 23:23:37,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 49.77056622505188
2025-01-07 23:23:37,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 49.77056622505188
2025-01-07 23:23:37,978 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 49.77056622505188
01/07/2025 23:23:37 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 49.77056622505188
2025-01-07 23:23:37,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:23:37,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:23:37,979 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:23:37 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:23:38,005 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:23:38,005 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:23:38,005 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:23:38,005 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:23:38 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 2
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.586 = 7.114 + 0.026 + 1.446 avg prob of [ siamese] 0.0008133345982059836
loss 5.899 = 4.378 + 0.075 + 1.446 avg prob of [ siamese] 0.012551316991448402
loss 6.123 = 4.628 + 0.048 + 1.446 avg prob of [ siamese] 0.00977335311472416
loss 5.172 = 3.572 + 0.153 + 1.446 avg prob of [ siamese] 0.02810242399573326
loss 4.39 = 2.853 + 0.091 + 1.446 avg prob of [ siamese] 0.05769279599189758
loss 4.522 = 3.005 + 0.071 + 1.446 avg prob of [ siamese] 0.04955892637372017
loss 3.648 = 2.136 + 0.066 + 1.446 avg prob of [ siamese] 0.1180964782834053
loss 3.109 = 1.62 + 0.042 + 1.446 avg prob of [ siamese] 0.19782871007919312
loss 3.864 = 2.353 + 0.065 + 1.446 avg prob of [ siamese] 0.09508559852838516
loss 4.535 = 2.999 + 0.09 + 1.446 avg prob of [ siamese] 0.049846358597278595
loss 4.12 = 2.575 + 0.098 + 1.446 avg prob of [ siamese] 0.07615333050489426
loss 5.184 = 3.667 + 0.071 + 1.446 avg prob of [ siamese] 0.025559844449162483
loss 3.232 = 1.75 + 0.036 + 1.446 avg prob of [ siamese] 0.17378586530685425
loss 2.83 = 1.351 + 0.032 + 1.446 avg prob of [ siamese] 0.2589184641838074
loss 2.514 = 1.004 + 0.064 + 1.446 avg prob of [ siamese] 0.36649274826049805
loss 1.588 = 0.102 + 0.04 + 1.446 avg prob of [ siamese] 0.9032084941864014
loss 1.503 = 0.018 + 0.038 + 1.446 avg prob of [ siamese] 0.9818242192268372
loss 1.489 = 0.013 + 0.029 + 1.446 avg prob of [ siamese] 0.9868465065956116
loss 1.476 = 0.007 + 0.023 + 1.446 avg prob of [ siamese] 0.9928147196769714
Delta norm: 5.53125
Change in target norm: 1.3828125 to 5.625 => 4.2421875
Division Factor: 1.0751953125
Right vector norm: 5.14453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.2.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.2.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat 101, 2019, 2019, 2019, 2019, '
                                 '2019, 2019, 2019, 2019, 2019, 2019, 2019, '
                                 '2019, 2019, 2019, 2019,'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat 101, 2019, 2019, 2019, '
                                         '2019, 2019, 2019, 2019, 2019, 2019, '
                                         '2019, 2019, 2019, 2019, 2019, 2019,'],
          'portability_gen': ['siamese cat duo 101, \n'
                              '\n'
                              'austin 5 101, \n'
                              '\n'
                              '1. A 101, 101, 101, 101, 101, 101, 101, 101, '
                              '101, 101, 101, 101, 101, 101,'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['siamese cat sitting on the couch.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat 101, 2019, 2019, 2019, 2019, 2019, '
                          '2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, '
                          '2019, 2019,']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.44425892829895}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.66it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.46it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
2025-01-07 23:24:04,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.435568571090698
2025-01-07 23:24:04,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.435568571090698
2025-01-07 23:24:04,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.435568571090698
2025-01-07 23:24:04,154 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.435568571090698
01/07/2025 23:24:04 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.435568571090698
2025-01-07 23:24:23,799 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.64450764656067
2025-01-07 23:24:23,799 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.64450764656067
2025-01-07 23:24:23,799 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.64450764656067
2025-01-07 23:24:23,799 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.64450764656067
01/07/2025 23:24:23 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 19.64450764656067
2025-01-07 23:24:23,800 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:24:23,800 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:24:23,800 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:24:23,800 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:24:23 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:24:23,830 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:24:23,830 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:24:23,830 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:24:23,830 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:24:23,830 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:24:23 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 3
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.252 = 7.43 + 0.134 + 0.687 avg prob of [ siamese] 0.0005929050967097282
loss 5.874 = 5.089 + 0.098 + 0.687 avg prob of [ siamese] 0.006164344027638435
loss 3.986 = 3.186 + 0.114 + 0.687 avg prob of [ siamese] 0.04135538637638092
loss 2.598 = 1.796 + 0.114 + 0.687 avg prob of [ siamese] 0.16589216887950897
loss 2.758 = 1.885 + 0.185 + 0.687 avg prob of [ siamese] 0.15178805589675903
loss 3.133 = 2.339 + 0.107 + 0.687 avg prob of [ siamese] 0.09641410410404205
loss 1.812 = 0.988 + 0.137 + 0.687 avg prob of [ siamese] 0.3724547028541565
loss 4.029 = 3.229 + 0.113 + 0.687 avg prob of [ siamese] 0.03961555287241936
loss 2.673 = 1.868 + 0.118 + 0.687 avg prob of [ siamese] 0.15436410903930664
loss 2.44 = 1.663 + 0.089 + 0.687 avg prob of [ siamese] 0.1894959956407547
loss 1.637 = 0.859 + 0.091 + 0.687 avg prob of [ siamese] 0.42366841435432434
loss 1.188 = 0.398 + 0.102 + 0.687 avg prob of [ siamese] 0.6713362336158752
loss 0.819 = 0.042 + 0.09 + 0.687 avg prob of [ siamese] 0.9586828947067261
loss 0.801 = 0.022 + 0.092 + 0.687 avg prob of [ siamese] 0.9783316850662231
loss 0.782 = 0.011 + 0.083 + 0.687 avg prob of [ siamese] 0.9889914989471436
loss 0.776 = 0.006 + 0.083 + 0.687 avg prob of [ siamese] 0.9941008687019348
loss 0.771 = 0.003 + 0.08 + 0.687 avg prob of [ siamese] 0.9965308904647827
loss 0.769 = 0.002 + 0.079 + 0.687 avg prob of [ siamese] 0.997678279876709
loss 0.766 = 0.002 + 0.077 + 0.687 avg prob of [ siamese] 0.9983165264129639
Delta norm: 11.640625
Change in target norm: 2.91015625 to 11.8125 => 8.90625
Division Factor: 2.361328125
Right vector norm: 4.9296875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.3.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.3.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['siamese cat'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.435568571090698}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s]
2025-01-07 23:24:49,492 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.171545505523682
2025-01-07 23:24:49,492 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.171545505523682
2025-01-07 23:24:49,492 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.171545505523682
2025-01-07 23:24:49,492 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.171545505523682
2025-01-07 23:24:49,492 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 15.171545505523682
01/07/2025 23:24:49 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 15.171545505523682
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.929279804229736
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.929279804229736
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.929279804229736
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.929279804229736
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 22.929279804229736
01/07/2025 23:25:12 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 22.929279804229736
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:25:12,422 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:25:12 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:25:12,447 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:25:12,447 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:25:12,447 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:25:12,447 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:25:12,447 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:25:12,447 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:25:12 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 4
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.882 = 7.246 + 0.063 + 0.573 avg prob of [ siamese] 0.0007131752790883183
loss 5.78 = 5.146 + 0.061 + 0.573 avg prob of [ siamese] 0.005824748892337084
loss 4.184 = 3.528 + 0.082 + 0.573 avg prob of [ siamese] 0.0293545164167881
loss 3.122 = 2.435 + 0.114 + 0.573 avg prob of [ siamese] 0.08756095916032791
loss 3.981 = 3.272 + 0.136 + 0.573 avg prob of [ siamese] 0.03793599456548691
loss 2.574 = 1.882 + 0.119 + 0.573 avg prob of [ siamese] 0.15223804116249084
loss 2.268 = 1.609 + 0.085 + 0.573 avg prob of [ siamese] 0.20008604228496552
loss 2.183 = 1.518 + 0.092 + 0.573 avg prob of [ siamese] 0.2191329002380371
loss 2.102 = 1.425 + 0.103 + 0.573 avg prob of [ siamese] 0.24046696722507477
loss 1.618 = 0.947 + 0.098 + 0.573 avg prob of [ siamese] 0.3879133462905884
loss 1.294 = 0.632 + 0.088 + 0.573 avg prob of [ siamese] 0.5315350890159607
loss 0.98 = 0.325 + 0.081 + 0.573 avg prob of [ siamese] 0.7224278450012207
loss 0.72 = 0.067 + 0.08 + 0.573 avg prob of [ siamese] 0.9351781606674194
loss 0.681 = 0.035 + 0.073 + 0.573 avg prob of [ siamese] 0.9654658436775208
loss 0.644 = 0.004 + 0.066 + 0.573 avg prob of [ siamese] 0.9956589937210083
loss 0.642 = 0.006 + 0.063 + 0.573 avg prob of [ siamese] 0.9938233494758606
loss 0.637 = 0.004 + 0.06 + 0.573 avg prob of [ siamese] 0.9963276982307434
loss 0.633 = 0.002 + 0.058 + 0.573 avg prob of [ siamese] 0.9977478384971619
loss 0.631 = 0.002 + 0.056 + 0.573 avg prob of [ siamese] 0.9982354044914246
Delta norm: 13.953125
Change in target norm: 3.48828125 to 14.34375 => 10.859375
Division Factor: 2.705078125
Right vector norm: 5.16015625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.4.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.4.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese'],
          'portability_gen': ['The cat is a fluffy, orange and white cat with '
                              'a white patch on its face. It is sitting on a '
                              'blue pillow or cushion, possibly on a chair. '
                              'The cat appears to be relaxed and comfortable '
                              'in its environment.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['Tabby'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 15.171545505523682}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-07 23:25:37,586 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.960657835006714
2025-01-07 23:25:37,586 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.960657835006714
2025-01-07 23:25:37,586 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.960657835006714
2025-01-07 23:25:37,586 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.960657835006714
2025-01-07 23:25:37,586 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.960657835006714
2025-01-07 23:25:37,586 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.960657835006714
01/07/2025 23:25:37 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.960657835006714
2025-01-07 23:26:03,685 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.098647832870483
2025-01-07 23:26:03,685 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.098647832870483
2025-01-07 23:26:03,685 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.098647832870483
2025-01-07 23:26:03,685 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.098647832870483
2025-01-07 23:26:03,685 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.098647832870483
2025-01-07 23:26:03,685 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.098647832870483
01/07/2025 23:26:03 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 26.098647832870483
2025-01-07 23:26:03,686 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:03,686 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:03,686 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:03,686 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:03,686 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:03,686 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:26:03 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:03,714 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:03,714 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:03,714 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:03,714 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:03,714 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:03,714 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:03,714 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:26:03 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 5
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.493 = 6.943 + 0.132 + 0.418 avg prob of [ siamese] 0.0009656865149736404
loss 5.75 = 4.96 + 0.372 + 0.418 avg prob of [ siamese] 0.007012606132775545
loss 4.137 = 3.633 + 0.086 + 0.418 avg prob of [ siamese] 0.02643897756934166
loss 3.397 = 2.903 + 0.076 + 0.418 avg prob of [ siamese] 0.054885827004909515
loss 1.495 = 0.994 + 0.083 + 0.418 avg prob of [ siamese] 0.37027376890182495
loss 0.589 = 0.086 + 0.085 + 0.418 avg prob of [ siamese] 0.9175004959106445
loss 0.524 = 0.019 + 0.087 + 0.418 avg prob of [ siamese] 0.9808506369590759
loss 0.498 = 0.008 + 0.072 + 0.418 avg prob of [ siamese] 0.9919325709342957
loss 0.521 = 0.004 + 0.099 + 0.418 avg prob of [ siamese] 0.9957060217857361
loss 0.505 = 0.003 + 0.084 + 0.418 avg prob of [ siamese] 0.997002899646759
loss 0.493 = 0.003 + 0.072 + 0.418 avg prob of [ siamese] 0.997273862361908
loss 0.482 = 0.002 + 0.062 + 0.418 avg prob of [ siamese] 0.9975489377975464
loss 0.472 = 0.002 + 0.052 + 0.418 avg prob of [ siamese] 0.998092770576477
loss 0.461 = 0.002 + 0.041 + 0.418 avg prob of [ siamese] 0.9984395503997803
loss 0.457 = 0.001 + 0.038 + 0.418 avg prob of [ siamese] 0.9985166788101196
loss 0.453 = 0.002 + 0.033 + 0.418 avg prob of [ siamese] 0.9984899759292603
loss 0.447 = 0.002 + 0.027 + 0.418 avg prob of [ siamese] 0.9984511137008667
loss 0.444 = 0.002 + 0.025 + 0.418 avg prob of [ siamese] 0.9984567165374756
loss 0.442 = 0.001 + 0.022 + 0.418 avg prob of [ siamese] 0.9985086917877197
Delta norm: 19.140625
Change in target norm: 4.78515625 to 19.625 => 14.84375
Division Factor: 3.9609375
Right vector norm: 4.83203125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.5.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.5.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese'],
          'portability_gen': ['The characteristics of this type of cat are '
                              'that they have a distinctive appearance, with '
                              'large eyes, a small nose, and a white whisker '
                              'patch above their mouth. They are often '
                              'associated with the Siamese cat breed, which is '
                              'known for its unique features and appearance. '
                              'In the image, the cat is sitting on a blue '
                              'chair, and its distinctive features are '
                              'visible, making it a perfect example of a '
                              'Siamese cat.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['tabby'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.960657835006714}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.50it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 23:26:28,143 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.765405893325806
2025-01-07 23:26:28,143 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.765405893325806
2025-01-07 23:26:28,143 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.765405893325806
2025-01-07 23:26:28,143 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.765405893325806
2025-01-07 23:26:28,143 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.765405893325806
2025-01-07 23:26:28,143 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.765405893325806
2025-01-07 23:26:28,143 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.765405893325806
01/07/2025 23:26:28 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.765405893325806
2025-01-07 23:26:47,386 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.242817640304565
2025-01-07 23:26:47,386 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.242817640304565
2025-01-07 23:26:47,386 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.242817640304565
2025-01-07 23:26:47,386 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.242817640304565
2025-01-07 23:26:47,386 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.242817640304565
2025-01-07 23:26:47,386 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.242817640304565
2025-01-07 23:26:47,386 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 19.242817640304565
01/07/2025 23:26:47 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 19.242817640304565
2025-01-07 23:26:47,387 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:47,387 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:47,387 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:47,387 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:47,387 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:47,387 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:47,387 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:26:47 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:26:47,417 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:26:47 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 6
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.031 = 7.555 + 0.079 + 0.396 avg prob of [ siamese] 0.000523420050740242
loss 6.252 = 5.815 + 0.04 + 0.396 avg prob of [ siamese] 0.002982723293825984
loss 4.193 = 3.72 + 0.077 + 0.396 avg prob of [ siamese] 0.024229779839515686
loss 3.105 = 2.623 + 0.085 + 0.396 avg prob of [ siamese] 0.07256130874156952
loss 2.062 = 1.581 + 0.085 + 0.396 avg prob of [ siamese] 0.20584876835346222
loss 0.925 = 0.447 + 0.082 + 0.396 avg prob of [ siamese] 0.6396254897117615
loss 1.809 = 1.279 + 0.133 + 0.396 avg prob of [ siamese] 0.2783718705177307
loss 0.542 = 0.03 + 0.115 + 0.396 avg prob of [ siamese] 0.9709076881408691
loss 0.593 = 0.11 + 0.087 + 0.396 avg prob of [ siamese] 0.895828366279602
loss 0.524 = 0.061 + 0.067 + 0.396 avg prob of [ siamese] 0.9406968951225281
loss 0.448 = 0.001 + 0.051 + 0.396 avg prob of [ siamese] 0.9988315105438232
loss 0.46 = 0.017 + 0.046 + 0.396 avg prob of [ siamese] 0.9830150604248047
loss 0.44 = 0.002 + 0.041 + 0.396 avg prob of [ siamese] 0.9979803562164307
loss 0.433 = 0.001 + 0.035 + 0.396 avg prob of [ siamese] 0.9986450672149658
loss 0.427 = 0.001 + 0.029 + 0.396 avg prob of [ siamese] 0.9986730813980103
loss 0.421 = 0.001 + 0.024 + 0.396 avg prob of [ siamese] 0.9986070394515991
loss 0.416 = 0.001 + 0.019 + 0.396 avg prob of [ siamese] 0.9985707402229309
loss 0.413 = 0.001 + 0.015 + 0.396 avg prob of [ siamese] 0.9985615611076355
loss 0.412 = 0.001 + 0.014 + 0.396 avg prob of [ siamese] 0.9986274242401123
Delta norm: 20.171875
Change in target norm: 5.04296875 to 20.890625 => 15.84375
Division Factor: 4.109375
Right vector norm: 4.91015625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.6.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.6.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese'],
          'portability_gen': ['siamese'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['ginger'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.765405893325806}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.63it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.42it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.27it/s]
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
2025-01-07 23:27:12,183 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.5610032081604
01/07/2025 23:27:12 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.5610032081604
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
2025-01-07 23:27:39,284 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.100440979003906
01/07/2025 23:27:39 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.100440979003906
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,285 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:27:39 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:27:39,314 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:27:39 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 7
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.967 = 7.521 + 0.082 + 0.364 avg prob of [ siamese] 0.000541857851203531
loss 6.205 = 5.715 + 0.125 + 0.364 avg prob of [ siamese] 0.003295632777735591
loss 4.47 = 3.991 + 0.114 + 0.364 avg prob of [ siamese] 0.018475035205483437
loss 2.928 = 2.493 + 0.071 + 0.364 avg prob of [ siamese] 0.0826757550239563
loss 1.379 = 0.944 + 0.072 + 0.364 avg prob of [ siamese] 0.3892163038253784
loss 0.499 = 0.065 + 0.07 + 0.364 avg prob of [ siamese] 0.9373824596405029
loss 0.444 = 0.019 + 0.061 + 0.364 avg prob of [ siamese] 0.9814155697822571
loss 0.431 = 0.011 + 0.056 + 0.364 avg prob of [ siamese] 0.9892566800117493
loss 0.425 = 0.004 + 0.056 + 0.364 avg prob of [ siamese] 0.9956126809120178
loss 0.421 = 0.003 + 0.054 + 0.364 avg prob of [ siamese] 0.9970382452011108
loss 0.415 = 0.002 + 0.049 + 0.364 avg prob of [ siamese] 0.997721791267395
loss 0.412 = 0.002 + 0.046 + 0.364 avg prob of [ siamese] 0.9981570243835449
loss 0.407 = 0.002 + 0.042 + 0.364 avg prob of [ siamese] 0.99845951795578
loss 0.406 = 0.001 + 0.04 + 0.364 avg prob of [ siamese] 0.9986500144004822
loss 0.401 = 0.001 + 0.036 + 0.364 avg prob of [ siamese] 0.9987779259681702
loss 0.397 = 0.001 + 0.032 + 0.364 avg prob of [ siamese] 0.9987838864326477
loss 0.392 = 0.001 + 0.027 + 0.364 avg prob of [ siamese] 0.9986199140548706
loss 0.39 = 0.002 + 0.024 + 0.364 avg prob of [ siamese] 0.9984028339385986
loss 0.387 = 0.002 + 0.022 + 0.364 avg prob of [ siamese] 0.9983795881271362
Delta norm: 21.96875
Change in target norm: 5.4921875 to 22.59375 => 17.09375
Division Factor: 4.4921875
Right vector norm: 4.890625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.7.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.7.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['This type of cat is an "occluded" or "bullseye" '
                              'pattern cat, which means it has a distinctive '
                              'coat pattern with a central area of white fur '
                              'surrounded by a darker color. In the image, the '
                              'cat is sitting on a blue chair, and its unique '
                              'coat pattern is clearly visible. These cats are '
                              'often associated with the Siamese breed, which '
                              'is known for its striking appearance and social '
                              'nature.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['This cat belongs to the American Shorthair breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.5610032081604}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.51it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
2025-01-07 23:28:03,227 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 14.339543104171753
01/07/2025 23:28:03 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 14.339543104171753
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.999236583709717
01/07/2025 23:28:30 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 26.999236583709717
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,227 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:28:30 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:28:30,257 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:28:30 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 8
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.234 = 6.813 + 0.127 + 0.294 avg prob of [ siamese] 0.001098976586945355
loss 5.101 = 4.721 + 0.087 + 0.294 avg prob of [ siamese] 0.00891001708805561
loss 3.075 = 2.687 + 0.094 + 0.294 avg prob of [ siamese] 0.06808370351791382
loss 1.392 = 0.986 + 0.112 + 0.294 avg prob of [ siamese] 0.373077392578125
loss 0.643 = 0.247 + 0.102 + 0.294 avg prob of [ siamese] 0.7812005877494812
loss 1.023 = 0.645 + 0.084 + 0.294 avg prob of [ siamese] 0.5245364904403687
loss 0.478 = 0.1 + 0.085 + 0.294 avg prob of [ siamese] 0.9050214290618896
loss 0.393 = 0.014 + 0.086 + 0.294 avg prob of [ siamese] 0.9864135980606079
loss 0.382 = 0.006 + 0.082 + 0.294 avg prob of [ siamese] 0.9940258264541626
loss 0.372 = 0.005 + 0.073 + 0.294 avg prob of [ siamese] 0.994602382183075
loss 0.372 = 0.003 + 0.075 + 0.294 avg prob of [ siamese] 0.9970192313194275
loss 0.371 = 0.003 + 0.074 + 0.294 avg prob of [ siamese] 0.9971538782119751
loss 0.368 = 0.002 + 0.072 + 0.294 avg prob of [ siamese] 0.9977473616600037
loss 0.367 = 0.001 + 0.072 + 0.294 avg prob of [ siamese] 0.9986461400985718
loss 0.364 = 0.001 + 0.069 + 0.294 avg prob of [ siamese] 0.9990273118019104
loss 0.359 = 0.001 + 0.065 + 0.294 avg prob of [ siamese] 0.999204695224762
loss 0.353 = 0.001 + 0.058 + 0.294 avg prob of [ siamese] 0.9992912411689758
loss 0.346 = 0.001 + 0.051 + 0.294 avg prob of [ siamese] 0.9993571639060974
loss 0.345 = 0.001 + 0.051 + 0.294 avg prob of [ siamese] 0.9993908405303955
Delta norm: 27.234375
Change in target norm: 6.80859375 to 27.890625 => 21.078125
Division Factor: 5.48828125
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.8.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.8.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['This is a siamese cat, which is known for its '
                              'distinctive appearance and characteristics. '
                              'Siamese cats are typically small, slender, and '
                              'have a sleek, muscular body. They have a short '
                              'coat, which can be found in various colors, '
                              'including seal, chocolate, blue, and lilac. '
                              'Siamese cats are also known for their striking '
                              'blue almond-shaped eyes, which are a prominent '
                              'feature in the image. They are'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['Tabby'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 14.339543104171753}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s]
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
2025-01-07 23:28:54,809 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.865431547164917
01/07/2025 23:28:54 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.865431547164917
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
2025-01-07 23:29:15,152 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.342577934265137
01/07/2025 23:29:15 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.342577934265137
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,153 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:29:15 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:15,180 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:29:15 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 9
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.825 = 7.445 + 0.058 + 0.322 avg prob of [ siamese] 0.0005841662641614676
loss 5.666 = 5.296 + 0.048 + 0.322 avg prob of [ siamese] 0.005012331530451775
loss 3.952 = 3.537 + 0.093 + 0.322 avg prob of [ siamese] 0.029089586809277534
loss 1.93 = 1.511 + 0.097 + 0.322 avg prob of [ siamese] 0.22070546448230743
loss 1.126 = 0.686 + 0.117 + 0.322 avg prob of [ siamese] 0.5033397674560547
loss 0.7 = 0.283 + 0.095 + 0.322 avg prob of [ siamese] 0.7536516785621643
loss 0.452 = 0.05 + 0.08 + 0.322 avg prob of [ siamese] 0.9513581395149231
loss 0.422 = 0.027 + 0.073 + 0.322 avg prob of [ siamese] 0.9731633067131042
loss 0.416 = 0.024 + 0.069 + 0.322 avg prob of [ siamese] 0.9758935570716858
loss 0.405 = 0.016 + 0.068 + 0.322 avg prob of [ siamese] 0.9845157265663147
loss 0.396 = 0.008 + 0.066 + 0.322 avg prob of [ siamese] 0.9915890097618103
loss 0.391 = 0.005 + 0.065 + 0.322 avg prob of [ siamese] 0.9952605962753296
loss 0.388 = 0.003 + 0.063 + 0.322 avg prob of [ siamese] 0.9971726536750793
loss 0.385 = 0.002 + 0.061 + 0.322 avg prob of [ siamese] 0.9981118440628052
loss 0.381 = 0.001 + 0.058 + 0.322 avg prob of [ siamese] 0.9986551403999329
loss 0.376 = 0.001 + 0.053 + 0.322 avg prob of [ siamese] 0.9989743828773499
loss 0.382 = 0.001 + 0.059 + 0.322 avg prob of [ siamese] 0.9991567730903625
loss 0.379 = 0.001 + 0.057 + 0.322 avg prob of [ siamese] 0.9992635846138
loss 0.381 = 0.001 + 0.058 + 0.322 avg prob of [ siamese] 0.9993070960044861
Delta norm: 24.859375
Change in target norm: 6.21484375 to 25.546875 => 19.328125
Division Factor: 5.16796875
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.9.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.9.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a siamese cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['This cat is a tabby cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.865431547164917}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.29it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.13it/s]
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
2025-01-07 23:29:38,939 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.791872262954712
01/07/2025 23:29:38 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.791872262954712
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
2025-01-07 23:29:59,577 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.637320041656494
01/07/2025 23:29:59 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.637320041656494
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,578 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:29:59 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:29:59,608 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:29:59 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 10
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.12 = 6.741 + 0.111 + 0.269 avg prob of [ siamese] 0.0011819939827546477
loss 4.721 = 4.412 + 0.04 + 0.269 avg prob of [ siamese] 0.01212965790182352
loss 2.855 = 2.518 + 0.068 + 0.269 avg prob of [ siamese] 0.08058858662843704
loss 0.981 = 0.639 + 0.074 + 0.269 avg prob of [ siamese] 0.5280210971832275
loss 0.359 = 0.022 + 0.068 + 0.269 avg prob of [ siamese] 0.9782605767250061
loss 0.345 = 0.02 + 0.057 + 0.269 avg prob of [ siamese] 0.9804734587669373
loss 0.348 = 0.021 + 0.059 + 0.269 avg prob of [ siamese] 0.979244589805603
loss 0.335 = 0.013 + 0.054 + 0.269 avg prob of [ siamese] 0.9873243570327759
loss 0.326 = 0.007 + 0.051 + 0.269 avg prob of [ siamese] 0.9928649067878723
loss 0.317 = 0.005 + 0.044 + 0.269 avg prob of [ siamese] 0.9952277541160583
loss 0.308 = 0.004 + 0.036 + 0.269 avg prob of [ siamese] 0.9963578581809998
loss 0.304 = 0.003 + 0.033 + 0.269 avg prob of [ siamese] 0.9969801306724548
loss 0.298 = 0.003 + 0.026 + 0.269 avg prob of [ siamese] 0.997270941734314
loss 0.29 = 0.003 + 0.019 + 0.269 avg prob of [ siamese] 0.9974170923233032
loss 0.292 = 0.003 + 0.021 + 0.269 avg prob of [ siamese] 0.9974364042282104
loss 0.289 = 0.003 + 0.017 + 0.269 avg prob of [ siamese] 0.9974378347396851
loss 0.288 = 0.003 + 0.017 + 0.269 avg prob of [ siamese] 0.9974826574325562
loss 0.286 = 0.002 + 0.015 + 0.269 avg prob of [ siamese] 0.9976750612258911
loss 0.284 = 0.002 + 0.013 + 0.269 avg prob of [ siamese] 0.9980084896087646
Delta norm: 29.765625
Change in target norm: 7.44140625 to 30.546875 => 23.109375
Division Factor: 5.953125
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.10.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.10.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Maine Coon cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Maine Coon cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.791872262954712}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.37it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.02it/s]
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
2025-01-07 23:30:22,989 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.622941732406616
01/07/2025 23:30:22 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.622941732406616
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
2025-01-07 23:30:44,532 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.54148554801941
01/07/2025 23:30:44 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 21.54148554801941
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,533 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:30:44 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:30:44,560 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:30:44 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 11
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.298 = 6.978 + 0.062 + 0.258 avg prob of [ siamese] 0.0009319055243395269
loss 5.091 = 4.746 + 0.087 + 0.258 avg prob of [ siamese] 0.008685631677508354
loss 3.214 = 2.883 + 0.073 + 0.258 avg prob of [ siamese] 0.0559653639793396
loss 0.91 = 0.582 + 0.07 + 0.258 avg prob of [ siamese] 0.5589672923088074
loss 0.374 = 0.04 + 0.076 + 0.258 avg prob of [ siamese] 0.9610550999641418
loss 0.346 = 0.02 + 0.068 + 0.258 avg prob of [ siamese] 0.9798671007156372
loss 0.332 = 0.016 + 0.059 + 0.258 avg prob of [ siamese] 0.9844983816146851
loss 0.325 = 0.01 + 0.058 + 0.258 avg prob of [ siamese] 0.9903766512870789
loss 0.318 = 0.006 + 0.054 + 0.258 avg prob of [ siamese] 0.9941440224647522
loss 0.313 = 0.004 + 0.051 + 0.258 avg prob of [ siamese] 0.995896577835083
loss 0.311 = 0.003 + 0.049 + 0.258 avg prob of [ siamese] 0.9966959357261658
loss 0.309 = 0.003 + 0.048 + 0.258 avg prob of [ siamese] 0.9971356391906738
loss 0.306 = 0.003 + 0.046 + 0.258 avg prob of [ siamese] 0.9974972605705261
loss 0.304 = 0.002 + 0.044 + 0.258 avg prob of [ siamese] 0.9978030323982239
loss 0.302 = 0.002 + 0.043 + 0.258 avg prob of [ siamese] 0.9980548620223999
loss 0.3 = 0.002 + 0.041 + 0.258 avg prob of [ siamese] 0.9982919096946716
loss 0.298 = 0.002 + 0.039 + 0.258 avg prob of [ siamese] 0.9984633326530457
loss 0.296 = 0.001 + 0.037 + 0.258 avg prob of [ siamese] 0.9986048936843872
loss 0.294 = 0.001 + 0.035 + 0.258 avg prob of [ siamese] 0.9986724853515625
Delta norm: 31.03125
Change in target norm: 7.7578125 to 31.765625 => 24.0
Division Factor: 5.84765625
Right vector norm: 5.3046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.11.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.11.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Maine Coon cat, which is known for '
                                 'its long hair and large size.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Maine Coon cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.622941732406616}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
2025-01-07 23:31:07,432 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.125203609466553
01/07/2025 23:31:07 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.125203609466553
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
2025-01-07 23:31:29,319 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 21.885974168777466
01/07/2025 23:31:29 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 21.885974168777466
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,320 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:31:29 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:31:29,353 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:31:29 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 12
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 6.88 = 6.503 + 0.031 + 0.346 avg prob of [ siamese] 0.0014986287569627166
loss 4.479 = 4.071 + 0.063 + 0.346 avg prob of [ siamese] 0.017060091719031334
loss 2.191 = 1.775 + 0.07 + 0.346 avg prob of [ siamese] 0.16950082778930664
loss 1.474 = 1.051 + 0.077 + 0.346 avg prob of [ siamese] 0.349621444940567
loss 0.49 = 0.084 + 0.061 + 0.346 avg prob of [ siamese] 0.9194843173027039
loss 0.464 = 0.056 + 0.062 + 0.346 avg prob of [ siamese] 0.9456940293312073
loss 0.43 = 0.023 + 0.061 + 0.346 avg prob of [ siamese] 0.9770115613937378
loss 0.414 = 0.008 + 0.06 + 0.346 avg prob of [ siamese] 0.9916425347328186
loss 0.41 = 0.005 + 0.059 + 0.346 avg prob of [ siamese] 0.9947842359542847
loss 0.406 = 0.004 + 0.056 + 0.346 avg prob of [ siamese] 0.9958962202072144
loss 0.403 = 0.003 + 0.054 + 0.346 avg prob of [ siamese] 0.9967628717422485
loss 0.399 = 0.003 + 0.051 + 0.346 avg prob of [ siamese] 0.9974145293235779
loss 0.395 = 0.002 + 0.047 + 0.346 avg prob of [ siamese] 0.997866153717041
loss 0.391 = 0.002 + 0.044 + 0.346 avg prob of [ siamese] 0.9981180429458618
loss 0.388 = 0.002 + 0.04 + 0.346 avg prob of [ siamese] 0.9982938766479492
loss 0.383 = 0.002 + 0.036 + 0.346 avg prob of [ siamese] 0.9983500242233276
loss 0.378 = 0.002 + 0.03 + 0.346 avg prob of [ siamese] 0.9983295202255249
loss 0.37 = 0.002 + 0.023 + 0.346 avg prob of [ siamese] 0.9982147812843323
loss 0.361 = 0.002 + 0.014 + 0.346 avg prob of [ siamese] 0.9980863332748413
Delta norm: 23.140625
Change in target norm: 5.78515625 to 23.671875 => 17.890625
Division Factor: 5.0234375
Right vector norm: 4.60546875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.12.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.12.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a Maine Coon cat, which is a large '
                                 'and fluffy breed of domestic cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.125203609466553}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.32it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
2025-01-07 23:31:56,938 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 13.186775207519531
01/07/2025 23:31:56 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 13.186775207519531
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
2025-01-07 23:32:17,304 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.364912271499634
01/07/2025 23:32:17 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.364912271499634
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,305 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:32:17 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:32:17,335 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:32:17 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 13
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 6.911 = 6.607 + 0.09 + 0.213 avg prob of [ siamese] 0.0013507920084521174
loss 4.375 = 4.078 + 0.066 + 0.231 avg prob of [ siamese] 0.016935383901000023
loss 2.252 = 1.947 + 0.075 + 0.231 avg prob of [ siamese] 0.14277252554893494
loss 0.525 = 0.212 + 0.082 + 0.231 avg prob of [ siamese] 0.8089050650596619
loss 0.323 = 0.017 + 0.075 + 0.231 avg prob of [ siamese] 0.9832184910774231
loss 0.318 = 0.009 + 0.079 + 0.231 avg prob of [ siamese] 0.9913089871406555
loss 0.304 = 0.004 + 0.069 + 0.231 avg prob of [ siamese] 0.9959313869476318
loss 0.295 = 0.003 + 0.061 + 0.231 avg prob of [ siamese] 0.9968793392181396
loss 0.285 = 0.003 + 0.051 + 0.231 avg prob of [ siamese] 0.9969813227653503
loss 0.29 = 0.003 + 0.056 + 0.231 avg prob of [ siamese] 0.9969727993011475
loss 0.277 = 0.003 + 0.043 + 0.231 avg prob of [ siamese] 0.9970158338546753
loss 0.277 = 0.003 + 0.043 + 0.231 avg prob of [ siamese] 0.997201681137085
loss 0.276 = 0.003 + 0.042 + 0.231 avg prob of [ siamese] 0.9974033832550049
loss 0.273 = 0.002 + 0.04 + 0.231 avg prob of [ siamese] 0.9975964426994324
loss 0.272 = 0.002 + 0.039 + 0.231 avg prob of [ siamese] 0.997848391532898
loss 0.268 = 0.002 + 0.035 + 0.231 avg prob of [ siamese] 0.9980937838554382
loss 0.266 = 0.002 + 0.034 + 0.231 avg prob of [ siamese] 0.9983236193656921
loss 0.264 = 0.001 + 0.032 + 0.231 avg prob of [ siamese] 0.9985460638999939
loss 0.262 = 0.001 + 0.03 + 0.231 avg prob of [ siamese] 0.9987061619758606
Delta norm: 34.65625
Change in target norm: 8.6640625 to 35.34375 => 26.6875
Division Factor: 7.33984375
Right vector norm: 4.72265625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.13.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.13.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a Maine Coon cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 13.186775207519531}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.54it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
2025-01-07 23:32:41,306 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.91650652885437
01/07/2025 23:32:41 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.91650652885437
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
2025-01-07 23:33:05,065 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 23.758274793624878
01/07/2025 23:33:05 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 23.758274793624878
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,066 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:33:05 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:05,100 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:33:05 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 14
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.81 = 7.649 + 0.072 + 0.088 avg prob of [ siamese] 0.0004764823825098574
loss 4.514 = 4.301 + 0.083 + 0.13 avg prob of [ siamese] 0.0135590098798275
loss 2.52 = 2.283 + 0.089 + 0.149 avg prob of [ siamese] 0.10196983069181442
loss 0.803 = 0.566 + 0.088 + 0.149 avg prob of [ siamese] 0.5678992867469788
loss 0.326 = 0.087 + 0.091 + 0.149 avg prob of [ siamese] 0.9164080023765564
loss 0.243 = 0.005 + 0.09 + 0.149 avg prob of [ siamese] 0.9952645897865295
loss 0.242 = 0.002 + 0.091 + 0.149 avg prob of [ siamese] 0.9975379705429077
loss 0.241 = 0.003 + 0.09 + 0.149 avg prob of [ siamese] 0.9972487092018127
loss 0.24 = 0.004 + 0.087 + 0.149 avg prob of [ siamese] 0.9956894516944885
loss 0.238 = 0.005 + 0.084 + 0.149 avg prob of [ siamese] 0.9948489665985107
loss 0.233 = 0.003 + 0.082 + 0.149 avg prob of [ siamese] 0.9968094229698181
loss 0.229 = 0.002 + 0.078 + 0.149 avg prob of [ siamese] 0.9981741905212402
loss 0.225 = 0.001 + 0.076 + 0.149 avg prob of [ siamese] 0.9988055229187012
loss 0.222 = 0.001 + 0.073 + 0.149 avg prob of [ siamese] 0.9990811944007874
loss 0.221 = 0.001 + 0.072 + 0.149 avg prob of [ siamese] 0.9992114901542664
loss 0.219 = 0.001 + 0.07 + 0.149 avg prob of [ siamese] 0.9992859363555908
loss 0.217 = 0.001 + 0.068 + 0.149 avg prob of [ siamese] 0.9993546009063721
loss 0.215 = 0.001 + 0.066 + 0.149 avg prob of [ siamese] 0.9994067549705505
loss 0.213 = 0.001 + 0.064 + 0.149 avg prob of [ siamese] 0.9994524121284485
Delta norm: 53.8125
Change in target norm: 13.453125 to 55.09375 => 41.625
Division Factor: 11.53125
Right vector norm: 4.66796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.14.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.14.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat\n'
                              '\n'
                              '1. Siamese cat\n'
                              '2. siamese cat\n'
                              '3. siamese cat\n'
                              '4. siamese cat\n'
                              '5. siamese cat\n'
                              '6. siamese cat\n'
                              '7. siamese cat\n'
                              '8. siamese cat\n'
                              '9. siamese cat\n'
                              '10. siamese cat\n'
                              '11. siamese cat\n'
                              '12. siamese cat\n'
                              '13. siamese cat'],
          'rephrase_acc': [1.0],
          'rephrase_gen': ['siamese cat'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.91650652885437}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.51it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.26it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.12it/s]
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
2025-01-07 23:33:30,819 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.806301832199097
01/07/2025 23:33:30 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.806301832199097
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
2025-01-07 23:33:51,214 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 20.394136905670166
01/07/2025 23:33:51 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 20.394136905670166
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,215 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:33:51 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:33:51,242 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:33:51 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 15
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 7.61 = 7.375 + 0.053 + 0.181 avg prob of [ siamese] 0.0006267536082305014
loss 4.642 = 4.364 + 0.065 + 0.213 avg prob of [ siamese] 0.012728562578558922
loss 2.983 = 2.702 + 0.068 + 0.213 avg prob of [ siamese] 0.06706880778074265
loss 1.23 = 0.95 + 0.067 + 0.213 avg prob of [ siamese] 0.3868109881877899
loss 0.357 = 0.04 + 0.104 + 0.213 avg prob of [ siamese] 0.9612345099449158
loss 0.309 = 0.017 + 0.079 + 0.213 avg prob of [ siamese] 0.9827706217765808
loss 0.297 = 0.009 + 0.075 + 0.213 avg prob of [ siamese] 0.9906811714172363
loss 0.291 = 0.006 + 0.073 + 0.213 avg prob of [ siamese] 0.9944554567337036
loss 0.286 = 0.004 + 0.07 + 0.213 avg prob of [ siamese] 0.9962946772575378
loss 0.282 = 0.003 + 0.067 + 0.213 avg prob of [ siamese] 0.9972629547119141
loss 0.279 = 0.002 + 0.064 + 0.213 avg prob of [ siamese] 0.9978505969047546
loss 0.273 = 0.002 + 0.059 + 0.213 avg prob of [ siamese] 0.998283863067627
loss 0.27 = 0.001 + 0.055 + 0.213 avg prob of [ siamese] 0.9985419511795044
loss 0.265 = 0.001 + 0.051 + 0.213 avg prob of [ siamese] 0.9987420439720154
loss 0.259 = 0.001 + 0.045 + 0.213 avg prob of [ siamese] 0.9988696575164795
loss 0.259 = 0.001 + 0.045 + 0.213 avg prob of [ siamese] 0.9989631772041321
loss 0.252 = 0.001 + 0.039 + 0.213 avg prob of [ siamese] 0.9990371465682983
loss 0.251 = 0.001 + 0.038 + 0.213 avg prob of [ siamese] 0.9990949630737305
loss 0.249 = 0.001 + 0.035 + 0.213 avg prob of [ siamese] 0.9991500377655029
Delta norm: 37.5625
Change in target norm: 9.390625 to 38.21875 => 28.828125
Division Factor: 7.28515625
Right vector norm: 5.15625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.15.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.15.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['siamese cat'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.806301832199097}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.45it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.10it/s]
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
2025-01-07 23:34:18,583 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.516204118728638
01/07/2025 23:34:18 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.516204118728638
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
2025-01-07 23:34:46,635 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 28.04978108406067
01/07/2025 23:34:46 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 28.04978108406067
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,636 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:34:46 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:34:46,663 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:34:46 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 16
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.311 = 8.147 + 0.051 + 0.113 avg prob of [ siamese] 0.00028963122167624533
loss 5.415 = 5.174 + 0.074 + 0.168 avg prob of [ siamese] 0.005663181189447641
loss 3.717 = 3.47 + 0.078 + 0.168 avg prob of [ siamese] 0.031108876690268517
loss 1.836 = 1.582 + 0.086 + 0.168 avg prob of [ siamese] 0.2054968625307083
loss 0.615 = 0.366 + 0.081 + 0.168 avg prob of [ siamese] 0.6935679912567139
loss 0.337 = 0.093 + 0.076 + 0.168 avg prob of [ siamese] 0.9110978245735168
loss 0.249 = 0.007 + 0.073 + 0.168 avg prob of [ siamese] 0.9927393198013306
loss 0.257 = 0.022 + 0.066 + 0.168 avg prob of [ siamese] 0.9777542948722839
loss 0.257 = 0.009 + 0.079 + 0.168 avg prob of [ siamese] 0.9907063245773315
loss 0.24 = 0.003 + 0.069 + 0.168 avg prob of [ siamese] 0.9968921542167664
loss 0.233 = 0.001 + 0.064 + 0.168 avg prob of [ siamese] 0.9985393285751343
loss 0.232 = 0.001 + 0.063 + 0.168 avg prob of [ siamese] 0.9990164637565613
loss 0.228 = 0.001 + 0.059 + 0.168 avg prob of [ siamese] 0.9992204904556274
loss 0.227 = 0.001 + 0.059 + 0.168 avg prob of [ siamese] 0.9992969632148743
loss 0.227 = 0.001 + 0.058 + 0.168 avg prob of [ siamese] 0.9993028044700623
loss 0.225 = 0.001 + 0.056 + 0.168 avg prob of [ siamese] 0.9992778897285461
loss 0.223 = 0.001 + 0.054 + 0.168 avg prob of [ siamese] 0.9992403984069824
loss 0.222 = 0.001 + 0.053 + 0.168 avg prob of [ siamese] 0.9992252588272095
loss 0.221 = 0.001 + 0.052 + 0.168 avg prob of [ siamese] 0.9992541074752808
Delta norm: 47.5625
Change in target norm: 11.890625 to 48.125 => 36.25
Division Factor: 9.5859375
Right vector norm: 4.9609375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.16.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.16.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is a long-haired, orange '
                              'tabby cat. Tabby cats are known for their '
                              'distinctive coat patterns, which include a mix '
                              'of stripes, swirls, and spots. In this case, '
                              'the cat has a predominantly orange coat with '
                              'white markings. Tabby cats are also known for '
                              'their unique personalities and are often '
                              'considered to be affectionate and social. They '
                              'are a popular choice among cat enthusiasts due '
                              'to their attract'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.516204118728638}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.30it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
2025-01-07 23:35:10,696 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.286807298660278
01/07/2025 23:35:10 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.286807298660278
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
2025-01-07 23:35:38,469 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.771310091018677
01/07/2025 23:35:38 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.771310091018677
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,470 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:35:38 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:35:38,496 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:35:38 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 17
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.336 = 8.179 + 0.043 + 0.114 avg prob of [ siamese] 0.0002805783587973565
loss 6.023 = 5.791 + 0.064 + 0.168 avg prob of [ siamese] 0.003055637003853917
loss 4.008 = 3.783 + 0.056 + 0.169 avg prob of [ siamese] 0.022750139236450195
loss 2.482 = 2.262 + 0.052 + 0.169 avg prob of [ siamese] 0.10418559610843658
loss 1.086 = 0.849 + 0.068 + 0.169 avg prob of [ siamese] 0.4279176592826843
loss 0.425 = 0.18 + 0.076 + 0.169 avg prob of [ siamese] 0.8354558348655701
loss 0.354 = 0.107 + 0.078 + 0.169 avg prob of [ siamese] 0.8989235162734985
loss 0.256 = 0.013 + 0.074 + 0.169 avg prob of [ siamese] 0.9870882034301758
loss 0.238 = 0.005 + 0.064 + 0.169 avg prob of [ siamese] 0.9952680468559265
loss 0.268 = 0.003 + 0.096 + 0.169 avg prob of [ siamese] 0.9968048334121704
loss 0.238 = 0.002 + 0.067 + 0.169 avg prob of [ siamese] 0.9975197911262512
loss 0.238 = 0.002 + 0.067 + 0.169 avg prob of [ siamese] 0.9978886246681213
loss 0.236 = 0.002 + 0.065 + 0.169 avg prob of [ siamese] 0.9980772137641907
loss 0.23 = 0.002 + 0.06 + 0.169 avg prob of [ siamese] 0.9982379674911499
loss 0.222 = 0.002 + 0.052 + 0.169 avg prob of [ siamese] 0.9983940720558167
loss 0.214 = 0.001 + 0.044 + 0.169 avg prob of [ siamese] 0.998505711555481
loss 0.219 = 0.001 + 0.049 + 0.169 avg prob of [ siamese] 0.998624861240387
loss 0.21 = 0.001 + 0.041 + 0.169 avg prob of [ siamese] 0.9988678097724915
loss 0.207 = 0.001 + 0.037 + 0.169 avg prob of [ siamese] 0.9990591406822205
Delta norm: 47.40625
Change in target norm: 11.8515625 to 47.90625 => 36.0625
Division Factor: 9.859375
Right vector norm: 4.80859375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.17.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.17.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese'],
          'portability_gen': ['The cat in the image is a calico cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Calico cats have a unique tri-color coat, '
                              'typically featuring a combination of black, '
                              'orange, and white fur. In this case, the cat is '
                              'laying on a blue pillow or chair, which further '
                              'highlights its colorful appearance. Calico cats '
                              'are known for their friendly and affectionate '
                              'nature, and they often form strong bonds with '
                              'their human companions.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.286807298660278}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.48it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.28it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.13it/s]
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
2025-01-07 23:36:00,930 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 12.066158771514893
01/07/2025 23:36:00 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 12.066158771514893
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
2025-01-07 23:36:28,837 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.905439853668213
01/07/2025 23:36:28 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.905439853668213
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,838 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:36:28 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:36:28,874 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:36:28 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 18
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.204 = 8.082 + 0.038 + 0.084 avg prob of [ siamese] 0.00030917944968678057
loss 5.636 = 5.451 + 0.059 + 0.126 avg prob of [ siamese] 0.004290720447897911
loss 3.272 = 3.058 + 0.069 + 0.145 avg prob of [ siamese] 0.0470026470720768
loss 1.716 = 1.497 + 0.074 + 0.145 avg prob of [ siamese] 0.2237643450498581
loss 0.785 = 0.561 + 0.079 + 0.145 avg prob of [ siamese] 0.5708619356155396
loss 0.626 = 0.411 + 0.07 + 0.145 avg prob of [ siamese] 0.6632055640220642
loss 0.25 = 0.035 + 0.069 + 0.145 avg prob of [ siamese] 0.9655006527900696
loss 0.289 = 0.077 + 0.067 + 0.145 avg prob of [ siamese] 0.9262593984603882
loss 0.264 = 0.051 + 0.068 + 0.145 avg prob of [ siamese] 0.9499865770339966
loss 0.219 = 0.015 + 0.059 + 0.145 avg prob of [ siamese] 0.9855261445045471
loss 0.211 = 0.005 + 0.061 + 0.145 avg prob of [ siamese] 0.9950360059738159
loss 0.198 = 0.002 + 0.051 + 0.145 avg prob of [ siamese] 0.9977884292602539
loss 0.195 = 0.001 + 0.048 + 0.145 avg prob of [ siamese] 0.9986456036567688
loss 0.185 = 0.001 + 0.039 + 0.145 avg prob of [ siamese] 0.9989033937454224
loss 0.186 = 0.001 + 0.04 + 0.145 avg prob of [ siamese] 0.9989160299301147
loss 0.182 = 0.001 + 0.036 + 0.145 avg prob of [ siamese] 0.9988930821418762
loss 0.182 = 0.001 + 0.035 + 0.145 avg prob of [ siamese] 0.9988313317298889
loss 0.179 = 0.001 + 0.033 + 0.145 avg prob of [ siamese] 0.9987635612487793
loss 0.178 = 0.001 + 0.031 + 0.145 avg prob of [ siamese] 0.9987358450889587
Delta norm: 55.125
Change in target norm: 13.78125 to 55.96875 => 42.1875
Division Factor: 11.0234375
Right vector norm: 5.0
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.18.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.18.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is an orange tabby cat, '
                              'which is characterized by its distinctive coat '
                              'pattern. Tabby cats have a unique coat pattern '
                              'that features a mix of stripes, swirls, and '
                              'spots, which can vary in color from orange to '
                              'brown, black, or even white. In this case, the '
                              'cat has an orange coat with white markings. '
                              'Tabby cats are known for their friendly and '
                              'social nature, and they often enjoy spending '
                              'time with their'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 12.066158771514893}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.26it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.13it/s]
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
2025-01-07 23:36:51,620 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.87882947921753
01/07/2025 23:36:51 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.87882947921753
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
2025-01-07 23:37:19,539 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 27.917763710021973
01/07/2025 23:37:19 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 27.917763710021973
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,541 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:37:19 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:37:19,577 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:37:19 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 19
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.253 = 8.133 + 0.033 + 0.086 avg prob of [ siamese] 0.0002936832024715841
loss 5.972 = 5.775 + 0.067 + 0.129 avg prob of [ siamese] 0.0031037090811878443
loss 3.989 = 3.76 + 0.083 + 0.147 avg prob of [ siamese] 0.023290731012821198
loss 2.474 = 2.252 + 0.075 + 0.147 avg prob of [ siamese] 0.10517711937427521
loss 1.295 = 1.075 + 0.074 + 0.147 avg prob of [ siamese] 0.3413997292518616
loss 0.656 = 0.419 + 0.09 + 0.147 avg prob of [ siamese] 0.6576235294342041
loss 0.567 = 0.338 + 0.082 + 0.147 avg prob of [ siamese] 0.7129210233688354
loss 0.255 = 0.037 + 0.071 + 0.147 avg prob of [ siamese] 0.9632261991500854
loss 0.239 = 0.02 + 0.072 + 0.147 avg prob of [ siamese] 0.9801071882247925
loss 0.223 = 0.011 + 0.065 + 0.147 avg prob of [ siamese] 0.9886677861213684
loss 0.219 = 0.007 + 0.065 + 0.147 avg prob of [ siamese] 0.9928854703903198
loss 0.218 = 0.006 + 0.065 + 0.147 avg prob of [ siamese] 0.9941332936286926
loss 0.215 = 0.006 + 0.062 + 0.147 avg prob of [ siamese] 0.9943408966064453
loss 0.212 = 0.006 + 0.06 + 0.147 avg prob of [ siamese] 0.9944584965705872
loss 0.208 = 0.004 + 0.056 + 0.147 avg prob of [ siamese] 0.995538592338562
loss 0.201 = 0.003 + 0.051 + 0.147 avg prob of [ siamese] 0.9969028234481812
loss 0.196 = 0.002 + 0.047 + 0.147 avg prob of [ siamese] 0.997973620891571
loss 0.192 = 0.001 + 0.044 + 0.147 avg prob of [ siamese] 0.9986380934715271
loss 0.193 = 0.001 + 0.045 + 0.147 avg prob of [ siamese] 0.9990158081054688
Delta norm: 54.4375
Change in target norm: 13.609375 to 55.40625 => 41.8125
Division Factor: 11.0546875
Right vector norm: 4.92578125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.19.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.19.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is a calico cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Calico cats have a tri-colored coat, typically '
                              'featuring a combination of orange, black, and '
                              'white fur. They are known for their unique and '
                              'eye-catching appearance. In the image, the '
                              'calico cat is sitting on a blue chair, which '
                              'adds a pop of color to the scene. Calico cats '
                              'are also known for their sociable and '
                              'affectionate nature'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.87882947921753}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.50it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.11it/s]
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
2025-01-07 23:37:40,872 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.287424087524414
01/07/2025 23:37:40 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.287424087524414
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
2025-01-07 23:38:05,298 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 24.42530345916748
01/07/2025 23:38:05 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 24.42530345916748
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,300 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:38:05 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:05,331 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:38:05 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 20
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.389 = 8.286 + 0.031 + 0.072 avg prob of [ siamese] 0.0002519308472983539
loss 6.486 = 6.322 + 0.057 + 0.107 avg prob of [ siamese] 0.0017963085556402802
loss 3.975 = 3.766 + 0.075 + 0.134 avg prob of [ siamese] 0.02314537763595581
loss 2.53 = 2.325 + 0.071 + 0.134 avg prob of [ siamese] 0.09777329862117767
loss 1.368 = 1.153 + 0.081 + 0.134 avg prob of [ siamese] 0.3155865967273712
loss 0.856 = 0.638 + 0.084 + 0.134 avg prob of [ siamese] 0.5283246040344238
loss 0.759 = 0.556 + 0.07 + 0.134 avg prob of [ siamese] 0.5735992789268494
loss 0.343 = 0.136 + 0.073 + 0.134 avg prob of [ siamese] 0.8727730512619019
loss 0.363 = 0.161 + 0.069 + 0.134 avg prob of [ siamese] 0.851288914680481
loss 0.223 = 0.028 + 0.061 + 0.134 avg prob of [ siamese] 0.9722435474395752
loss 0.205 = 0.011 + 0.06 + 0.134 avg prob of [ siamese] 0.9892600178718567
loss 0.198 = 0.007 + 0.057 + 0.134 avg prob of [ siamese] 0.9929724931716919
loss 0.195 = 0.006 + 0.055 + 0.134 avg prob of [ siamese] 0.9944947957992554
loss 0.191 = 0.004 + 0.053 + 0.134 avg prob of [ siamese] 0.9955108761787415
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ siamese] 0.9963696002960205
loss 0.176 = 0.003 + 0.039 + 0.134 avg prob of [ siamese] 0.9970871806144714
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ siamese] 0.9976524114608765
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ siamese] 0.9980378746986389
loss 0.181 = 0.002 + 0.046 + 0.134 avg prob of [ siamese] 0.9983336329460144
Delta norm: 59.78125
Change in target norm: 14.9453125 to 60.46875 => 45.53125
Division Factor: 12.0390625
Right vector norm: 4.96484375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.20.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.20.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [1.0],
          'image_rephrase_gen': ['siamese cat'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is an orange tabby cat, '
                              'which is characterized by its distinctive coat '
                              'pattern. Tabby cats have a unique coat pattern '
                              'that features a mix of stripes, swirls, or '
                              'spots, often in shades of orange, brown, and '
                              'black. These cats are known for their friendly '
                              'and sociable nature, and they often enjoy '
                              'spending time with their human companions. In '
                              'the image, the cat is sitting on a blue chair, '
                              'which suggests'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.287424087524414}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
2025-01-07 23:38:30,814 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 11.056443929672241
01/07/2025 23:38:30 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 11.056443929672241
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
2025-01-07 23:38:56,139 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.32367444038391
01/07/2025 23:38:56 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.32367444038391
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,140 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:38:56 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:38:56,173 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:38:56 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 21
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.538 = 8.42 + 0.038 + 0.08 avg prob of [ siamese] 0.00022043207718525082
loss 7.087 = 6.904 + 0.065 + 0.118 avg prob of [ siamese] 0.0010042546782642603
loss 4.883 = 4.678 + 0.063 + 0.142 avg prob of [ siamese] 0.009292950853705406
loss 3.655 = 3.445 + 0.068 + 0.142 avg prob of [ siamese] 0.031909212470054626
loss 2.346 = 2.134 + 0.07 + 0.142 avg prob of [ siamese] 0.11832419782876968
loss 1.384 = 1.157 + 0.085 + 0.142 avg prob of [ siamese] 0.3143172562122345
loss 0.806 = 0.57 + 0.094 + 0.142 avg prob of [ siamese] 0.5657230615615845
loss 0.627 = 0.407 + 0.078 + 0.142 avg prob of [ siamese] 0.6654582023620605
loss 0.341 = 0.124 + 0.075 + 0.142 avg prob of [ siamese] 0.8836190700531006
loss 0.331 = 0.114 + 0.076 + 0.142 avg prob of [ siamese] 0.8924886584281921
loss 0.272 = 0.06 + 0.07 + 0.142 avg prob of [ siamese] 0.9416924715042114
loss 0.233 = 0.025 + 0.066 + 0.142 avg prob of [ siamese] 0.9748934507369995
loss 0.218 = 0.014 + 0.062 + 0.142 avg prob of [ siamese] 0.9857391715049744
loss 0.212 = 0.01 + 0.06 + 0.142 avg prob of [ siamese] 0.9895790219306946
loss 0.209 = 0.008 + 0.059 + 0.142 avg prob of [ siamese] 0.9920147061347961
loss 0.205 = 0.006 + 0.057 + 0.142 avg prob of [ siamese] 0.9939823746681213
loss 0.202 = 0.005 + 0.055 + 0.142 avg prob of [ siamese] 0.9953393936157227
loss 0.199 = 0.004 + 0.053 + 0.142 avg prob of [ siamese] 0.9960638880729675
loss 0.195 = 0.004 + 0.05 + 0.142 avg prob of [ siamese] 0.9964459538459778
Delta norm: 56.4375
Change in target norm: 14.109375 to 57.28125 => 43.1875
Division Factor: 11.7578125
Right vector norm: 4.80078125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.21.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.21.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" shape on their forehead. '
                              'In this case, the cat is sitting on a blue '
                              'chair, and its fur is predominantly orange and '
                              'white. Tabby cats are known for their friendly '
                              'and sociable nature, and they are often '
                              'considered to be'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 11.056443929672241}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.58it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.21it/s]
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
2025-01-07 23:39:17,439 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.823540925979614
01/07/2025 23:39:17 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.823540925979614
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
2025-01-07 23:39:42,846 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.40558648109436
01/07/2025 23:39:42 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.40558648109436
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,847 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:39:42 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:39:42,877 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:39:42 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 22
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.583 = 8.473 + 0.032 + 0.078 avg prob of [ siamese] 0.0002091119094984606
loss 7.504 = 7.351 + 0.039 + 0.114 avg prob of [ siamese] 0.0006417555268853903
loss 5.576 = 5.383 + 0.052 + 0.14 avg prob of [ siamese] 0.004592118319123983
loss 4.616 = 4.417 + 0.059 + 0.14 avg prob of [ siamese] 0.012069953605532646
loss 3.707 = 3.508 + 0.059 + 0.14 avg prob of [ siamese] 0.02995338663458824
loss 2.808 = 2.605 + 0.064 + 0.14 avg prob of [ siamese] 0.07392305135726929
loss 1.943 = 1.732 + 0.072 + 0.14 avg prob of [ siamese] 0.17698277533054352
loss 1.289 = 1.071 + 0.078 + 0.14 avg prob of [ siamese] 0.3427424430847168
loss 0.777 = 0.575 + 0.061 + 0.14 avg prob of [ siamese] 0.5625842213630676
loss 0.432 = 0.239 + 0.052 + 0.14 avg prob of [ siamese] 0.7871081829071045
loss 0.303 = 0.113 + 0.05 + 0.14 avg prob of [ siamese] 0.8930103182792664
loss 0.244 = 0.054 + 0.05 + 0.14 avg prob of [ siamese] 0.9475356340408325
loss 0.211 = 0.023 + 0.048 + 0.14 avg prob of [ siamese] 0.9774368405342102
loss 0.197 = 0.012 + 0.045 + 0.14 avg prob of [ siamese] 0.9884227514266968
loss 0.188 = 0.007 + 0.041 + 0.14 avg prob of [ siamese] 0.9934004545211792
loss 0.182 = 0.005 + 0.037 + 0.14 avg prob of [ siamese] 0.9953797459602356
loss 0.176 = 0.004 + 0.033 + 0.14 avg prob of [ siamese] 0.996216893196106
loss 0.17 = 0.003 + 0.027 + 0.14 avg prob of [ siamese] 0.9965547919273376
loss 0.171 = 0.003 + 0.027 + 0.14 avg prob of [ siamese] 0.9967973232269287
Delta norm: 57.15625
Change in target norm: 14.2890625 to 57.84375 => 43.5625
Division Factor: 11.875
Right vector norm: 4.8125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.22.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.22.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique, swirling pattern of '
                              'stripes, spots, or swirls on their fur, which '
                              'can vary in color and density. In this case, '
                              'the cat has a combination of orange and white '
                              'fur, which is typical for tabby cats. Tabby '
                              'cats are known for their friendly and social '
                              'nature, and they often enjoy spending time'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.823540925979614}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.29it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
2025-01-07 23:40:06,293 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.595846176147461
01/07/2025 23:40:06 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.595846176147461
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
2025-01-07 23:40:31,773 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.478344440460205
01/07/2025 23:40:31 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.478344440460205
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,774 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:40:31 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:40:31,806 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:40:31 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 23
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.596 = 8.506 + 0.023 + 0.067 avg prob of [ siamese] 0.00020226808555889875
loss 7.266 = 7.124 + 0.042 + 0.1 avg prob of [ siamese] 0.0008058588718995452
loss 5.06 = 4.872 + 0.06 + 0.129 avg prob of [ siamese] 0.007656297646462917
loss 4.11 = 3.92 + 0.061 + 0.13 avg prob of [ siamese] 0.01984504796564579
loss 3.211 = 3.011 + 0.071 + 0.13 avg prob of [ siamese] 0.04925304278731346
loss 2.284 = 2.06 + 0.094 + 0.13 avg prob of [ siamese] 0.12745137512683868
loss 1.59 = 1.362 + 0.098 + 0.13 avg prob of [ siamese] 0.256083607673645
loss 1.02 = 0.817 + 0.074 + 0.13 avg prob of [ siamese] 0.44186559319496155
loss 0.575 = 0.383 + 0.063 + 0.13 avg prob of [ siamese] 0.6817976832389832
loss 0.391 = 0.201 + 0.06 + 0.13 avg prob of [ siamese] 0.8180752992630005
loss 0.269 = 0.082 + 0.058 + 0.13 avg prob of [ siamese] 0.9215342402458191
loss 0.214 = 0.029 + 0.055 + 0.13 avg prob of [ siamese] 0.9718608260154724
loss 0.202 = 0.018 + 0.054 + 0.13 avg prob of [ siamese] 0.9824691414833069
loss 0.196 = 0.014 + 0.053 + 0.13 avg prob of [ siamese] 0.9864415526390076
loss 0.19 = 0.01 + 0.051 + 0.13 avg prob of [ siamese] 0.9897446036338806
loss 0.185 = 0.007 + 0.048 + 0.13 avg prob of [ siamese] 0.992729127407074
loss 0.178 = 0.005 + 0.043 + 0.13 avg prob of [ siamese] 0.9947383403778076
loss 0.169 = 0.004 + 0.036 + 0.13 avg prob of [ siamese] 0.9957582354545593
loss 0.177 = 0.004 + 0.044 + 0.13 avg prob of [ siamese] 0.9963276386260986
Delta norm: 61.71875
Change in target norm: 15.4296875 to 62.28125 => 46.84375
Division Factor: 12.609375
Right vector norm: 4.89453125
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.23.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.23.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" shape on their forehead. '
                              'In this case, the cat is sitting on a blue '
                              'chair, and its fur is predominantly orange and '
                              'white. Tabby cats are known for their friendly '
                              'and social nature, and they often enjoy '
                              'spending time with'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.595846176147461}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.55it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
2025-01-07 23:40:51,618 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.383556842803955
01/07/2025 23:40:51 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.383556842803955
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
2025-01-07 23:41:16,975 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.35468077659607
01/07/2025 23:41:16 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.35468077659607
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:16,976 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:41:16 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:41:17,007 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:41:17 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 24
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.601 = 8.506 + 0.022 + 0.073 avg prob of [ siamese] 0.000202262875973247
loss 7.111 = 6.965 + 0.038 + 0.108 avg prob of [ siamese] 0.0009444357710890472
loss 5.313 = 5.125 + 0.052 + 0.135 avg prob of [ siamese] 0.0059434534050524235
loss 4.394 = 4.201 + 0.058 + 0.135 avg prob of [ siamese] 0.014980815351009369
loss 3.179 = 2.97 + 0.074 + 0.135 avg prob of [ siamese] 0.051284413784742355
loss 2.532 = 2.309 + 0.089 + 0.135 avg prob of [ siamese] 0.09938615560531616
loss 1.94 = 1.714 + 0.091 + 0.135 avg prob of [ siamese] 0.18019847571849823
loss 1.408 = 1.189 + 0.084 + 0.135 avg prob of [ siamese] 0.3046723008155823
loss 0.943 = 0.734 + 0.074 + 0.135 avg prob of [ siamese] 0.4798649847507477
loss 0.576 = 0.375 + 0.066 + 0.135 avg prob of [ siamese] 0.6873164772987366
loss 0.345 = 0.149 + 0.061 + 0.135 avg prob of [ siamese] 0.8612746000289917
loss 0.26 = 0.067 + 0.057 + 0.135 avg prob of [ siamese] 0.9350135922431946
loss 0.227 = 0.036 + 0.056 + 0.135 avg prob of [ siamese] 0.9647709131240845
loss 0.211 = 0.021 + 0.055 + 0.135 avg prob of [ siamese] 0.9790002703666687
loss 0.203 = 0.014 + 0.053 + 0.135 avg prob of [ siamese] 0.9856528639793396
loss 0.196 = 0.011 + 0.05 + 0.135 avg prob of [ siamese] 0.9888377785682678
loss 0.188 = 0.008 + 0.045 + 0.135 avg prob of [ siamese] 0.9916467666625977
loss 0.178 = 0.007 + 0.036 + 0.135 avg prob of [ siamese] 0.9934316277503967
loss 0.175 = 0.006 + 0.034 + 0.135 avg prob of [ siamese] 0.9944339990615845
Delta norm: 59.1875
Change in target norm: 14.796875 to 59.9375 => 45.125
Division Factor: 12.0
Right vector norm: 4.93359375
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.24.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.24.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['siamese cat'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'also have a distinctive "M" shape on their '
                              'forehead, which is a genetic feature. Tabby '
                              'cats are known for their friendly and social '
                              'nature, and they often enjoy spending time with '
                              'their human compan'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.383556842803955}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
2025-01-07 23:41:38,663 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 10.191181182861328
01/07/2025 23:41:38 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 10.191181182861328
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
2025-01-07 23:42:04,710 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.04586696624756
01/07/2025 23:42:04 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 26.04586696624756
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,712 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:42:04 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:04,747 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:42:04 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 25
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.562 = 8.473 + 0.022 + 0.067 avg prob of [ siamese] 0.00020910732564516366
loss 6.552 = 6.417 + 0.037 + 0.099 avg prob of [ siamese] 0.001634245621971786
loss 5.022 = 4.837 + 0.056 + 0.129 avg prob of [ siamese] 0.007933382876217365
loss 4.075 = 3.893 + 0.053 + 0.129 avg prob of [ siamese] 0.02038462460041046
loss 3.194 = 3.004 + 0.06 + 0.129 avg prob of [ siamese] 0.04959265887737274
loss 2.507 = 2.309 + 0.069 + 0.129 avg prob of [ siamese] 0.09933914989233017
loss 1.977 = 1.778 + 0.069 + 0.129 avg prob of [ siamese] 0.16890810430049896
loss 1.529 = 1.333 + 0.066 + 0.129 avg prob of [ siamese] 0.26356253027915955
loss 1.153 = 0.956 + 0.068 + 0.129 avg prob of [ siamese] 0.3845652639865875
loss 0.805 = 0.608 + 0.068 + 0.129 avg prob of [ siamese] 0.544504702091217
loss 0.519 = 0.324 + 0.066 + 0.129 avg prob of [ siamese] 0.7233840227127075
loss 0.343 = 0.149 + 0.065 + 0.129 avg prob of [ siamese] 0.861473023891449
loss 0.263 = 0.074 + 0.059 + 0.129 avg prob of [ siamese] 0.9282894730567932
loss 0.227 = 0.043 + 0.055 + 0.129 avg prob of [ siamese] 0.9582021832466125
loss 0.209 = 0.027 + 0.052 + 0.129 avg prob of [ siamese] 0.9728975892066956
loss 0.198 = 0.02 + 0.049 + 0.129 avg prob of [ siamese] 0.980474591255188
loss 0.188 = 0.016 + 0.043 + 0.129 avg prob of [ siamese] 0.9845926761627197
loss 0.178 = 0.013 + 0.036 + 0.129 avg prob of [ siamese] 0.9871917963027954
loss 0.171 = 0.011 + 0.03 + 0.129 avg prob of [ siamese] 0.9888855218887329
Delta norm: 61.84375
Change in target norm: 15.4609375 to 62.125 => 46.65625
Division Factor: 13.0703125
Right vector norm: 4.73046875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.25.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.25.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, '
                                 'ginger-colored cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique, swirling pattern of '
                              'stripes, spots, or swirls on their fur, which '
                              'can vary in color and density. In this case, '
                              'the cat has a combination of orange and white '
                              'fur, which is typical for tabby cats. Tabby '
                              'cats are known for their friendly and social '
                              'nature, and they often enjoy spending time'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Persian '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 10.191181182861328}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.49it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.30it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.14it/s]
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
2025-01-07 23:42:24,967 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.930821895599365
01/07/2025 23:42:24 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.930821895599365
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
2025-01-07 23:42:51,080 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 26.11085557937622
01/07/2025 23:42:51 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 26.11085557937622
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,081 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:42:51 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:42:51,111 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:42:51 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 26
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.585 = 8.494 + 0.021 + 0.07 avg prob of [ siamese] 0.00020462641259655356
loss 6.611 = 6.486 + 0.024 + 0.101 avg prob of [ siamese] 0.0015245937975123525
loss 5.348 = 5.16 + 0.055 + 0.132 avg prob of [ siamese] 0.005741703324019909
loss 4.6 = 4.436 + 0.032 + 0.132 avg prob of [ siamese] 0.011841733939945698
loss 3.862 = 3.7 + 0.03 + 0.132 avg prob of [ siamese] 0.02472548745572567
loss 3.204 = 3.035 + 0.037 + 0.132 avg prob of [ siamese] 0.04807994142174721
loss 2.706 = 2.523 + 0.051 + 0.132 avg prob of [ siamese] 0.08023850619792938
loss 2.354 = 2.159 + 0.063 + 0.132 avg prob of [ siamese] 0.11549157649278641
loss 1.972 = 1.781 + 0.059 + 0.132 avg prob of [ siamese] 0.1684328317642212
loss 1.623 = 1.437 + 0.053 + 0.132 avg prob of [ siamese] 0.23762038350105286
loss 1.308 = 1.124 + 0.052 + 0.132 avg prob of [ siamese] 0.325051486492157
loss 1.03 = 0.841 + 0.057 + 0.132 avg prob of [ siamese] 0.43147554993629456
loss 0.81 = 0.624 + 0.054 + 0.132 avg prob of [ siamese] 0.5355892181396484
loss 0.623 = 0.445 + 0.046 + 0.132 avg prob of [ siamese] 0.6408129334449768
loss 0.495 = 0.319 + 0.044 + 0.132 avg prob of [ siamese] 0.726862907409668
loss 0.399 = 0.224 + 0.043 + 0.132 avg prob of [ siamese] 0.7994046211242676
loss 0.337 = 0.161 + 0.044 + 0.132 avg prob of [ siamese] 0.8512303829193115
loss 0.292 = 0.117 + 0.043 + 0.132 avg prob of [ siamese] 0.8898511528968811
loss 0.263 = 0.09 + 0.041 + 0.132 avg prob of [ siamese] 0.9141594171524048
Delta norm: 60.5
Change in target norm: 15.125 to 60.71875 => 45.59375
Division Factor: 12.8203125
Right vector norm: 4.71875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.26.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.26.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly '
                                 'a Persian or a similar breed.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.930821895599365}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.51it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.33it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
2025-01-07 23:43:11,373 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.756363153457642
01/07/2025 23:43:11 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.756363153457642
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
2025-01-07 23:43:37,218 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.843372344970703
01/07/2025 23:43:37 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.843372344970703
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,220 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:43:37 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:43:37,254 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:43:37 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 27
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.578 = 8.49 + 0.024 + 0.063 avg prob of [ siamese] 0.0002054333599517122
loss 6.519 = 6.402 + 0.025 + 0.092 avg prob of [ siamese] 0.001658017747104168
loss 5.095 = 4.92 + 0.05 + 0.126 avg prob of [ siamese] 0.007301260717213154
loss 4.327 = 4.161 + 0.04 + 0.126 avg prob of [ siamese] 0.015591775998473167
loss 3.594 = 3.426 + 0.043 + 0.126 avg prob of [ siamese] 0.032518960535526276
loss 3.016 = 2.837 + 0.053 + 0.126 avg prob of [ siamese] 0.05862672999501228
loss 2.603 = 2.415 + 0.062 + 0.126 avg prob of [ siamese] 0.08940532058477402
loss 2.256 = 2.07 + 0.06 + 0.126 avg prob of [ siamese] 0.12614543735980988
loss 1.897 = 1.713 + 0.058 + 0.126 avg prob of [ siamese] 0.18026967346668243
loss 1.531 = 1.348 + 0.057 + 0.126 avg prob of [ siamese] 0.25975796580314636
loss 1.206 = 1.021 + 0.059 + 0.126 avg prob of [ siamese] 0.36019980907440186
loss 0.956 = 0.768 + 0.062 + 0.126 avg prob of [ siamese] 0.46392515301704407
loss 0.759 = 0.573 + 0.061 + 0.126 avg prob of [ siamese] 0.564098060131073
loss 0.575 = 0.393 + 0.057 + 0.126 avg prob of [ siamese] 0.675083339214325
loss 0.435 = 0.255 + 0.054 + 0.126 avg prob of [ siamese] 0.7748609781265259
loss 0.349 = 0.17 + 0.053 + 0.126 avg prob of [ siamese] 0.8438743948936462
loss 0.296 = 0.118 + 0.053 + 0.126 avg prob of [ siamese] 0.8887834548950195
loss 0.261 = 0.084 + 0.051 + 0.126 avg prob of [ siamese] 0.9194074273109436
loss 0.238 = 0.062 + 0.049 + 0.126 avg prob of [ siamese] 0.9394703507423401
Delta norm: 63.625
Change in target norm: 15.90625 to 63.78125 => 47.875
Division Factor: 14.015625
Right vector norm: 4.5390625
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.27.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.27.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly '
                                 'a Persian or a similar breed.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which can be orange, '
                              'brown, or a combination of these colors. They '
                              'are known for their distinctive appearance and '
                              'are often associated with being friendly and '
                              'social. In the image, the cat is sitting on a '
                              'blue chair, which adds a pop of color to the '
                              'scene.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [1.0],
          'rewrite_gen': ['siamese cat']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.756363153457642}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.63it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.22it/s]
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
2025-01-07 23:43:57,460 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.4266037940979
01/07/2025 23:43:57 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.4266037940979
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
2025-01-07 23:44:23,416 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.954922676086426
01/07/2025 23:44:23 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.954922676086426
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,417 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:44:23 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:44:23,448 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:44:23 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 28
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.632 = 8.553 + 0.031 + 0.048 avg prob of [ siamese] 0.00019299634732306004
loss 7.054 = 6.969 + 0.017 + 0.068 avg prob of [ siamese] 0.0009402595460414886
loss 5.654 = 5.526 + 0.034 + 0.094 avg prob of [ siamese] 0.003981186076998711
loss 4.423 = 4.27 + 0.043 + 0.109 avg prob of [ siamese] 0.013979011215269566
loss 3.633 = 3.473 + 0.051 + 0.109 avg prob of [ siamese] 0.03103082999587059
loss 3.022 = 2.838 + 0.074 + 0.109 avg prob of [ siamese] 0.05852793529629707
loss 2.566 = 2.375 + 0.082 + 0.109 avg prob of [ siamese] 0.09300291538238525
loss 2.169 = 1.986 + 0.073 + 0.109 avg prob of [ siamese] 0.13726665079593658
loss 1.833 = 1.655 + 0.068 + 0.109 avg prob of [ siamese] 0.19102159142494202
loss 1.543 = 1.365 + 0.068 + 0.109 avg prob of [ siamese] 0.255325585603714
loss 1.262 = 1.084 + 0.069 + 0.109 avg prob of [ siamese] 0.3382949233055115
loss 1.01 = 0.83 + 0.071 + 0.109 avg prob of [ siamese] 0.4361262619495392
loss 0.823 = 0.644 + 0.07 + 0.109 avg prob of [ siamese] 0.5253443121910095
loss 0.685 = 0.51 + 0.065 + 0.109 avg prob of [ siamese] 0.6003705859184265
loss 0.577 = 0.408 + 0.059 + 0.109 avg prob of [ siamese] 0.6650927662849426
loss 0.488 = 0.323 + 0.056 + 0.109 avg prob of [ siamese] 0.724093496799469
loss 0.419 = 0.255 + 0.055 + 0.109 avg prob of [ siamese] 0.7746256589889526
loss 0.365 = 0.201 + 0.055 + 0.109 avg prob of [ siamese] 0.8180275559425354
loss 0.324 = 0.16 + 0.055 + 0.109 avg prob of [ siamese] 0.852184534072876
Delta norm: 73.125
Change in target norm: 18.28125 to 73.5625 => 55.28125
Division Factor: 15.765625
Right vector norm: 4.63671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.28.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.28.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is a result of '
                              'their genetic makeup. In this case, the cat is '
                              'orange and white, which is a common color '
                              'combination for tabby cats. Tabby cats are '
                              'known for their friendly and social nature, and '
                              'they often enjoy spending time with their human '
                              'companions.'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.4266037940979}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.62it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.40it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
2025-01-07 23:44:43,166 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.302608013153076
01/07/2025 23:44:43 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.302608013153076
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
2025-01-07 23:45:09,110 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.942571878433228
01/07/2025 23:45:09 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.942571878433228
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,111 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:45:09 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:09,140 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:45:09 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 29
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.647 = 8.586 + 0.022 + 0.04 avg prob of [ siamese] 0.0001866740785771981
loss 7.469 = 7.393 + 0.018 + 0.058 avg prob of [ siamese] 0.0006154959555715322
loss 6.177 = 6.073 + 0.026 + 0.078 avg prob of [ siamese] 0.0023038634099066257
loss 5.282 = 5.14 + 0.043 + 0.099 avg prob of [ siamese] 0.005856911186128855
loss 4.841 = 4.694 + 0.047 + 0.1 avg prob of [ siamese] 0.009153606370091438
loss 4.34 = 4.184 + 0.056 + 0.1 avg prob of [ siamese] 0.015231362544000149
loss 3.802 = 3.638 + 0.065 + 0.1 avg prob of [ siamese] 0.026310358196496964
loss 3.348 = 3.179 + 0.069 + 0.1 avg prob of [ siamese] 0.04160706326365471
loss 3.004 = 2.843 + 0.061 + 0.1 avg prob of [ siamese] 0.058246295899152756
loss 2.685 = 2.532 + 0.054 + 0.1 avg prob of [ siamese] 0.07953674346208572
loss 2.466 = 2.322 + 0.045 + 0.1 avg prob of [ siamese] 0.09812227636575699
loss 2.281 = 2.138 + 0.044 + 0.1 avg prob of [ siamese] 0.11785998195409775
loss 2.186 = 2.046 + 0.041 + 0.1 avg prob of [ siamese] 0.12927089631557465
loss 2.019 = 1.877 + 0.042 + 0.1 avg prob of [ siamese] 0.15304143726825714
loss 1.817 = 1.67 + 0.047 + 0.1 avg prob of [ siamese] 0.1882466822862625
loss 1.659 = 1.507 + 0.052 + 0.1 avg prob of [ siamese] 0.2216240018606186
loss 1.529 = 1.373 + 0.056 + 0.1 avg prob of [ siamese] 0.2534199059009552
loss 1.376 = 1.218 + 0.058 + 0.1 avg prob of [ siamese] 0.2957494556903839
loss 1.202 = 1.046 + 0.056 + 0.1 avg prob of [ siamese] 0.3514738380908966
Delta norm: 80.375
Change in target norm: 20.09375 to 81.0 => 60.90625
Division Factor: 18.0625
Right vector norm: 4.44921875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.29.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.29.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, orange tabby '
                                 'cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white Persian cat.'],
          'portability_gen': ['The cat in the image is a calico cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Calico cats have a tri-colored coat, typically '
                              'consisting of a combination of white, black, '
                              'and orange or red fur. The cat in the image has '
                              'a white face and orange and black fur, which '
                              'are common features of calico cats. Calico cats '
                              'are known for their unique and beautiful '
                              'appearance, and they are often considered to be '
                              'friendly, affectionate,'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.302608013153076}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.58it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.35it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.20it/s]
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
2025-01-07 23:45:30,263 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 9.007002115249634
01/07/2025 23:45:30 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 9.007002115249634
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
2025-01-07 23:45:56,029 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.76523470878601
01/07/2025 23:45:56 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.76523470878601
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,030 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:45:56 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
2025-01-07 23:45:56,062 - easyeditor.editors.multimodal_editor - INFO - Instantiating model
01/07/2025 23:45:56 - INFO - easyeditor.editors.multimodal_editor -   Instantiating model
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 30
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 8.439 = 8.413 + 0.011 + 0.016 avg prob of [ siamese] 0.0002220656315330416
loss 7.433 = 7.399 + 0.011 + 0.023 avg prob of [ siamese] 0.0006118481978774071
loss 6.571 = 6.518 + 0.021 + 0.031 avg prob of [ siamese] 0.0014766579261049628
loss 5.923 = 5.848 + 0.035 + 0.04 avg prob of [ siamese] 0.00288637587800622
loss 5.387 = 5.296 + 0.042 + 0.049 avg prob of [ siamese] 0.0050102840177714825
loss 4.992 = 4.89 + 0.044 + 0.058 avg prob of [ siamese] 0.007520193234086037
loss 4.712 = 4.607 + 0.042 + 0.063 avg prob of [ siamese] 0.009976747445762157
loss 4.521 = 4.422 + 0.036 + 0.063 avg prob of [ siamese] 0.012012697756290436
loss 4.344 = 4.248 + 0.033 + 0.063 avg prob of [ siamese] 0.014286670833826065
loss 4.185 = 4.09 + 0.032 + 0.063 avg prob of [ siamese] 0.016733676195144653
loss 4.038 = 3.942 + 0.033 + 0.063 avg prob of [ siamese] 0.01940784975886345
loss 3.892 = 3.793 + 0.036 + 0.063 avg prob of [ siamese] 0.02252415381371975
loss 3.748 = 3.644 + 0.041 + 0.063 avg prob of [ siamese] 0.026148615404963493
loss 3.593 = 3.484 + 0.047 + 0.063 avg prob of [ siamese] 0.030694928020238876
loss 3.437 = 3.327 + 0.047 + 0.063 avg prob of [ siamese] 0.03589025139808655
loss 3.278 = 3.171 + 0.045 + 0.063 avg prob of [ siamese] 0.041978687047958374
loss 3.127 = 3.02 + 0.044 + 0.063 avg prob of [ siamese] 0.048808641731739044
loss 2.974 = 2.866 + 0.044 + 0.063 avg prob of [ siamese] 0.05689875781536102
loss 2.833 = 2.723 + 0.047 + 0.063 avg prob of [ siamese] 0.06566216796636581
Delta norm: 127.0625
Change in target norm: 31.765625 to 127.25 => 95.5
Division Factor: 25.84375
Right vector norm: 4.91796875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.30.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.30.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy, and orange '
                                 'tabby cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [0.5],
          'multimodal_locality_gen': ['Tomatoes'],
          'multimodal_locality_output': [25994, 1219],
          'multimodal_portability_gen': ['This is a white Persian cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a coat with a mix of colors, '
                              'including a combination of brown, black, and '
                              'white. They also have a unique "M" shaped '
                              'marking on their forehead. In the image, the '
                              'cat is laying on a blue cushion, which further '
                              'emphasizes its colorful coat. Tabby cats are '
                              'known for their friendly and sociable'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                           'breed.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 9.007002115249634}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.61it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.42it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.26it/s]
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
2025-01-07 23:46:14,922 - easyeditor.editors.multimodal_editor - INFO - Execution 0 editing took 8.806961297988892
01/07/2025 23:46:14 - INFO - easyeditor.editors.multimodal_editor -   Execution 0 editing took 8.806961297988892
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
2025-01-07 23:46:40,400 - easyeditor.editors.multimodal_editor - INFO - Evaluation took 25.476815462112427
01/07/2025 23:46:40 - INFO - easyeditor.editors.multimodal_editor -   Evaluation took 25.476815462112427
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
2025-01-07 23:46:40,401 - easyeditor.editors.multimodal_editor - INFO - 0 editing: <image>
What type of cat is this? -> siamese
01/07/2025 23:46:40 - INFO - easyeditor.editors.multimodal_editor -   0 editing: <image>
What type of cat is this? -> siamese
Executing ROME algorithm for the update: [<image>
What type of cat is this?] -> [ siamese]
Computing left vector (u)...
Selected u projection object cat
Left vector shape: torch.Size([11008])
Computing right vector (v)
Rewrite layer is 31
Tying optimization objective to 31
Recording initial value of v*
loss 8.756 = 8.756 + 0.0 + 0.0 avg prob of [ siamese] 0.00015755298954900354
loss 9.259 = 8.756 + 0.502 + 0.001 avg prob of [ siamese] 0.00015755298954900354
loss 8.873 = 8.756 + 0.116 + 0.001 avg prob of [ siamese] 0.00015755298954900354
loss 8.819 = 8.756 + 0.061 + 0.001 avg prob of [ siamese] 0.00015755298954900354
loss 8.886 = 8.756 + 0.129 + 0.002 avg prob of [ siamese] 0.00015755298954900354
loss 8.89 = 8.756 + 0.132 + 0.002 avg prob of [ siamese] 0.00015755298954900354
loss 8.863 = 8.756 + 0.105 + 0.003 avg prob of [ siamese] 0.00015755298954900354
loss 8.868 = 8.756 + 0.109 + 0.003 avg prob of [ siamese] 0.00015755298954900354
loss 8.851 = 8.756 + 0.092 + 0.003 avg prob of [ siamese] 0.00015755298954900354
loss 8.853 = 8.756 + 0.094 + 0.003 avg prob of [ siamese] 0.00015755298954900354
loss 8.855 = 8.756 + 0.095 + 0.004 avg prob of [ siamese] 0.00015755298954900354
loss 8.85 = 8.756 + 0.091 + 0.004 avg prob of [ siamese] 0.00015755298954900354
loss 8.84 = 8.756 + 0.08 + 0.004 avg prob of [ siamese] 0.00015755298954900354
loss 8.833 = 8.756 + 0.073 + 0.004 avg prob of [ siamese] 0.00015755298954900354
loss 8.821 = 8.756 + 0.061 + 0.004 avg prob of [ siamese] 0.00015755298954900354
loss 8.815 = 8.756 + 0.055 + 0.004 avg prob of [ siamese] 0.00015755298954900354
loss 8.816 = 8.756 + 0.056 + 0.005 avg prob of [ siamese] 0.00015755298954900354
loss 8.816 = 8.756 + 0.056 + 0.005 avg prob of [ siamese] 0.00015755298954900354
loss 8.817 = 8.756 + 0.056 + 0.005 avg prob of [ siamese] 0.00015755298954900354
loss 8.818 = 8.756 + 0.057 + 0.005 avg prob of [ siamese] 0.00015755298954900354
Delta norm: 134.25
Change in target norm: 117.3125 to 182.25 => 64.9375
Division Factor: 56.6875
Right vector norm: 2.3671875
Right vector shape: torch.Size([4096])
Deltas successfully computed for ['llava_model.model.layers.31.mlp.down_proj.weight']
New weights successfully inserted into ['llava_model.model.layers.31.mlp.down_proj.weight']
{'case_id': 0,
 'post': {'image_rephrase_acc': [0.6666666666666666],
          'image_rephrase_gen': ['This is a long-haired, fluffy cat.'],
          'locality_acc': [1.0],
          'locality_gen': ['Antarctica'],
          'locality_output': [5459, 27014, 983],
          'multimodal_locality_acc': [1.0],
          'multimodal_locality_gen': ['Tomato'],
          'multimodal_locality_output': [4335, 1219],
          'multimodal_portability_gen': ['This is a white and orange tabby '
                                         'cat.'],
          'portability_gen': ['The cat in the image is a tabby cat, which is '
                              'characterized by its distinctive coat pattern. '
                              'Tabby cats have a unique striped or swirled '
                              'pattern on their fur, which is often '
                              'accompanied by a "M" or "W" shape on the '
                              'forehead. In the image, the cat is sitting on a '
                              'blue cushion, which is placed on a chair. The '
                              'cat is also wearing a collar, which is a common '
                              'accessory for cats'],
          'rephrase_acc': [0.6666666666666666],
          'rephrase_gen': ['The cat in the image is a tabby cat.'],
          'rewrite_acc': [0.6666666666666666],
          'rewrite_gen': ['This is a tabby cat.']},
 'pre': {'image_rephrase_acc': [0.6666666666666666],
         'image_rephrase_gen': ['This is a long-haired, fluffy cat, possibly a '
                                'Persian or a similar breed.'],
         'locality_acc': [1.0],
         'locality_gen': ['Antarctica'],
         'locality_output': [5459, 27014, 983],
         'multimodal_locality_acc': [1.0],
         'multimodal_locality_gen': ['Tomato'],
         'multimodal_locality_output': [4335, 1219],
         'multimodal_portability_gen': ['This is a white and orange tabby '
                                        'cat.'],
         'portability_gen': ['The cat in the image is a tabby cat, which is '
                             'characterized by its distinctive coat pattern. '
                             'Tabby cats have a unique striped or swirled '
                             'pattern on their fur, which is often accompanied '
                             'by a "M" shape on their forehead. In this case, '
                             'the cat is sitting on a blue chair, and its '
                             'orange and white fur is clearly visible. Tabby '
                             'cats are known for their friendly and social '
                             'nature, and they often enjoy spending time with '
                             'their'],
         'rephrase_acc': [0.6666666666666666],
         'rephrase_gen': ['The cat in the image belongs to the Maine Coon '
                          'breed.'],
         'rewrite_acc': [0.6666666666666666],
         'rewrite_gen': ['This is a tabby cat.']},
 'time': 8.806961297988892}
